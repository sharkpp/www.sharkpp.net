<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <title><![CDATA[さめたすたすのお家]]></title>
    <link href="http://www.sharkpp.net/blog/tags/Qt%E3%81%A7%E9%81%8A%E3%81%B6.xml" rel="self"/>
    <link href="http://www.sharkpp.net/"/>
    <updated>2022-05-27T09:32:12+00:00</updated>
    <id>http://www.sharkpp.net/</id>
            <author>
            <name><![CDATA[sharkpp]]></name>                    </author>
        <generator uri="http://sculpin.io/">Sculpin</generator>
            <entry>
            <title type="html"><![CDATA[続・QtQuick2でアプリ作ってみたよ]]></title>
            <link href="http://www.sharkpp.net/blog/2013/05/19/qtquick2-taskmemgraph.html"/>
            <updated>2013-05-19T18:48:00+00:00</updated>
            <id>http://www.sharkpp.net/blog/2013/05/19/qtquick2-taskmemgraph.html</id>
            <content type="html"><![CDATA[<p>勉強会の続きが結構かかってしまったけど何とかそれなりに形になりました。</p>

<p>もしくは、力尽きたともいうorz</p>

<p><img src="/images/2013_0519_qtquick2_mac.png" alt="QtQuick2 on Mac" /> <img src="/images/2013_0519_qtquick2_win.png" alt="QtQuick2 on Windows" /></p>

<p>とりあえず、完成までの流れおば</p>

<h2 id="qtquick2%E3%81%A7ui%E6%8F%8F%E7%94%BB%E3%82%92%E4%BD%9C%E6%88%90">QtQuick2でUI描画を作成</h2>

<p>勉強会ではここで力尽きました。</p>

<p>QtQuick2でCanvasエレメント上に円グラフを描き描きしてそれらしい形に。</p>

<p>後からTextエレメントでプロセス名の一覧とメモリの使用量を表示できるようにしました。</p>

<h3 id="%E5%8F%82%E8%80%83">参考</h3>

<ul>
<li><a href="http://qt-project.org/doc/qt-5.0/qtquick/qml-qtquick2-loader.html">QtQuick 5.0: Loader | Documentation | Qt Project</a></li>
<li><a href="http://qt-project.org/doc/qt-5.0/qtquick/qml-qtquick2-item.html">QtQuick 5.0: Item | Documentation | Qt Project</a></li>
<li><a href="http://relog.xii.jp/mt5r/2012/03/qmlqt-16.html">QML(Qt)のエレメントを動的に生成をする - 理ろぐ</a></li>
<li><a href="http://harmattan-dev.nokia.com/docs/platform-api-reference/xml/daily-docs/libqt4/qdeclarativemodels.html#qobjectlist-based-model">Qt 4.7: QML Data Models</a></li>
</ul>

<h2 id="qml%E3%81%A8c%2B%2B%E3%81%AE%E9%80%A3%E6%90%BA">QMLとC++の連携</h2>

<p>最初作ったプロジェクトではどうもC++の関数が呼べなかったらしく少し回り道を、、、してしまったがプロジェクトを作り直して準備完了。</p>

<p>単純なQStringとかを返すのではなくいろんな情報を持つオブジェクトを返したかったので少し変わった事をしています。</p>

<p><a href="https://github.com/sharkpp/TaskMemGraph/blob/master/processlist.h">TaskMemGraph/processlist.h at master - sharkpp/TaskMemGraph - GitHub</a> や <a href="https://github.com/sharkpp/TaskMemGraph/blob/master/processinfo.h">TaskMemGraph/processinfo.h at master - sharkpp/TaskMemGraph - GitHub</a> など で実装しているのですが、<code>ProcessInfo</code>クラスは<code>QObject</code>から派生していて、<code>Q_PROPERTY</code>でプロパティーを定義しています。</p>

<p>こうすると、QML側では、</p>

<pre><code>var v = item;
var yy = v.name;
</code></pre>

<p>みたいに呼び出せます。</p>

<p>で、<code>ProcessList</code>クラスも<code>QObject</code>から派生していて、<code>Q_INVOKABLE</code>で必要なメソッドを定義してあります。</p>

<p>戻り値を<code>QList&lt;QObject*&gt;</code>で定義するとQML側では、</p>

<pre><code>var v = hoge.data();
for(i in v) {
    var yy = v[i].name;
}
</code></pre>

<p>みたいに呼び出せます。</p>

<p>もちろん、</p>

<pre><code>qmlRegisterType&lt;ProcessInfo&gt;("ProcessLib",1,0,"ProcessInfo");
qmlRegisterType&lt;ProcessList&gt;("ProcessLib",1,0,"ProcessList");
</code></pre>

<p>のような感じで型の登録が必要になります。</p>

<p>ただ、なかなか思ったような処理のやり方がわからず探し回りました。</p>

<h3 id="%E5%8F%82%E8%80%83">参考</h3>

<ul>
<li><a href="http://utworks.net/?p=64">&#91;Qt&#93;&#91;QML&#93;QMLとC++コードの連携 - Utworks</a></li>
<li><a href="http://qt-project.org/doc/qt-4.8/qtbinding.html">Using QML Bindings in C++ Applications | Documentation | Qt Project</a></li>
<li><a href="http://d.hatena.ne.jp/hecomi/20130503/1367594609">QtQuick での C++ × QML バインディングについてまとめてみた - 凹みTips</a></li>
<li><a href="http://www.developer.nokia.com/Community/Wiki/Calling_Qt_class_methods_from_QML">Calling Qt class methods from QML - Nokia Developer Wiki</a></li>
<li><a href="http://stackoverflow.com/questions/14287252/accessing-c-qlists-from-qml">Accessing C++ QLists from QML - Stack Overflow</a></li>
</ul>

<h2 id="mac%E3%81%A7%E3%81%AE%E3%83%97%E3%83%AD%E3%82%BB%E3%82%B9%E6%93%8D%E4%BD%9C%E3%81%AE%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0">Macでのプロセス操作のプログラミング</h2>

<p>ここから、完全に未知の領域です。</p>

<p>Macのプログラム、なにそれ？おいしいの？状態でしたが、、、そもそも、何をキーワードにして検索をすればいいかとか どこを見ればいいかとかが分からず、今回一番苦労したところです。</p>

<p>結局は、<a href="https://developer.apple.com/">Apple Developer</a>が総本山だったってことが分かったのですが、それにしても 目的の処理をしようとする方法も分からず？？？な状態でしたが、まあ、何とかなるもんです。</p>

<h3 id="%E5%8F%82%E8%80%83">参考</h3>

<ul>
<li><a href="https://developer.apple.com/library/mac/documentation/Darwin/Reference/ManPages/man3/sysctl.3.html">sysctl(3) Mac OS X Developer Tools Manual Page</a></li>
<li><a href="https://blogs.oracle.com/dns/entry/understanding_the_authorization_framework_on">Using task&#95;for&#95;pid on Mac OS X (Doug's Note System)</a></li>
<li><a href="http://os-tres.net/blog/2010/02/17/mac-os-x-and-task-for-pid-mach-call/">Mac OS X and task&#95;for&#95;pid() mach call - Ivan's blog</a></li>
<li><a href="https://www.evernote.com/pub/view/wishi/crazylazy/b213a94c-0780-4271-8c77-7da7f92a62b3?locale=ja#st=p&amp;n=b213a94c-0780-4271-8c77-7da7f92a62b3">Evernote 共有ノートブック: IT sec research</a></li>
<li><a href="http://qt-project.org/doc/qt-5.0/qtdoc/qmake-platform-notes.html">QtDoc 5.0: qmake Platform Notes | Documentation | Qt Project</a></li>
<li><a href="http://d.hatena.ne.jp/ny23/20100818/p2">(Mac OS X / LINUX での) 外部コマンドの消費メモリのモニタリング - ny23の日記</a></li>
</ul>

<h2 id="windows%E3%81%A7%E3%81%AE%E3%83%97%E3%83%AD%E3%82%BB%E3%82%B9%E6%93%8D%E4%BD%9C%E3%81%AE%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0">Windowsでのプロセス操作のプログラミング</h2>

<p>こっち側はまあAPIとかは少し探しましたが、まあそれなりで、、、</p>

<p>MSDNで日本語の内容も読めるし圧倒的に日本語の資料が多いので簡単です。</p>

<p>こういうところはユーザー数の違いが顕著に出ますね。</p>

<h2 id="%E3%81%BE%E3%81%A8%E3%82%81">まとめ</h2>

<p>初めてQtQuick2をやってみて、、、まあそれなりに手が動いたのはJavaScriptベースだったからでしょうか？</p>

<p>まだ、ちょっと自分の作りたい方向性のものとちょっと違うので、このままどっぷりはまっていくかというとそうでもなさそうですが、 雰囲気は掴めたので何かの時には、またを出しそうな感じです。</p>

<p>そもそも、初っ端からC++との連携とかMacのプロセス操作とかハードルが高すぎましたねorz</p>

<p><a href="https://github.com/sharkpp/TaskMemGraph">sharkpp/TaskMemGraph - GitHub</a>でソースを公開していますがバイナリはなんかdllがたくさん必要なので公開していません。 主にサイズ的な制限で、、、Windows側は必要なDLLが総計40MBですってよorz</p>

<p>ちなみに、動かすのに管理者権限が必要になります。</p>

<p>Mac側は確実に、そして、Windows側はXPでしか試していないですが、恐らく管理者権限が必要だと思います。</p>

<p>Macで動かしたアプリのスクショです。</p>

<p><a href="/images/2013_0519_qtquick2_mac.jpg"><img src="/images/2013_0519_qtquick2_mac.png" alt="QtQuick2 on Mac" /></a></p>

<p>こっちはWindowsで動かしたアプリのスクショです。</p>

<p><a href="/images/2013_0519_qtquick2_win.jpg"><img src="/images/2013_0519_qtquick2_win.png" alt="QtQuick2 on Windows" /></a></p>

<p>自分で試してみたいという奇特な方は、<a href="https://github.com/sharkpp/TaskMemGraph">sharkpp/TaskMemGraph - GitHub</a>からソースを取得して遊んでみてください。</p>

<p>ではでは</p>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[色々なメモ: Qtで遊ぶ 其の５]]></title>
            <link href="http://www.sharkpp.net/blog/2012/01/29/play-with-qt-part-5.html"/>
            <updated>2012-01-29T18:25:00+00:00</updated>
            <id>http://www.sharkpp.net/blog/2012/01/29/play-with-qt-part-5.html</id>
            <content type="html"><![CDATA[<p>過去の記事は↓</p>

<p><a href="/blog/2009/10/04/play-with-qt-part-1.html">QtをVisual C++ 2008 Express Editionで使えるようにしてみる: Qtで遊ぶ 其の１</a></p>

<p><a href="/blog/2009/10/04/play-with-qt-part-2.html">色々なメモ: Qtで遊ぶ 其の２</a></p>

<p><a href="/blog/2011/07/31/play-with-qt-part-3.html">色々なメモ: Qtで遊ぶ 其の３</a></p>

<p><a href="/blog/2011/10/30/play-with-qt-part-4.html">色々なメモ: Qtで遊ぶ 其の４</a></p>

<p>こつこつとQt使ってアプリ作ってます、、、</p>

<h3 id="%E9%9D%9Eqt%E3%82%A2%E3%83%97%E3%83%AA%E3%81%8B%E3%82%89%E4%BD%BF%E3%82%8F%E3%82%8C%E3%82%8B%E3%81%93%E3%81%A8%E3%82%92%E5%89%8D%E6%8F%90%E3%81%A8%E3%81%97%E3%81%9Fdll%E3%81%A7qt%E3%82%92%E4%BD%BF%E3%81%86%E3%81%AE%E3%81%AF%E9%9D%A2%E5%80%92%E3%81%8F%E3%81%95%E3%81%84">非Qtアプリから使われることを前提としたDLLでQtを使うのは面倒くさい</h3>

<p>QtアプリからQtを使ったDLLを使うのは割かし簡単のようでサンプルも多数あるようだけど非Qtアプリからの場合はサンプルが見つからなかった。</p>

<p>状況が特殊といえば特殊なのだがちょっと面倒。</p>

<p>結局のところ、DLL側でスレッドを立ててそこでメイン処理を動くようにしてあげないといけなかった。</p>

<p>しかし、このスレッドが曲者でQtのスレッドを使おうとするとうまくいかないので結局ネイティブのスレッドを使うというなんとも不恰好な結果に、、、</p>

<p><a href="https://github.com/sharkpp/hspide/tree/master/hspdbg">hspdbg at master from sharkpp/hspide - GitHub</a></p>

<h3 id="qsyntaxhighlighter%E3%81%A7%E6%AD%A3%E8%A6%8F%E8%A1%A8%E7%8F%BE%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%AF%E9%A7%84%E7%9B%AE">QSyntaxHighlighterで正規表現を使っては駄目</h3>

<p><code>QSyntaxHighlighter</code>で<code>QRegExp</code>を使うとめちゃめちゃ遅くなる。</p>

<p>一行ごとに処理を呼び出しているため、数十行程度であれば問題ないが、1000行とかになってくると目も当てられないぐらい遅い。</p>

<p>正規表現を使わず自力で字句解析処理を行ったところ十分実用に耐える処理になった。</p>

<p>ちなみに、QtCreatorも自力で字句解析を行っている。</p>

<h3 id="qtreeview%E3%81%AA%E3%81%A9%E3%81%AE%E3%82%AB%E3%83%A9%E3%83%A0%E3%81%AE%E6%96%87%E5%AD%97%E5%88%97%E3%81%AE%E5%8F%B3%E6%8F%83%E3%81%88%E6%96%B9%E6%B3%95">QTreeViewなどのカラムの文字列の右揃え方法</h3>

<p><code>Qt::TextAlignmentRole</code> を Role に指定し、値を <code>Qt::AlignRight</code> にすればOK</p>

<h3 id="qsortfilterproxymodel%E3%82%92qtreeveiw%E3%81%AA%E3%81%A9%E3%81%AE%E3%83%A2%E3%83%87%E3%83%AB%E3%81%AB%E4%BD%BF%E3%81%A3%E3%81%9F%E6%99%82%E3%81%AEdoubleclicked%E3%82%B7%E3%82%B0%E3%83%8A%E3%83%AB%E3%81%AA%E3%81%A9%E3%81%AE%E5%87%A6%E7%90%86">QSortFilterProxyModelをQTreeVeiwなどのモデルに使った時のdoubleClickedシグナルなどの処理</h3>

<p><code>QSortFilterProxyModel::mapToSource()</code> を使ってインデックスを変換してあげればOK</p>

<p><a href="http://lists.trolltech.com/qt-interest/2006-09/thread00423-0.html">Qt-interest Archive - QTreeVie, QSortFilterProxyModel and double click signal</a></p>

<p>とりあえず、こんなものかな、、、</p>

<p>今回は余りメモを取っていなかったorz</p>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[色々なメモ: Qtで遊ぶ 其の4]]></title>
            <link href="http://www.sharkpp.net/blog/2011/10/30/play-with-qt-part-4.html"/>
            <updated>2011-10-30T21:00:00+00:00</updated>
            <id>http://www.sharkpp.net/blog/2011/10/30/play-with-qt-part-4.html</id>
            <content type="html"><![CDATA[<p>色々メモ...</p>

<p>だんだんと手抜きにorz</p>

<h3 id="qstringlistiterator%E3%81%AE%E4%BD%BF%E3%81%84%E6%96%B9">QStringListIteratorの使い方</h3>

<p>QtのイテレーションにはJava風とSTL風の二種類があるらしい...</p>

<p><a href="http://pastebin.com/3HZP6RUr">bool addDirectors(const Movie &amp;theMovie) { QStringListIterator it(theMovie - Pastebin.com</a></p>

<p><a href="http://doc.qt.nokia.com/latest/containers.html">Qt 4.7: Container Classes</a></p>

<h3 id="qxmlsimplereader%E3%81%AE%E4%BD%BF%E3%81%84%E6%96%B9">QXmlSimpleReaderの使い方</h3>

<p><a href="http://doc.qt.nokia.com/stable/xml-saxbookmarks.html">Qt 4.7: SAX Bookmarks Example</a></p>

<h3 id="%E3%82%BF%E3%83%96%E4%BB%98%E3%81%8D%E3%83%89%E3%83%83%E3%82%AF">タブ付きドック</h3>

<p>複数のドックをまとめてタブ付きにするのは、</p>

<p>tabifyDockWidget()</p>

<p>タブ付きにすると最後にまとめたドックが表示されるので、表示を変えるには</p>

<p>dock->setFocus();</p>

<p>dock->raise();</p>

<p>とする。</p>

<p>setFocusは無くてもよいようだ。</p>

<p><a href="http://stackoverflow.com/questions/1290882/focusing-on-a-tabified-qdockwidget-in-pyqt">qt - Focusing on a tabified QDockWidget in PyQt - Stack Overflow</a></p>

<h3 id="%E3%83%84%E3%83%AA%E3%83%BC%E3%83%93%E3%83%A5%E3%83%BC%E3%81%AE%E3%83%80%E3%83%96%E3%83%AB%E3%82%AF%E3%83%AA%E3%83%83%E3%82%AF%E3%82%B7%E3%82%B0%E3%83%8A%E3%83%AB%E3%82%92%E5%8F%97%E4%BF%A1">ツリービューのダブルクリックシグナルを受信</h3>

<p>検索して見つかったページと同じようにしても残念ながらうまくいかなかったので少しゴニョゴニョしています。</p>

<h4 id="%E3%82%B7%E3%82%B0%E3%83%8A%E3%83%AB%E5%8F%97%E4%BF%A1%E3%81%AE%E6%BA%96%E5%82%99">シグナル受信の準備</h4>

<pre>// シグナルに接続
connect(myTree, SIGNAL(doubleClicked(const QModelIndex &)), this, SLOT(dblClickedOnMyTreeView(const QModelIndex &)));
</pre>

<pre>// ダブルクリックで編集を開始しないようにする
myTree-&gt;setEditTriggers(QAbstractItemView::NoEditTriggers);
</pre>

<h4 id="%E3%82%B7%E3%82%B0%E3%83%8A%E3%83%AB%E5%8F%97%E4%BF%A1">シグナル受信</h4>

<pre>void foo::dblClickedOnMyTreeView(const QModelIndex & index) {
MyItem * myObj = (static_cast&lt;MyItem*&gt;(index.internalPointer()))-&gt;child(index.row(), index.column());
}
</pre>

<p><a href="http://www.qtforum.org/article/14999/how-to-double-click-on-a-qtreeview.html">How to double click on a QTreeView - Qt Programming - QtForum.org</a></p>

<p>Qt関連のメモをもう少しまとめれたらいいんだけどなーorz</p>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[色々なメモ: Qtで遊ぶ 其の3]]></title>
            <link href="http://www.sharkpp.net/blog/2011/07/31/play-with-qt-part-3.html"/>
            <updated>2011-07-31T23:32:00+00:00</updated>
            <id>http://www.sharkpp.net/blog/2011/07/31/play-with-qt-part-3.html</id>
            <content type="html"><![CDATA[<p>過去の記事は↓</p>

<p><a href="/blog/2009/10/04/play-with-qt-part-1.html">QtをVisual C++ 2008 Express Editionで使えるようにしてみる: Qtで遊ぶ 其の１</a></p>

<p><a href="/blog/2009/10/04/play-with-qt-part-2.html">色々なメモ: Qtで遊ぶ 其の２</a></p>

<p>少しずつQtのソース見つつ調べつつでやってきたメモ的な何か</p>

<h3 id="%E3%82%A6%E3%82%A3%E3%82%B8%E3%82%A7%E3%83%83%E3%83%88%E9%96%A2%E9%80%A3%E3%81%AE%E4%BD%95%E3%81%8B">ウィジェット関連の何か</h3>

<p>QProgressBarでマーキー(marquee、メモリが左右に動くなどして進捗の終了が不明の場合に使うスタイル)で表示するには、<code>QProgressBar.setRange(0, 0)</code> のように範囲の最小と最大を共に0にすれば良いようだ。</p>

<ul>
<li><a href="http://www.qtcentre.org/threads/28046-Marquee-progress-bar">Marquee progress bar?</a></li>
</ul>

<p>その他、ウィジェットをカスタマイズする時などに参考になりそうなメモ</p>

<ul>
<li><a href="http://uilabo.web.fc2.com/Qt/QtDevMemo.html">Qt開発時のメモ</a></li>
<li><a href="http://www.java2s.com/Code/Cpp/Qt/UsingQStatusBar.htm">Using QStatusBar : QStatusBar « Qt « C</a></li>
</ul>

<h3 id="%E3%82%B7%E3%82%B0%E3%83%8A%E3%83%AB%EF%BC%86%E3%82%B9%E3%83%AD%E3%83%83%E3%83%88%E9%96%A2%E9%80%A3%E3%81%AE%E4%BD%95%E3%81%8B">シグナル＆スロット関連の何か</h3>

<ul>
<li><a href="http://doc.qt.nokia.com/latest/signalsandslots.html">Qt 4.7: Signals &amp; Slots</a></li>
</ul>

<h3 id="%E3%82%A2%E3%83%AB%E3%82%B4%E3%83%AA%E3%82%BA%E3%83%A0%E7%9A%84%E3%81%AA%E4%BD%95%E3%81%8B">アルゴリズム的な何か</h3>

<p>Qtでスマートポインタ使う場合は、<code>QSharedPointer</code>や<code>QScopedPointer</code>がある。</p>

<p>あと、QObjectの派生クラスは、コンストラクタで親を指定すると親の破棄で勝手に削除してくれるらしい。</p>

<ul>
<li><a href="http://stackoverflow.com/questions/1481616/smart-pointers-in-qt">c++ - Smart pointers in Qt - Stack Overflow</a></li>
<li><a href="https://twitter.com/#!/rofi/status/94670745967403008">@sharkpp 独自クラスのコンストラクタの初期化リストで...</a></li>
<li><a href="http://taschenorakel.de/files/qobject-lifecycle.pdf">QObject Life-Cycle</a> ※PDF</li>
</ul>

<h3 id="%E3%83%87%E3%82%A3%E3%83%AC%E3%82%AF%E3%83%88%E3%83%AA%E3%80%81%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E9%96%A2%E9%80%A3%E3%81%AE%E4%BD%95%E3%81%8B">ディレクトリ、ファイル関連の何か</h3>

<p>ディレクトリ移動は、<code>QDir::setCurrent()</code> で出来るようだが、ディレクトリの区切りが最後に無いとうまくいかないようだ。</p>

<ul>
<li><a href="http://www.qtcentre.org/threads/12038-Couldn-t-change-current-directory-in-windows-s-QT">Couldn't change current directory in windows's QT</a></li>
</ul>

<h3 id="%E3%83%97%E3%83%AD%E3%82%BB%E3%82%B9%E9%96%93%E9%80%9A%E4%BF%A1%E3%81%AE%E4%BD%95%E3%81%8B">プロセス間通信の何か</h3>

<p>子プロセスの終了時にシグナルを呼ばれるようにするには <code>finished()</code> を <code>connect</code> すればいいようだ。</p>

<p>他にも標準出力やエラー出力を取得した時などのシグナルがあるようだ。</p>

<p>試したところ、なぜか、強制終了した場合も正常終了となってしまうようだが、、、もうすこし調べる必要はあるようだ。</p>

<ul>
<li><a href="http://stackoverflow.com/questions/4200760/how-can-i-monitor-qprocess-finished-in-qt4-signal-slot">c++ - How can I monitor QProcess finished() in qt4 (Signal/Slot) - Stack Overflow</a></li>
</ul>

<p>Window メッセージをQtで取得するには↓をオーバーライドすればいいらしい</p>

<p><code>QApplication::winEventFilter(MSG*)</code></p>

<ul>
<li><a href="http://lists.trolltech.com/qt-interest/2002-04/thread00039-0.html">Qt-interest Archive - Getting Windows message in Qt app</a></li>
</ul>

<h3 id="%E3%82%B3%E3%83%BC%E3%83%87%E3%82%A3%E3%83%B3%E3%82%B0%E8%A6%8F%E5%89%87%E3%81%AA%E3%81%A9">コーディング規則など</h3>

<ul>
<li><a href="http://doc.trolltech.com/qq/qq13-apis.html">Designing Qt-Style C++ APIs</a></li>
</ul>

<h3 id="%E5%A4%9A%E8%A8%80%E8%AA%9E%E5%AF%BE%E5%BF%9C%E3%81%AA%E4%BD%95%E3%81%8B">多言語対応な何か</h3>

<p>標準ツールを日本語で使うには...</p>

<p>インストールディレクトリ直下の translations フォルダの *_ja.ts を lrelease で変換してあげればよいようです。</p>

<p>ただ、何故か Linguist はうまく日本語にならなかったです。</p>

<ul>
<li><a href="http://www.off-soft.net/ja/develop/qt/qt1-8.html">Qt (8) QtAssistantのGUIの日本語化 | OFF-SOFT.net</a></li>
<li><a href="http://d.hatena.ne.jp/meech/20110213/1297597395">Qtの日本語ドキュメント - Emacs ひきこもり生活</a></li>
</ul>

<p>ファイルを読み込んだときの文字化けを解消するため↓を先頭に書く</p>

<p>リンク先では埋め込み文字列が云々と書かれているが、ファイルから様だと気にも影響があるようだ(別のページで見たけどそのページが見つからない...)。</p>

<pre>QTextCodec::setCodecForCStrings(QTextCodec::codecForLocale());
</pre>

<ul>
<li><a href="http://qtprogramming.s2.zmx.jp/Qt4Examples/Japanese.html">日本語の表示</a></li>
</ul>

<p>そのほか実際の実装などについてのメモ</p>

<ul>
<li><a href="http://qtprogramming.s2.zmx.jp/Qt4Note/qt4_note/internationalization.html">国際化</a></li>
<li><a href="http://www.qtcentre.org/wiki/index.php?title=QLocale">QLocale - QtCentreWiki</a></li>
<li><a href="http://www.off-soft.net/ja/develop/qt/qt1-8-2.html">Qt (8)-2 QtAssistantで使うHELPファイルを作成する | OFF-SOFT.net</a></li>
</ul>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[色々なメモ: Qtで遊ぶ 其の２]]></title>
            <link href="http://www.sharkpp.net/blog/2009/10/04/play-with-qt-part-2.html"/>
            <updated>2009-10-04T17:24:00+00:00</updated>
            <id>http://www.sharkpp.net/blog/2009/10/04/play-with-qt-part-2.html</id>
            <content type="html"><![CDATA[<p>Qtでアプリケーションを作る時のコマンドなどなどのメモ</p>

<p>そのほか、其の１で書いていなかった詳細など</p>

<p>要するに忘れないようにするためのメモ書き</p>

<h3 id="%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AE%E4%BD%9C%E6%88%90%E6%96%B9%E6%B3%95%E3%81%AA%E3%81%A9%E3%81%AE%E3%83%A1%E3%83%A2">プロジェクトの作成方法などのメモ</h3>

<p>uiファイルからヘッダを生成するには、</p>

<pre>uic -o hoge.h hoge.ui
</pre>

<p>Makefileを作るには、</p>

<pre>qmake -project
qmake
</pre>

<p>プロジェクトファイルを作るには、</p>

<pre>qmake -project -t vcapp
qmake
</pre>

<p>ただし、生成されたプロジェクトファイルにはQtのパスが埋め込まれているので注意が必要！</p>

<h3 id="qtcore.lib%E3%81%AA%E3%81%A9%E3%81%AE%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA%E3%82%92%E9%9D%99%E7%9A%84%E3%83%AA%E3%83%B3%E3%82%AF%E5%BD%A2%E5%BC%8F%E3%81%AB%E3%81%99%E3%82%8B%E6%96%B9%E6%B3%95">QtCore.libなどのライブラリを静的リンク形式にする方法</h3>

<ul>
<li>参考：<a href="http://d.kawataso.net/2008/03/vs2005qt4-1.html">VS2005+Qt4でフルスタティックビルド</a></li>
<li>ソリューションなんか作られていなかったので、一つずつ新規ソリューションに追加。</li>
<li>src\corelib\QtCore.vcproj と src\winmain\qtmain.vcproj と　src\gui\QtGui.vcproj は基本で後は必要あればな感じ</li>
<li>それぞれ、「マルチスレッド (/MTd)」と「マルチスレッド デバッグ (/MDd)」から「マルチスレッド (/MT)」と「マルチスレッド デバッグ (/MD)」に変更</li>
<li>参考記事ではReleaseとDebugで二回ビルドが必要とか書いてあるけどバッチビルドを使えば一回ですむ</li>
</ul>

<h3 id="%E3%81%9D%E3%81%AE%E4%BB%96%E3%83%A1%E3%83%A2">その他メモ</h3>

<ul>
<li>アプリケーションアイコンはこの辺が参考になる→<a href="http://www.kde.gr.jp/~ichi/qt/appicon.html">アプリケーションアイコンの設定</a> 最新：<a href="http://qt.linux-life.net/4/doc/ja/appicon.html">Setting the Application Icon</a></li>
</ul>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[QtをVisual C++ 2008 Express Editionで使えるようにしてみる: Qtで遊ぶ 其の１]]></title>
            <link href="http://www.sharkpp.net/blog/2009/10/04/play-with-qt-part-1.html"/>
            <updated>2009-10-04T16:52:00+00:00</updated>
            <id>http://www.sharkpp.net/blog/2009/10/04/play-with-qt-part-1.html</id>
            <content type="html"><![CDATA[<p>前から興味を持っていた、<a href="http://qt.nokia.com/title-jp">Qt</a>で遊び始めた。</p>

<p>クロスプラットフォームでルック＆フィールがネイティブなフレームワークとしてwxWidgetsかQtか迷うところだけどとりあえずQtに手を出してみた。</p>

<p>まず、Qtのオープンソース・Windows版はターゲットとしているコンパイラが<a href="http://www.mingw.org/">MinGW</a>みたいだけどVisual C++ 2008 Express Editionを使いたかったので検索。(<a href="#f1" name ="b1" title="http://www.off-soft.net/ja/develop/qt/qt1.html"><em>1</a>) (<a href="#f2" name ="b2" title="http://www.02.246.ne.jp/~torutk/cxx/qt/QtOnWindowsAndVisualStudio.html"></em>2</a>)</p>

<p>でも、結局MinGWも入れないと後のビルド途中でエラーが出てしまったのでMinGWも入れました。</p>

<p>で最初に、「Qt SDK for Windows」をインストールしてみたんだけど、これが大失敗。</p>

<p>configureがインストールフォルダに見つからなくて、色々探した。</p>

<p>結局、「Windows版Qtライブラリ」の方が正解だったみたい。</p>

<p>で「Windows版Qtライブラリ」をインストール。</p>

<p>次に、環境設定とライブラリとサンプルのビルド。</p>

<p>「Visual Studio 2008 コマンド プロンプト」を実行してインストールフォルダに移動。</p>

<p>Z:\Qtにインストールしたので、</p>

<pre>C:\Program Files (x86)\Microsoft Visual Studio 9.0\VC&gt;Z:
Z:\&gt;cd Z:\Qt
Z:\Qt&gt;
</pre>

<p>そして、対象の開発環境を指定し環境設定を行う。</p>

<p>今回は、静的リンクでEXEを作りたいので、<code>-static</code>オプションも追加(<a href="#f3" name ="b3" title="http://doc.trolltech.com/4.1/deployment-windows.html#building-qt-statically">*3</a>)</p>

<pre>Z:\Qt&gt;set QMAKESPEC=win32-msvc2008
Z:\Qt&gt;configure -debug-and-release -static -D _CRT_SECURE_NO_WARNINGS
Which edition of Qt do you want to use ?
Type 'c' if you want to use the Commercial Edition.
Type 'o' if you want to use the Open Source Edition.
o &lt;-- オープンソース版を使うので'o'を入力
This is the Qt for Windows Open Source Edition.
You are licensed to use this software under the terms of
the GNU General Public License (GPL) version 3
or the GNU Lesser General Public License (LGPL) version 2.1.
Type '3' to view the GNU General Public License version 3 (GPLv3).
Type 'L' to view the Lesser GNU General Public License version 2.1 (LGPLv2.1).
Type 'y' to accept this license offer.
Type 'n' to decline this license offer.
Do you accept the terms of the license?
y &lt;-- ライセンスを受諾したので'y'を入力
--- この後Maikfileの作成などなどが自動で行われます。 ---
Z:\Qt&gt;
</pre>

<p>この処理自体結構時間がかかる。</p>

<p>でライブラリ類やサンプルのMake。</p>

<pre>Z:\Qt&gt;nmake
--- 以下、ずらずらとビルドログが出力されます。 ---
Z:\Qt&gt;
</pre>

<p>なんか自分の環境では途中で失敗したけどテストアプリが生成できたので放置</p>

<p>OSの環境変数にも追加。</p>

<ul>
<li>set QMAKESPEC=win32-msvc2008</li>
<li>set PATH=%path%;C:\Qt\Qt\bin&#46;;C:\Qt\Qt\lib&#46;;C:\Qt\bin&#46;</li>
</ul>

<p>サンプル(<a href="#f4" name ="b4" title="http://null.michikusa.jp/misc/qt.html">*4</a>)を見ながら、コマンドを打ち込んでいく。</p>

<p>で、Visual Studioのプロジェクトファイルを生成しビルド。</p>

<p>出来た、EXEのインポート情報を見てみると...MSVCR90.DLLをインポートしていた＿|￣|○</p>

<p>プロジェクトのプロパティの構成プロパティ→C/C++→コード生成を開き、「ランタイムライブラリ」を「マルチスレッド (/MT)」に変更。</p>

<p>でビルド...</p>

<p>すると大量のリンクエラーが出るのでリンカを開き「特定のライブラリの無視」に msvcrt.lib を追加しビルド...</p>

<p>でもやっぱりエラーが出る。</p>

<p>で検索(<a href="#f5" name ="b5" title="http://d.kawataso.net/2008/03/vs2005qt4-1.html">*5</a>)</p>

<p>ライブラリ自体も「マルチスレッド (/MT)」に変更しないといけないみたいなので変更してビルド</p>

<p>ビルドが終わったらサンプルをもう一回ビルド＆インポート情報を確認</p>

<p>結果、完全に依存関係が無くなったEXEが出来ました。</p>

<p>EXEのサイズ：約5MB</p>

<p>...むー結構でかいな</p>

<p><a href="#b1" name="f1">*1
</a>: http://www.off-soft.net/ja/develop/qt/qt1.html</p>

<p><a href="#b2" name="f2">*2
</a>: http://www.02.246.ne.jp/~torutk/cxx/qt/QtOnWindowsAndVisualStudio.html</p>

<p><a href="#b3" name="f3">*3
</a>: http://doc.trolltech.com/4.1/deployment-windows.html#building-qt-statically</p>

<p><a href="#b4" name="f4">*4
</a>: http://null.michikusa.jp/misc/qt.html</p>

<p><a href="#b5" name="f5">*5
</a>: http://d.kawataso.net/2008/03/vs2005qt4-1.html</p>
]]></content>
        </entry>
    </feed>