<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <title><![CDATA[さめたすたすのお家]]></title>
    <link href="http://www.sharkpp.net/blog/tags/C%2B%2B.xml" rel="self"/>
    <link href="http://www.sharkpp.net/"/>
    <updated>2018-10-11T16:18:11+00:00</updated>
    <id>http://www.sharkpp.net/</id>
            <author>
            <name><![CDATA[sharkpp]]></name>                    </author>
        <generator uri="http://sculpin.io/">Sculpin</generator>
            <entry>
            <title type="html"><![CDATA[名古屋Qt勉強会#19 に参加しました]]></title>
            <link href="http://www.sharkpp.net/blog/2018/08/26/qt-nagoya-19.html"/>
            <updated>2018-08-26T09:57:00+00:00</updated>
            <id>http://www.sharkpp.net/blog/2018/08/26/qt-nagoya-19.html</id>
            <content type="html"><![CDATA[<p>8月25日(土) に開催された <a href="https://qt-users.connpass.com/event/98190/">Qt 勉強会 @ Nagoya #19 - connpass</a> に参加しました。</p>

<p>そのまとめなどです。</p>

<p><img src="/images/20180825_qauthwith1.png" alt="成果" /></p>

<h2 id="%E5%8B%95%E7%9A%84%E3%81%AB%E8%BF%BD%E5%8A%A0%E3%81%97%E3%81%9F%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88%E3%81%ABc%2B%2B%E5%81%B4%E3%81%8B%E3%82%89%E5%80%A4%E3%82%92%E8%A8%AD%E5%AE%9A%E3%81%99%E3%82%8B">動的に追加したコンポーネントにC++側から値を設定する</h2>

<p>たぶんこのままではちゃんと動かないけど、雰囲気それらしいメモ。</p>

<pre><code class="javascript">// .qml
    Component {
        id: hogeHoge
        Label {
            property variant hoge: null
            anchors.right: parent.right
            anchors.left: parent.left
            text: ""
            Component.onCompleted: {
                hoge.bind(this);
            }
        }
    }
            :
    hogeHoge.createObject(container, {
        hoge: hoge
    })

</code></pre>

<pre><code class="cpp">// .h
class Hoge : public QObject {
                  :
    Q_INVOKABLE void bind(QObject* object);
                  :
}
</code></pre>

<pre><code class="cpp">// .cpp
               :
    QQmlApplicationEngine engine;
    Hoge hoge;
    engine.rootContext()-&gt;setContextProperty("hoge", &amp;hoge);
               :
void Hoge::bind(QObject* object)
{
    qDebug() &lt;&lt; object; // QQuickLabel_QML_99(0xffffffffff00)

    // read from
    qDebug()  &lt;&lt; "Property value:" &lt;&lt; object-&gt;property("text").toString();
//or qDebug() &lt;&lt; "Property value:" &lt;&lt; QQmlProperty::read(object, "text").toString();

    // write to
    object-&gt;setProperty("text", "aaaa");
//or QQmlProperty::write(object, "text", aaaa);
}
</code></pre>

<h2 id="%08qt-documentation-%E3%81%AB%E4%B8%80%E7%9E%AC%E8%A1%A8%E7%A4%BA%E3%81%95%E3%82%8C%E3%82%8B%E3%82%A2%E3%82%A4%E3%82%B3%E3%83%B3%E3%81%A8%E3%83%A1%E3%83%83%E3%82%BB%E3%83%BC%E3%82%B8">Qt Documentation に一瞬表示されるアイコンとメッセージ</h2>

<p>Qt の公式ドキュメントを表示すると上部に一瞬だけ表示されるやつ。</p>

<blockquote>
  <p>We bake cookies in your browser for a better experience.  Using this site means that you consent.
  訳：より良いエクスペリエンスのために、ブラウザでクッキーを焼きます。 このサイトを使用することはそれに同意することを意味します。</p>
</blockquote>

<p><img src="/images/20180825_qtdocwebsite.png" alt="クッキーマン？" /></p>

<p>のメッセージとともに <a href="https://www.qt.io/company/?hsLang=en">The Qt Company</a> へのリンクがあるみたい。</p>

<h2 id="%E9%80%B2%E6%8D%97">進捗</h2>

<p>今回は愚直に実装を進めた関係で新たな知見は少ない感じ。</p>

<ul>
<li>signal用のヘルプ表示関連の実装

<ul>
<li>表示用の専用QMLを実装</li>
<li>QMLの切り替え用のコードを実装</li>
<li>C++側にも実装を追加</li>
</ul></li>
<li>signal受信時にどのように通知するか？

<ul>
<li><del>パターン１：スクロール＆フラッシュ</del>

<ol>
<li><del>該当signalにスクロール</del></li>
<li><del>該当signalがフラッシング</del></li>
</ol></li>
<li>パターン２：通知＆クリックでスクロール <strong>採用！</strong>

<ol>
<li>ウインドウ内に通知</li>
<li>通知をクリックすると該当のsignalにスクロール</li>
</ol></li>
</ul></li>
</ul>

<p><img src="/images/20180825_qauthwith2.png" alt="成果" /></p>

<h2 id="%E6%87%87%E8%A6%AA%E4%BC%9A">懇親会</h2>

<p>タコさんウインナーとか、もぐもぐ♪</p>

<p><img src="/images/20180825_mogmog.jpg" alt="もぐもぐ" /></p>

<h2 id="%E5%8F%82%E8%80%83">参考</h2>

<ul>
<li><a href="http://doc.qt.io/qt-5/qtqml-cppintegration-interactqmlfromcpp.html">Interacting with QML Objects from C++ | Qt QML 5.11</a></li>
<li><a href="http://doc.qt.io/qt-5/qtqml-cppintegration-overview.html#choosing-the-correct-integration-method-between-c-and-qml">Overview - QML and C++ Integration | Qt QML 5.11</a></li>
<li><a href="https://gist.github.com/alex-spataru/cba4936a1d555372e898">Notification badge in QML</a></li>
<li><a href="https://doc.qt.io/QtApplicationManager/qml-qtapplicationmanager-notificationmanager.html">NotificationManager QML Type | Qt Application Manager 5.11</a></li>
<li><a href="http://doc.qt.io/qt-5/qml-qtqml-timer.html">Timer QML Type | Qt QML 5.11</a></li>
<li><a href="http://doc.qt.io/qt-5/qml-qtquick-listview.html">ListView QML Type | Qt Quick 5.11</a></li>
</ul>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[Qt Quick メモ]]></title>
            <link href="http://www.sharkpp.net/blog/2018/08/22/qt-quick-memo.html"/>
            <updated>2018-08-22T00:40:00+00:00</updated>
            <id>http://www.sharkpp.net/blog/2018/08/22/qt-quick-memo.html</id>
            <content type="html"><![CDATA[<p><a href="https://github.com/sharkpp/qtauthwith">sharkpp/qtauthwith</a> を実装中に調べメモした、 Qt Quick 関連の事をとりあえず記事にしました。</p>

<h2 id="listview-%E3%82%BF%E3%82%A4%E3%83%97%E3%81%AE%E7%89%B9%E5%AE%9A%E9%A0%85%E7%9B%AE%E3%81%B8%E3%82%B9%E3%82%AF%E3%83%AD%E3%83%BC%E3%83%AB%E3%81%99%E3%82%8B">ListView タイプの特定項目へスクロールする</h2>

<pre><code class="javascript">    listView.currentIndex = index
</code></pre>

<p>のような感じでインデックスを代入すればスクロールする</p>

<h2 id="gridlayout-%E3%81%A8-grid">GridLayout と Grid</h2>

<p><code>GridLayout</code> は <code>Layout.row</code> と <code>Layout.column</code> が効く。</p>

<p><code>Grid</code> は <code>Layout.row</code> と <code>Layout.column</code> が効かない。</p>

<h2 id="%E3%83%A2%E3%83%87%E3%83%AB%E3%82%92%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E4%B8%8A%E3%81%AB%E4%B8%A6%E3%81%B9%E3%82%8B">モデルをテーブル上に並べる</h2>

<pre><code class="javascript">[
    { foo: XXX1, bar: YYY1 },
    { foo: XXX2, bar: YYY2 }
]
</code></pre>

<p>を返すモデルが例。</p>

<pre><code class="javascript">import QtQuick.Layouts 1.11
         :
    GridLayout {
        id: grid
        anchors.fill: parent
        columns: 2
        rowSpacing: 5
        columnSpacing: 5
        anchors.margins: 5

        Repeater {
            model: hoge // [ { foo: XXX1, bar: YYY1 }, { foo: XXX2, bar: YYY2 } ]
            Label {
                Layout.row: index
                Layout.column: 0
                text: modelData.foo
            }
        }

        Repeater {
            model: hoge
            TextArea {
                Layout.row: index
                Layout.column: 1
                text: modelData.bar
            }
        }
    }
</code></pre>

<h2 id="qml%E3%81%A7%E5%AE%9A%E6%95%B0%E3%82%92%E5%88%A9%E7%94%A8%E3%81%99%E3%82%8B">QMLで定数を利用する</h2>

<p>定数が大量にある場合は</p>

<pre><code class="javascript">// hoge.js
var xxx = "aa";
var yyy = "bb";
</code></pre>

<p>と登録したソースを import して</p>

<pre><code class="javascript">// fuga.qml
import "hoge.js" as Hoge
          :
        Label {
            text: Hoge.xxx
        }
        Label {
            text: Hoge.yyy
        }
          :
</code></pre>

<p>のような感じで利用すると管理が楽そう。
他の QML で使い回すならなおさら。</p>

<h2 id="qml%E5%81%B4%E3%81%8B%E3%82%89%E5%91%BC%E3%81%B3%E5%87%BA%E3%81%99%E9%96%A2%E6%95%B0%E3%81%AE%E5%BC%95%E6%95%B0%E3%81%AB%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%82%92%E6%B8%A1%E3%81%97%E3%81%9F%E5%A0%B4%E5%90%88%E3%81%AE%E5%8B%95%E3%81%8D">qml側から呼び出す関数の引数にオブジェクトを渡した場合の動き</h2>

<pre><code class="javascript">// xxx.qml
   var xxx = { aa: 10, bb: "bb" };
   hoge(xxx);
</code></pre>

<p>と QML 側で C++ で定義した関数を呼び出す場合は</p>

<pre><code class="cpp">#include &lt;QJSValue&gt;
            :
   Q_INVOKABLE void hoge(const QJSValue&amp; abc);
</code></pre>

<p>という関数定義にする必要がある。</p>

<h2 id="qml-%E3%81%A7%E7%A9%BA%E3%81%A3%E3%81%BD%E3%81%AE%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%82%92%E5%AE%9A%E7%BE%A9%E3%81%99%E3%82%8B">qml で空っぽのオブジェクトを定義する</h2>

<pre><code class="javascript">Item {
    property var badSyntax:   {}   // ng, empty block statement
    property var emptyObject: ({}) // ok
}
</code></pre>

<p>その他の JavaScript 標準な型のプロパティを定義</p>

<pre><code class="javascript">Item {
    property var aNumber: 100
    property var aBool: false
    property var aString: "Hello world!"
    property var anotherString: String("#FF008800")
    property var aColor: Qt.rgba(0.2, 0.3, 0.4, 0.5)
    property var aRect: Qt.rect(10, 10, 10, 10)
    property var aPoint: Qt.point(10, 10)
    property var aSize: Qt.size(10, 10)
    property var aVector3d: Qt.vector3d(100, 100, 100)
    property var anArray: [1, 2, 3, "four", "five", (function() { return "six"; })]
    property var anObject: { "foo": 10, "bar": 20 }
    property var aFunction: (function() { return "one"; })
}
</code></pre>

<h2 id="%E5%8F%82%E8%80%83">参考</h2>

<ul>
<li><a href="https://stackoverflow.com/questions/32969414/populate-gridlayout-with-repeater">qt - Populate GridLayout with Repeater - Stack Overflow</a></li>
<li><a href="http://relog.xii.jp/mt5r/2011/10/qmlqt-9.html">QML(Qt)アプリ全体で使いたいグローバルな設定値の扱い方 - 理ろぐ</a></li>
<li><a href="http://doc.qt.io/qt-5/qml-var.html#property-value-initialization-semantics">var QML Basic Type | Qt QML 5.11</a></li>
</ul>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[名古屋Qt勉強会#18 に参加しました]]></title>
            <link href="http://www.sharkpp.net/blog/2018/07/21/qt-nagoya-18.html"/>
            <updated>2018-07-21T17:35:00+00:00</updated>
            <id>http://www.sharkpp.net/blog/2018/07/21/qt-nagoya-18.html</id>
            <content type="html"><![CDATA[<p>7月21日(土) に開催された <a href="https://qt-users.connpass.com/event/94197/">Qt 勉強会 @ Nagoya #18 - connpass</a> に参加しました。</p>

<p>そのまとめなどです。</p>

<p><img src="/images/20180721_qauthwith1.png" alt="成果" /></p>

<h2 id="qt-quick-%E3%81%A7%E3%81%AE%E6%96%87%E5%AD%97%E5%88%97%E3%81%AE%E5%A4%9A%E8%A8%80%E8%AA%9E%E5%AF%BE%E5%BF%9C">Qt Quick での文字列の多言語対応</h2>

<p><code>qsTr()</code> で囲う。</p>

<h2 id="toolbutton">ToolButton</h2>

<p>ToolButton タイプで利用できる各種プロパティが QtQuick.Controls 1.x と QtQuick.Controls 2.x とで全然違うのでメモ</p>

<table>
<thead>
<tr>
  <th>version</th>
  <th>QtQuick.Controls 1.x</th>
  <th>QtQuick.Controls 2.x</th>
</tr>
</thead>
<tbody>
<tr>
  <td>派生</td>
  <td><a href="http://doc.qt.io/qt-5/qml-qtquick-controls-button.html">Button</a></td>
  <td><a href="http://doc.qt.io/qt-5/qml-qtquick-controls2-abstractbutton.html">AbstractButton</a></td>
</tr>
<tr>
  <td>アイコン</td>
  <td><code>iconName</code> プロパティ</td>
  <td><code>icon.name</code> プロパティ</td>
</tr>
<tr>
  <td>ツールチップ</td>
  <td><code>tooltip</code> プロパティ</td>
  <td><a href="https://doc.qt.io/Qt-5/qml-qtquick-controls2-tooltip.html#attached-tool-tips">ToolTip QML Type</a></td>
</tr>
<tr>
  <td>&nbsp;&nbsp;要素押下時に表示</td>
  <td>不明</td>
  <td><code>ToolTip.visible: down</code></td>
</tr>
<tr>
  <td>&nbsp;&nbsp;要素クリック時に表示</td>
  <td>不明</td>
  <td><code>ToolTip.visible: pressed</code></td>
</tr>
<tr>
  <td>&nbsp;&nbsp;要素ホバー時に表示</td>
  <td>不明</td>
  <td><code>ToolTip.visible: hovered</code></td>
</tr>
</tbody>
</table>

<h2 id="qml-%E3%81%A7%E5%8F%82%E7%85%A7%E3%81%AE%E3%81%BF%E5%8F%AF%E8%83%BD%E3%81%AA%E3%83%97%E3%83%AD%E3%83%91%E3%83%86%E3%82%A3%E3%82%92%E3%81%A7%E3%81%8D%E3%82%8B%E3%81%A0%E3%81%91%E7%B0%A1%E7%B4%A0%E3%81%AB%E5%AE%9A%E7%BE%A9">QML で参照のみ可能なプロパティをできるだけ簡素に定義</h2>

<pre><code class="cpp">  Q_PROPERTY(QString hoge MEMBER m_hoge CONSTANT)
</code></pre>

<p>new するときとか、C++側からのみアクセスできる setter で値は代入する。</p>

<h2 id="qml-%E3%81%A7%E5%AE%9F%E8%A1%8C%E5%8F%AF%E8%83%BD%E3%81%AA%E9%96%A2%E6%95%B0%E3%82%92%E5%AE%9A%E7%BE%A9">QML で実行可能な関数を定義</h2>

<pre><code class="cpp">  Q_INVOKABLE inline int hoge() {
      return 10;
  }
</code></pre>

<h2 id="%E3%83%88%E3%83%A9%E3%83%96%E3%83%AB%E3%82%B7%E3%83%A5%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0">トラブルシューティング</h2>

<h3 id="invalid-import-qualifier-id">Invalid import qualifier ID</h3>

<blockquote>
  <p>Invalid import qualifier ID
  (訳: インポート修飾識別子が無効)</p>
</blockquote>

<p>エリアスの頭は大文字でないとダメらしい。</p>

<pre><code class="diff">- import "xxx" as my
+ import "xxx" as My
</code></pre>

<h3 id="depends-on-non-notifyable-properties%3A-xxxxx%3Ayyyyy">depends on non-NOTIFYable properties: XXXXX:YYYYY</h3>

<blockquote>
  <p>depends on non-NOTIFYable properties: XXXXX:YYYYY
  (訳: 通知できないプロパティに依存)</p>
</blockquote>

<p>読み取り専用の場合は <code>CONSTANT</code> をつければ良い。</p>

<pre><code class="diff">           :
-     Q_PROPERTY(QString title MEMBER m_title)
+     Q_PROPERTY(QString title MEMBER m_title CONSTANT)
           :
</code></pre>

<h3 id="type-xxxx-unavailable">Type XXXX unavailable</h3>

<blockquote>
  <p>Type XXXX unavailable
  (訳: タイプ XXXX は利用できません)</p>
</blockquote>

<p>XXXX をちゃんと定義しているはずなのに出る場合は、 XXXX の中でエラーになってるかも？
その場合は、該当ファイルを対象としたエラーが出ている。</p>

<h3 id="qt-creator-%E4%B8%8A%E3%81%A7%E3%81%AE%E3%82%A8%E3%83%A9%E3%83%BC%E6%B3%A8%E9%87%88%E8%A1%A8%E7%A4%BA">Qt Creator 上でのエラー注釈表示</h3>

<p>QtQuick.Controls 2 を利用しているのに QtQuick.Controls 1 のエラーが表示される</p>

<p><img src="/images/20180721_qtcreator_annotation.png" alt="Qt Creator エラー注釈表示" /></p>

<p>どうやら Qt 5.11 を利用すれば大丈夫な様子。</p>

<h2 id="qt-quick-%E3%81%A8-c%2B%2B-%E3%81%A8%E3%81%AE%E3%82%84%E3%82%8A%E3%81%A8%E3%82%8A">Qt Quick と C++ とのやりとり</h2>

<h3 id="%E3%82%AB%E3%82%B9%E3%82%BF%E3%83%A0%E3%82%BF%E3%82%A4%E3%83%97%E3%81%AE%E7%99%BB%E9%8C%B2">カスタムタイプの登録</h3>

<p>※ <code>HogeType</code> クラスは <code>QObjct</code> から派生</p>

<pre><code>              :
    qmlRegisterType&lt;HogeType&gt;("net.example.foo", 1, 0, "HogeType");
    QQmlApplicationEngine engine;
              :
</code></pre>

<p>qml では次のように利用</p>

<pre><code>import net.example.foo 1.0
            :
ApplicationWindow {
            :
    HogeType {
        id: hoge
    }
            :
}
</code></pre>

<h3 id="%E3%82%B3%E3%83%B3%E3%83%86%E3%82%AD%E3%82%B9%E3%83%88%E3%81%AB%E7%99%BB%E9%8C%B2">コンテキストに登録</h3>

<p>※ <code>AppData</code> クラスは <code>QObjct</code> から派生</p>

<pre><code>            :
    AppData data;
    QQmlApplicationEngine engine;
    engine.rootContext()-&gt;setContextProperty("appData", &amp;data);
            :
</code></pre>

<p>qml では次のように利用</p>

<pre><code>            :
Window {
            :
    Text {
        text: appData.getTextFromCpp()
            :
    }
}
</code></pre>

<h2 id="%E6%87%87%E8%A6%AA%E4%BC%9A">懇親会</h2>

<p>もぐもぐ♪</p>

<p><img src="/images/20180721_mogmog.jpg" alt="もぐもぐ" /></p>

<h2 id="%E5%8F%82%E8%80%83">参考</h2>

<ul>
<li><a href="http://doc.qt.io/qt-5/qml-qtquick-controls-button.html">Button QML Type | Qt Quick Controls 5.11</a></li>
<li><a href="https://doc.qt.io/Qt-5/qml-qtquick-controls2-abstractbutton.html">AbstractButton QML Type | Qt Quick Controls 2 5.11</a></li>
<li><a href="http://forum.jollausers.com/sailfish-developers/import-js-file-invalid-import-qualifier-id/">[Solved] import js file - Invalid import qualifier ID - Sailfish Developers - Jolla &amp; Sailfish OS Forum</a></li>
<li><a href="http://doc.qt.io/qt-5/qtqml-cppintegration-topic.html">Integrating QML and C++ | Qt QML 5.11</a></li>
<li><a href="https://qiita.com/DAR/items/400a1725ddedcaa6ef0e">QMLとC++のバインディング - Qiita</a></li>
<li><a href="http://tips.hecomi.com/entry/20130503/1367594609">Qt Quick での C++ × QML バインディングについてまとめてみた - 凹みTips</a></li>
<li><a href="https://stackoverflow.com/questions/6728615/warning-about-non-notifyable-properties-in-qml">qt - Warning about non-NOTIFYable properties in QML - Stack Overflow</a></li>
</ul>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[名古屋Qt勉強会#16 に参加しました]]></title>
            <link href="http://www.sharkpp.net/blog/2018/05/26/qt-nagoya-16.html"/>
            <updated>2018-05-26T23:26:00+00:00</updated>
            <id>http://www.sharkpp.net/blog/2018/05/26/qt-nagoya-16.html</id>
            <content type="html"><![CDATA[<p>5月26日(土) に開催された <a href="https://qt-users.connpass.com/event/88524/">Qt 勉強会 @ Nagoya #16 - connpass</a> に参加しました。</p>

<p>そのまとめ。</p>

<p><img src="/images/20180526_qauthwith2.png" alt="開発中" /></p>

<h2 id="%E4%BC%9A%E5%A0%B4%E5%88%B0%E7%9D%80%E3%81%BE%E3%81%A7">会場到着まで</h2>

<p>前回は、ちょっと迷ってしまったけど、さすがに２回目ともなれば迷うこともなく到着。
電車の時間を少しミスったために、今回もギリギリ（汗</p>

<h2 id="%E8%87%AA%E5%B7%B1%E7%B4%B9%E4%BB%8B">自己紹介</h2>

<p>みんなで自己紹介</p>

<p>今回は２名のご新規さんが参加されました。</p>

<p>東京組２名は少し遅れて到着（やはり迷った様子</p>

<h2 id="%E4%BB%8A%E5%9B%9E%E3%81%AE%E3%81%8A%E8%8F%93%E5%AD%90">今回のお菓子</h2>

<p>今回は、東京からの参加者の <a href="https://twitter.com/hermit4">@hermit4</a> さんが、美味しそうなお菓子を持ち込み。
クッキーなどと合わせてなかなかの量になりました。</p>

<h2 id="%E3%82%82%E3%81%8F%E3%82%82%E3%81%8F">もくもく</h2>

<p>前回の続きをもくもく。</p>

<p>本日は、Qt Quick をサンプルを見ながらUIの作り込み。</p>

<p><img src="/images/20180526_qauthwith1.png" alt="開発中" /></p>

<p>こんな感じに Swagger UI 風の UI を Qt Quick で作ることにした。</p>

<p><img src="/images/20180526_qauthwith2.png" alt="開発中" /></p>

<p>一部、どうしてもわからないことを <a href="https://twitter.com/IoriAYANE">@IoriAYANE</a> さんに聞きつつ、なんとかここまで出来た。</p>

<p>さてはて、中身の実装をどうしようかな？というところで時間切れ。</p>

<h2 id="%E6%87%87%E8%A6%AA%E4%BC%9A">懇親会</h2>

<p>今回は、前回行った串カツ屋さんは入れず。
少し歩いた先の串焼き屋さんで懇親会。</p>

<p><img src="/images/20180526_kushiyaki.jpg" alt="テング酒場で懇親会" /></p>

<h2 id="%E6%9C%80%E5%BE%8C%E3%81%AB">最後に</h2>

<p>久しぶりに集中して趣味プロしたけど、やはりいいものだ。
年々、趣味に割ける時間が減っているけど、なんとか継続して行きたい。</p>

<h2 id="%E5%8F%82%E8%80%83">参考</h2>

<ul>
<li><a href="http://doc.qt.io/qt-5/qtquickcontrols-index.html">Qt Quick Controls 5.11</a></li>
<li><a href="https://doc.qt.io/archives/qt-5.7/qtquickcontrols2-customize.html">Customizing Qt Quick Controls 2 | Qt Quick Controls 2 5.7</a></li>
<li><a href="http://blog.qt.io/jp/2011/03/10/qml-drawing-2/">Qt Quick 入門 第8回: QML の描画処理 - Qt Japanese Blog</a></li>
</ul>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[名古屋Qt勉強会#15 に参加しました]]></title>
            <link href="http://www.sharkpp.net/blog/2018/04/21/qt-nagoya-15.html"/>
            <updated>2018-04-21T05:50:00+00:00</updated>
            <id>http://www.sharkpp.net/blog/2018/04/21/qt-nagoya-15.html</id>
            <content type="html"><![CDATA[<p>つい先日 4月14日(土) に開催された <a href="https://qt-users.connpass.com/event/84048/">Qt 勉強会 @ Nagoya #15 - connpass</a> に参加しました。</p>

<p>まとめは <a href="https://togetter.com/li/1218135">Qt 勉強会 @ Nagoya # 15 まとめ - Togetter</a> です。</p>

<p>ちょっと遅くなったけど、そのまとめ。</p>

<p><img src="/images/20180414_qauthwith.png" alt="開発中" /></p>

<h2 id="%E4%BC%9A%E5%A0%B4%E5%88%B0%E7%9D%80%E3%81%BE%E3%81%A7">会場到着まで</h2>

<p>会場近くには、あの食器で有名なノリタケの森がある。
それを横目に通り過ぎながら名古屋駅からテクテク歩くこと約20分。
最初、別の場所を会場と思ってたけど間違えてたようで <a href="https://twitter.com/kazuo_asa">@kazuo_asa</a> @主催者さんに助けてもらった。</p>

<h2 id="%E8%87%AA%E5%B7%B1%E7%B4%B9%E4%BB%8B">自己紹介</h2>

<p>みんなで自己紹介</p>

<p>ほぼ何回か参加していて見知っていた人だった。
まあ、久しぶりの参加の人もいたけど。</p>

<h2 id="%E4%BB%8A%E5%9B%9E%E3%81%AE%E3%81%8A%E8%8F%93%E5%AD%90">今回のお菓子</h2>

<p>今回は駄菓子を持って来たけど、横に長く座っていた関係もあったのか、まああまり減らなかった。</p>

<p><img src="/images/20180414_dagashi.jpg" alt="串カツ田中で懇親会" /></p>

<h2 id="%E3%82%82%E3%81%8F%E3%82%82%E3%81%8F">もくもく</h2>

<p>とりあえず、久しぶりに Qt を触る。</p>

<p><a href="https://github.com/sharkpp/qtauthwith">qtauthwith</a> を触ってみるも、ビルドエラーが出るのでひたすら修正。</p>

<p>最終的にビルドは通るようになったけど... UIがそういえば実装するの超面倒だったな、と思い出して QtQuick で実装できないか模索。</p>

<h2 id="%E3%81%A8%E3%81%A4%E3%81%9C%E3%82%93%E3%81%AE%E6%9A%97%E5%8F%B7%E9%80%9A%E8%B2%A8">とつぜんの暗号通貨</h2>

<p>勉強会のイベントページに、なんか企業アカウントっぽいのが登録されているなぁと思ってたけど、開始時間過ぎても来ていなかったので、なんだったんだろうな、とは思ってた。
が、しばらくしてから、２人組の人が来たが、その片方は外国の方だったので、ちとびっくり。</p>

<p>どうやら、外国の方の方は暗号通貨 Dash と言う日本ではマイナーな仮想通貨の伝道師的な人だったようで、公式の Wallet アプリが Qt で作られている関係で参加した様子。</p>

<h3 id="%E6%9A%97%E5%8F%B7%E9%80%9A%E8%B2%A8-dash">暗号通貨 Dash</h3>

<p><a href="https://www.dash.org/jp/">DASH公式サイト | DASH暗号通貨 — Dash</a></p>

<p>どうやら Core Wallet って管理アプリが Qt 4 で作られているらしい。</p>

<p>話してくれたのは、暗号通貨 Dash のコミュニティマネージャ兼伝道師兼いろいろ。</p>

<p>Dash は bitcoin のハードフォークで Core Wallet が Qt 製なのも bitcoin から受け継いだもの。</p>

<p>bitcoin はマイニングで得た報酬はマイニングした人にのみ分配されるが、Dash はマイニングで発掘された報酬を開発者に分ける仕組みがあるとのこと。</p>

<p>分配の割合は 45:45:10 で、マイナー：マスターノード（いっぱいコインを持ってる人？）：コミュニティに分配され、コミュニティに分配された報酬は、投票により開発者やマーケティングなどに使われるらしい。</p>

<p>この辺り、面白い戦略をとってると思う。</p>

<p><a href="https://github.com/dashpay/dash">dashpay/dash: Dash - Reinventing Cryptocurrency</a> が公式リポジトリっぽい。</p>

<h4 id="%E6%A8%99%E6%BA%96-wallet-%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6">標準 wallet について</h4>

<ul>
<li>Qt 4 で実装</li>
<li>改善する箇所が多い。例えば、

<ul>
<li>エクスポートはCSV形式なので、JSONなどへの対応する、など。</li>
<li>送信先の選択画面、フィルタとかもできないし、一人一人選択しないといけない。</li>
<li>Multisig 機能があるがそのUIがないのでコマンドラインを直接指定しないといけない。</li>
</ul></li>
<li>つまるところ、Qtの開発者がもっと増えて欲しい</li>
<li>先の10%をどういう風に使うかを、フォーラムで提案＆投票し決める仕組みがある。</li>
<li>改善の提案はPRでもフォーラムでもできるけど、大きな改善はフォーラムで提案すると予算が降りるかもしれない。</li>
</ul>

<h3 id="solarcoin">SolarCoin</h3>

<p>公式はたぶんこれ <a href="https://solarcoin.org/">SolarCoin | SolarCoin</a> 。</p>

<p>どうやらこっちにも携わっているみたい。</p>

<p>dash のどこかのバージョンのフォーク。</p>

<p>コアな開発者は３人ぐらいなので、こちらも増えて欲しい、とのこと。</p>

<h2 id="%E6%87%87%E8%A6%AA%E4%BC%9A">懇親会</h2>

<p>会場近くの串カツ屋さん。なんか両隣は結構有名なお店らしい。</p>

<p><img src="/images/20180414_kushikatsu.jpg" alt="串カツ田中で懇親会" /></p>

<h2 id="%E6%9C%80%E5%BE%8C%E3%81%AB">最後に</h2>

<p>久しぶりに参加したけど、久しぶりにQt触っていろいろと忘れていたこともあった。
けど、強制的に時間を確保しもくもくするのはやはり悪くない。
あと、Dash コインの話もいろいろ面白かった。</p>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[じゅげむったーの開発日記 その８]]></title>
            <link href="http://www.sharkpp.net/blog/2017/10/21/jugemutter-development-diary-8th.html"/>
            <updated>2017-10-21T17:41:00+00:00</updated>
            <id>http://www.sharkpp.net/blog/2017/10/21/jugemutter-development-diary-8th.html</id>
            <content type="html"><![CDATA[<p>今回は、明日行われる <a href="https://techbookfest.org/event/tbf03">技術書典３</a> に前日入りして、<a href="https://qt-users.connpass.com/event/68878/">Qt 勉強会 @ Tokyo #52</a> に参加してきました。</p>

<p>東京の勉強会はすごく久しぶりの参加でした。</p>

<p>以前は、誰かしらが発表をして、それを聞く感じの会でしたが、最近はもくもくがメインのようでした。</p>

<p>レポジトリは ... <a href="https://github.com/sharkpp/Jugemutter">sharkpp/Jugemutter: 長文投稿専用クライアント「じゅげむったー」</a> となります。</p>

<h2 id="twitter-api-%E3%81%AE-%22could-not-authenticate-you.%22-%E5%95%8F%E9%A1%8C">Twitter API の "Could not authenticate you." 問題</h2>

<p>Twitter API への要求で <code>Could not authenticate you.</code> とレスポンスが返ってくる問題、どうも <a href="https://bugreports.qt.io/browse/QTBUG-61125">[QTBUG-61125] QOAuth1 creates an invalid signature for percent encoded query - Qt Bug Tracker</a> のバグが原因ではなかった様子。</p>

<p>なので、ちょっと踏み込んで調べて見ることにする。</p>

<p>とりあえず、比較のために PHP で同じように Twitter API を使って見ることに。</p>

<p>ライブラリは <a href="https://github.com/risan/oauth1">risan/oauth1: 🔐 OAuth 1.0 client library for PHP</a> をとりあえず試して見る。</p>

<p>何はともあれ composer をインストール</p>

<pre><code class="console">$ php -r "copy('https://getcomposer.org/installer', 'composer-setup.php');"
$ php -r "if (hash_file('SHA384', 'composer-setup.php') === '544e09ee996cdf60ece3804abc52599c22b1f40f4323403c44d44fdfdd586475ca9813a858088ffbc1f233e9b180f061') { echo 'Installer verified'; } else { echo 'Installer corrupt'; unlink('composer-setup.php'); } echo PHP_EOL;"
$ php composer-setup.php
$ php -r "unlink('composer-setup.php');"
</code></pre>

<p>ライブラリをインストール</p>

<pre><code class="console">$ php composer.phar require risan/oauth1
</code></pre>

<p>で、いろいろ試している..</p>

<p>ソースは <a href="https://github.com/risan/oauth1#basic-usage">risan/oauth1: Basic Usage</a> を基に <code>$ sudo php -S localhost:80 -t .</code> で動かします。</p>

<pre><code class="php">&lt;?php

// Start session.
session_start();

// Include Composer autoload file.
require 'vendor/autoload.php';

// Create a new instance of OAuth1 client for Twitter.
$oauth1 = new OAuth1\OAuth1([
    'consumer_key'      =&gt; 'YOUR_TWITTER_CONSUMER_KEY',
    'consumer_secret'   =&gt; 'YOUR_TWITTER_CONSUMER_SECRET',
    'request_token_url' =&gt; 'https://api.twitter.com/oauth/request_token',
    'authorize_url'     =&gt; 'https://api.twitter.com/oauth/authorize',
    'access_token_url'  =&gt; 'https://api.twitter.com/oauth/access_token',
    'callback_url'      =&gt; 'http://localhost:80', // Optional
    'resource_base_url' =&gt; 'https://api.twitter.com/1.1/'
]);

// STEP 4: ACCESS PROTECTED RESOURCE.
if (isset($_SESSION['access_token'])) {
    // Retrieve the saved AccessToken instance (see STEP 3).
    $accessToken = unserialize($_SESSION['access_token']);

    // Set access token.
    $oauth1-&gt;setGrantedAccessToken($accessToken);

    // Get authenticated user's timeline.
    // @return Psr\Http\Message\ResponseInterface instance
    //$response = $oauth1-&gt;get('statuses/user_timeline.json');
    $response = $oauth1-&gt;post('statuses/update.json', [
        'query' =&gt; [
        //'form_params' =&gt; [ // risan/oauth1 が対応していない様子
            'status' =&gt; 'test',
        ]
    ]);

    echo $response-&gt;getBody()-&gt;getContents();
}

// STEP 3: GET ACCESS TOKEN.
elseif (isset($_GET['oauth_token']) &amp;&amp; isset($_GET['oauth_verifier'])) {
    // Retrieve the previously generated request token (see STEP 1).
    $requestToken = unserialize($_SESSION['request_token']);

    // Get access token.
    // @return OAuth1\Tokens\AccessToken instance
    $accessToken = $oauth1-&gt;accessToken($requestToken, $_GET['oauth_token'], $_GET['oauth_verifier']);

    // Serialize AccessToken instance and save it to session.
    $_SESSION['access_token'] = serialize($accessToken);

    // No longer need request token.
    unset($_SESSION['request_token']);

    // Reload page.
    header("Location: {$_SERVER['PHP_SELF']}");
    exit();
}

// STEP 1: Get request token.
// STEP 2: Redirect to authorization page.
else {
    // Get request token.
    // @return OAuth1\Tokens\RequestToken instance
    $requestToken = $oauth1-&gt;requestToken();

    // Serialize RequestToken instance and save to session.
    $_SESSION['request_token'] = serialize($requestToken);

    // Redirect to authorization url.
    $authorizationUrl = $oauth1-&gt;buildAuthorizationUrl($requestToken);
    header("Location: {$authorizationUrl}");
    exit();
}
</code></pre>

<p>あれ？</p>

<p><del><code>{"code":32,"message":"Could not authenticate you."}</code> になるっぽい、なぜだろう？</del> <code>risan/oauth1</code> の実装が POST の フォームに対応していなかっただけのようだ。</p>

<p>↑から、URLのクエリ形式で送れば大丈夫っぽい。</p>

<blockquote class="twitter-tweet" data-lang="ja"><p lang="ja" dir="ltr">むぅPOSTのフォームではなくURLのクエリで送れば(や%も大丈夫っぽいなぁ (おわり <a href="https://twitter.com/hashtag/qtjp?src=hash&amp;ref_src=twsrc%5Etfw">#qtjp</a> <a href="https://twitter.com/hashtag/jugemutter?src=hash&amp;ref_src=twsrc%5Etfw">#jugemutter</a></p>&mdash; これでチーム「さめたすたす」は最強だ！ (@sharkpp) <a href="https://twitter.com/sharkpp/status/921656868535021570?ref_src=twsrc%5Etfw">2017年10月21日</a></blockquote>

<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

<p>何か勘違いしているのか？</p>

<p>というところでタイムアップ。</p>

<h2 id="twitter-api-reference-%E3%81%AE-url-%E3%81%8C%E5%A4%89%E3%82%8F%E3%81%A3%E3%81%9F%EF%BC%9F">Twitter API reference の URL が変わった？</h2>

<p>なんか、Twitter API のリファレンスページのアドレスが変わっている様子。</p>

<pre><code>https://dev.twitter.com/rest/reference/post/statuses/update
</code></pre>

<p>↓</p>

<pre><code>https://developer.twitter.com/en/docs/tweets/post-and-engage/api-reference/post-statuses-update
</code></pre>

<p>リダイレクトで飛ばして欲しかったなぁ。</p>

<h2 id="%E5%8B%89%E5%BC%B7%E4%BC%9A">勉強会</h2>

<h3 id="qt-contributors-summit-2017-%E3%81%A8-qt-world-summit-2017-%E3%81%AE%E5%A0%B1%E5%91%8A">Qt contributors summit 2017 と Qt World Summit 2017 の報告</h3>

<p>2017年10月9日〜10月10日に開催された <a href="https://www1.qt.io/event/qt-contributors-summit-2017/">Qt Contributors' Summit 2017</a> および、2017年10月10日〜10月12日に開催された <a href="https://www1.qt.io/event/qt-world-summit-2017/">Qt World Summit</a> の<a href="https://twitter.com/takumiasaki">朝木卓見(@takumiasaki)</a> さんによる報告。</p>

<p>関連するリンク</p>

<ul>
<li><a href="https://wiki.qt.io/Qt_contributors_summit_2017">Qt contributors summit 2017 - Qt Wiki</a></li>
<li><a href="https://wiki.qt.io/Qt_contributors_summit_2017_Program">Qt contributors summit 2017 Program - Qt Wiki</a> - セッションプログラム一覧</li>
<li><a href="https://wiki.qt.io/QtCS2017_QtCore">QtCS2017 QtCore - Qt Wiki</a> - 該当のセッションで出た話</li>
<li><a href="http://blog.qt.io/blog/2017/10/11/qt-3d-studio-source-code-pre-release-snapshots-available/">Qt 3D Studio Source Code and Pre-Release Snapshots Available - Qt Blog</a></li>
<li><a href="https://github.com/KDAB">KDAB</a></li>
</ul>

<h3 id="qt-3d-studio-%E3%81%AE%E7%B4%B9%E4%BB%8B">Qt 3D Studio の紹介</h3>

<p><a href="https://twitter.com/shin1_okada">岡田 真一(@shin1_okada)</a> さんによる、Qt 3D Studio の紹介。</p>

<p>現状、macOS向けは、ビルドできるけど大きなデモを動かす、Qt Creator から動作させる、などでクラッシュする、とのこと。</p>

<p>関連するリンク</p>

<ul>
<li><a href="http://blog.qt.io/blog/2017/10/11/qt-3d-studio-source-code-pre-release-snapshots-available/">Qt 3D Studio Source Code and Pre-Release Snapshots Available - Qt Blog</a></li>
<li><a href="https://codereview.qt-project.org/#/admin/projects/qt3dstudio/qt3dstudio">codereview.qt-project Code Review</a> - デフォルトだと submodule が取得されないので注意</li>
</ul>

<h2 id="%E5%8F%82%E8%80%83">参考</h2>

<ul>
<li><a href="https://qiita.com/hnw/items/d72815e2d45f898d9184">SipHashについてのメモ - Qiita</a></li>
<li><a href="http://docs.guzzlephp.org/en/5.3/clients.html">Clients — Guzzle Documentation</a></li>
<li><a href="https://qiita.com/k-holy/items/4362b8cce85642e477ec">Windows + Goutte 3.0でHTTPSでのリクエストで発生するSSL証明書のエラー - Qiita</a></li>
<li><a href="https://qiita.com/mikakane/items/58c30b243bba697ec3fe">guzzle で Http通信する - Qiita</a></li>
<li><a href="https://developer.twitter.com/en/docs/tweets/post-and-engage/api-reference/post-statuses-update">POST statuses/update — Twitter Developers</a></li>
</ul>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[じゅげむったーの開発日記 その７]]></title>
            <link href="http://www.sharkpp.net/blog/2017/10/04/jugemutter-development-diary-7th.html"/>
            <updated>2017-10-04T01:05:00+00:00</updated>
            <id>http://www.sharkpp.net/blog/2017/10/04/jugemutter-development-diary-7th.html</id>
            <content type="html"><![CDATA[<p>前回に引き続き <a href="https://qt-users.connpass.com/event/67390/">Qt 勉強会 @ Nagoya No13 一区切り会 - connpass</a> に参加しました。
とりあえず、今回でもくもく会は一旦一区切りとなるので、このあとはボチボチと進めていこうかなと思います。</p>

<p>レポジトリは ... <a href="https://github.com/sharkpp/Jugemutter">sharkpp/Jugemutter: 長文投稿専用クライアント「じゅげむったー」</a> となります。</p>

<p>画面は、多言語対応をしたので載っけます。</p>

<p><img src="/images/2017_0930_jugemutter_jp.png" alt="日本語版" /></p>

<p>次はなんちゃっての英語版です。</p>

<p><img src="/images/2017_0930_jugemutter_en.png" alt="英語版" /></p>

<h2 id="twitter-api-%E3%81%A7-%22could-not-authenticate-you.%22-%E3%81%8C%E5%87%BA%E3%82%8B">Twitter API で "Could not authenticate you." が出る</h2>

<p>Twitter API への要求で <code>Could not authenticate you.</code> とレスポンスが返ってくる件、HMACとかの計算を手動でやって検証しようかと考えたけど、そうだその前に、Qtのバグトラッカーで登録ないか、と、探して見たら...</p>

<p><a href="https://bugreports.qt.io/browse/QTBUG-61125">[QTBUG-61125] QOAuth1 creates an invalid signature for percent encoded query - Qt Bug Tracker</a></p>

<p>まさに、ドンピシャなものが、４ヶ月も前の 5/31 に報告が上がっていました。</p>

<p>それでもって、修正完了の 5.9.2 でリリースらしい。</p>

<p><a href="https://wiki.qt.io/Qt_5.9_Release">Qt 5.9 Release - Qt Wiki</a> によると、この記事を書いている時点では <code>September 2017</code> に公開予定らしいので、もう少し待つ必要があるみたい。</p>

<p>まあ、今回の教訓は先にバグトラッカーを探すべきだったのかなぁと、言うこと。</p>

<h2 id="%E3%80%90%E6%82%B2%E5%A0%B1%E3%80%91%E3%81%98%E3%82%85%E3%81%92%E3%82%80%E3%81%A3%E3%81%9F%E3%83%BC%E7%94%A8twitter%E3%82%A2%E3%82%AB%E3%82%A6%E3%83%B3%E3%83%88%E3%81%8C%E5%87%8D%E7%B5%90%E3%81%95%E3%82%8C%E3%81%A6%E3%81%9F%E4%BB%B6%E3%80%90%E3%81%84%E3%81%A4%E3%81%AE%E3%81%BE%E3%81%AB%E3%80%91">【悲報】じゅげむったー用Twitterアカウントが凍結されてた件【いつのまに】</h2>

<p>とりあえず、APIの要求は、Qtのバグが原因で特定文字で必ずエラーが返ってくるらしいので、とりあえず諦めて他のことを進めることにしました。</p>

<p>で、何をやろうかと考えたところで、せっかくマルチアカウント管理を実装したので試してみようと久しぶりにサブ垢（公式垢として利用しようと登録したもの）へログインしたところ...</p>

<p><img src="/images/2017_0930_twitter_frozen_acctount.png" alt="凍結済みアカウント(再現)" /></p>

<p>ん？ んん？ は？ と、凍結！？ 
※ スクショは撮り忘れたので当時の状況を可能な限り再現しています</p>

<p>と、言うわけで、何時のまにか今流行り（？）の凍結祭りに参加していたようです。
とりあえず、慌てて解除方法をググり、凍結の解除申請をしました。</p>

<p>そして、30分後...</p>

<p><img src="/images/2017_0930_twitter_thawed_account.png" alt="凍結解除" /></p>

<p>ほっ。</p>

<p>ヘッダー画像やプロフィール画像、あとは本垢への相互フォロー、そして鍵垢と、諸々設定しました。</p>

<h2 id="%E5%A4%9A%E8%A8%80%E8%AA%9E%E5%AF%BE%E5%BF%9C">多言語対応</h2>

<p>Qt で .ts / .qm でのラベルなどの多言語対応、昔々もやった記憶があるけど、忘却の彼方に近いので、改めて調べた。</p>

<h3 id="%E8%A8%80%E8%AA%9E%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E6%8C%87%E5%AE%9A">言語ファイルの指定</h3>

<p><code>.pro</code> を開き、言語ファイルのパスを設定。パスは適時読み替えてください。
 複数言語ある場合は、、スペース区切りで後ろに追加します。</p>

<pre><code class="ini">     :
TRANSLATIONS = src/i18n/ja_JP.ts
     :
</code></pre>

<h3 id="%E7%BF%BB%E8%A8%B3%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E8%AA%AD%E3%81%BF%E8%BE%BC%E3%81%BF">翻訳ファイルの読み込み</h3>

<p>起動時に現在のロケールを元に言語ファイルを読み込む処理を実装します。</p>

<p><code>.qm</code> ファイルはアプリケーションのリソースとして埋め込み、そこから読むようにしています。</p>

<pre><code class="cpp">            :
    // 翻訳
    QString locale = QLocale::system().name();
    QTranslator translator;
    translator.load(locale, ":/i18n");
    a.installTranslator(&amp;translator);
            :
</code></pre>

<p><code>locale</code> の値は、日本語環境だったら <code>ja_JP</code> です。</p>

<p>リソースへの登録はこんな感じ</p>

<p><img src="/images/2017_0930_qm_in_qrc.png" alt="qmファイルのqrcへの登録" /></p>

<h3 id="%E7%BF%BB%E8%A8%B3%E5%AF%BE%E8%B1%A1%E3%81%AE%E6%8C%87%E5%AE%9A">翻訳対象の指定</h3>

<p>まずは、翻訳したいものを <a href="http://doc.qt.io/qt-5/qobject.html#tr"><code>tr(...)</code></a> で囲います。</p>

<pre><code class="diff">     if (tweetQueue.isEmpty()) {
          finishPost();
 -        QMessageBox::information(this, qAppName(), "投稿を完了しました。");
 +        QMessageBox::information(this, qAppName(), tr("Your post has been completed."));
          return;
      }
</code></pre>

<p>こんな感じ。</p>

<h3 id="%E7%BF%BB%E8%A8%B3%E5%AF%BE%E8%B1%A1%E3%81%AE%E6%8A%BD%E5%87%BA">翻訳対象の抽出</h3>

<p>QtCreator のメニューから「ツール」→「外部」と辿り「翻訳を更新(lupdate)」を実行します。</p>

<p><img src="/images/2017_0930_qtcreator_extrnal_tools_linguist.png" alt="翻訳を更新" /></p>

<p>すると、 先ほど、<code>tr(...)</code> で囲った部分や <code>.ui</code> ファイルから翻訳対象が抽出されファイルへ書き出されます。
ソース側の記述が変わった時は、同じように「翻訳を更新(lupdate)」を実行すると、変更が適用されます。</p>

<h3 id="%E7%BF%BB%E8%A8%B3">翻訳</h3>

<p>Linguist を起動し</p>

<p><img src="/images/2017_0930_linguist.png" alt="Linguist" /></p>

<p>抽出された文字列を翻訳していきます。</p>

<h3 id="qt-message-file-format-%E3%82%92%E3%83%93%E3%83%AB%E3%83%89">Qt message file format をビルド</h3>

<p><code>.ts</code> を <code>.qm</code> (Qt message file format)へと変換します。
GNU gettext の <code>.po</code> と <code>.mo</code> との関係と同じですね。</p>

<p>QtCreator のメニューから「ツール」→「外部」と辿り「翻訳をリリース(lrelease)」を実行します。
これで <code>.ts</code> から <code>.qm</code> へと変換します。</p>

<h3 id="%E8%B5%B7%E5%8B%95%E7%A2%BA%E8%AA%8D">起動確認</h3>

<p>実際に翻訳できているかどうかは、ロケールを切り替えると確認できます。</p>

<p>普通に起動すると……</p>

<p><img src="/images/2017_0930_jugemutter_jp.png" alt="日本語版" /></p>

<p>こう。</p>

<p>言語を英語にすると……</p>

<pre><code class="console"># LANG=en_US.UTF-8 open ./Jugemutter.app
</code></pre>

<p><img src="/images/2017_0930_jugemutter_en.png" alt="英語版" /></p>

<p>こうなります。</p>

<h2 id="%E5%8F%82%E8%80%83">参考</h2>

<ul>
<li><a href="https://kazuto-yoshida.com/twitter-unfreeze-application.html">Twitterアカウント凍結解除方法と申請入力例</a></li>
<li><a href="https://forum.qt.io/topic/57863/solved-how-to-embed-qm-translation-files-into-executable">[solved]How to embed qm translation files into executable | Qt Forum</a></li>
<li><a href="https://github.com/wireshark/wireshark/tree/master/ui/qt">wireshark/ui/qt at master · wireshark/wireshark</a></li>
<li><a href="http://doc.qt.io/qt-5/qtlinguist-hellotr-example.html">Hello tr() Example | Qt Linguist Manual</a></li>
</ul>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[じゅげむったーの開発日記 その６]]></title>
            <link href="http://www.sharkpp.net/blog/2017/09/27/jugemutter-development-diary-6th.html"/>
            <updated>2017-09-27T12:40:00+00:00</updated>
            <id>http://www.sharkpp.net/blog/2017/09/27/jugemutter-development-diary-6th.html</id>
            <content type="html"><![CDATA[<p>遅くなりましたが、今月も引き続き参加した <a href="https://qt-users.connpass.com/event/65548/">Qt 勉強会 @ Nagoya No12 - connpass</a> のまとめです。</p>

<p>重大発表があってちょっとびっくりでした。
それはともかく今回も長文投稿専用Twitterクライアントの開発の続きでした。</p>

<p>レポジトリは ... <a href="https://github.com/sharkpp/Jugemutter">sharkpp/Jugemutter: 長文投稿専用クライアント「じゅげむったー」</a> となります。</p>

<p>画面は...変わってないからいいですね。</p>

<h2 id="%E9%80%B2%E6%8D%97">進捗</h2>

<p>相変わらず <code>Could not authenticate you.</code> がなぜか出る、と。</p>

<p>そこで、先日に <a href="https://github.com/sharkpp/http-peeper">sharkpp/http-peeper: This is a proxy server for peeping HTTP/HTTPS communication, mainly for debugging.</a> と言うツールを NodeJS でサクッと作ってみました。
一言で言うと https 通信の間に割り込んで中身を見てしまうツールです。</p>

<p>今回は、これの改良というか改善？をして、他のソフトの通信の内容と比較してみました。</p>

<p>まあ、結果として、少なくともパラメータやヘッダなどには特に違いがなさそうだ、という事がわかりました。
困ったことに、全く解決になっていないです...</p>

<p>あとは、HMACなどの計算時に無駄にエスケープしている事で、サーバー側での検証時と値が違うのかなぁと。
まあ、そうだとすると Qt 側のバグなのですが...</p>

<p>と、まあそんなところで終了。</p>

<p>まあ、あとは重大発表として Qt 勉強会 @ Nagoya が残念なことに今回で一旦休止の発表があり（次回が一旦の〆）となってしまいました。
なかなか、会場の都合が付かないので難しいですねぇ。</p>

<h2 id="%E4%BB%96%E3%81%AE%E3%82%BD%E3%83%95%E3%83%88%E3%81%AE%E9%80%9A%E4%BF%A1%E3%82%92%E8%A6%97%E3%81%8D%E8%A6%8B">他のソフトの通信を覗き見</h2>

<p>先のツール（<a href="https://github.com/sharkpp/http-peeper">http-peeper</a>）、証明書は当然本物ではなく所謂オレオレ証明書と呼ばれているものを使っている都合、証明書の検証をしている（OpenSSL等のライブラリを使っている場合は基本検証している）とエラーが出てしまうのです。
そのために、そのままだと他のソフトには使えないのでした。
さてどうするか？と考えていたところ、そういえばオレオレ認証局の証明書を作りシステムに登録して信頼、その認証局で署名することで対応と書かれている記事を見かけた覚えがあったので、とりあえずツールに組み込む前に手作業でやって見ました。</p>

<h3 id="%E6%89%8B%E9%A0%86">手順</h3>

<p><code>openssl.conf</code> をコピーして書き換えたり、いろいろして見ましたが結局こんな感じで試しました。</p>

<pre><code class="console">$ mkdir demoCA
$ cd demoCA
$ mkdir newcerts certs crl private
$ chmod 700 private
$ touch index.txt
$ echo 00 |tee serial
$ openssl req -batch -new -x509 -sha256 -days 36500 -newkey rsa:4096 -out ca.crt -keyout demoCA/private/ca.key -subj "/C=JP/ST=Tokyo/L=Tokyo/O=root.http-peeper.local/OU=root.http-peeper.local/CN=root.http-peeper.local"
$ openssl rsa -in demoCA/private/ca.key -out demoCA/private/ca.key
$ openssl req -batch -new -sha256 -days 36500 -newkey rsa:4096 -out demoCA/server.csr -keyout demoCA/private/server.key -batch -subj "/C=JP/ST=Tokyo/L=Tokyo/O=root.http-peeper.local/OU=api.twitter.com/CN=api.twitter.com"
$ openssl rsa -in demoCA/private/server.key -out demoCA/private/server.key
$ openssl ca -batch -days 36500 -keyfile demoCA/private/ca.key -cert demoCA/ca.crt -in demoCA/server.csr -out demoCA/server.crt
</code></pre>

<p>そして <code>ca.crt</code> を開き</p>

<p><img src="/images/2017_0916_macos_cert_reg_to_system.png" alt="証明書の追加" /></p>

<p>と、システムに登録します。</p>

<p>登録したら「キーチェーンアクセス」から証明書を探し</p>

<p><img src="/images/2017_0916_macos_view_cert_detail.png" alt="証明書を右クリック" /></p>

<p>右クリックで「情報を見る」から「常に信頼」を選び</p>

<p><img src="/images/2017_0916_macos_trust_root_cert.png" alt="証明書を信頼" /></p>

<p>と信頼させます。</p>

<p><img src="/images/2017_0916_macos_trusted_cert.png" alt="キーチェーンアクセス" /></p>

<p>「キーチェーンアクセス」では「この証明書はこのアカウントにとって信頼されている物として指定されています」と表示されています。</p>

<p>あとは、 <code>server.key</code> と <code>server.crt</code> を</p>

<pre><code class="console">$ openssl x509 -in server.crt -out tmp.der -outform DER
$ openssl x509 -in tmp.der -inform DER -out server-cert.pem -outform pem
$ openssl rsa -in server.key -out tmp.der -outform DER
$ openssl rsa -in tmp.der -inform DER -out server-key.pem -outform pem
</code></pre>

<p>と .pem 形式に変換（元々.pemで利用していたため）し利用しました。</p>

<p>手順はツールに組み込んで自動化したいところですが、とりあえず他のソフトの通信を覗き見できるようになりました。</p>

<h2 id="%E5%8F%82%E8%80%83">参考</h2>

<ul>
<li><a href="http://qiita.com/mkgask/items/8d66dcada58a485e3585#_reference-0c1fe982bfae4639fb65">Chrome58以降でハネられないSHA-2でオレオレ認証局署名のあるオレオレ証明書 - Qiita</a></li>
<li><a href="http://qiita.com/ll_kuma_ll/items/13c962a6a74874af39c6#20170508%E8%BF%BD%E8%A8%98">オレだよオレオレ認証局で証明書つくる - Qiita</a></li>
<li><a href="http://qiita.com/softark/items/15a5280bd38c5dd97b48">オレオレ認証局とオレオレ証明書 - Qiita</a></li>
<li><a href="http://qiita.com/NakashimaKeisuke_zerodaynet/items/bfc77e5fe98b587532d0">SSL証明書設定でよくやってることをまとめる。 - Qiita</a></li>
<li><a href="http://qiita.com/kunichiko/items/12cbccaadcbf41c72735">RSA鍵、証明書のファイルフォーマットについて - Qiita</a></li>
<li><a href="https://hacknote.jp/archives/13939/">SSL証明書を.crtから.pemに変換する方法 | ハックノート</a></li>
<li><a href="http://certificate.fyicenter.com/2134_OpenSSL_ca_Error_..._directory_for_new_certificate_..._.html">OpenSSL - OpenSSL "ca" Error "... directory for new certificate ..."</a></li>
</ul>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[じゅげむったーの開発日記 その５]]></title>
            <link href="http://www.sharkpp.net/blog/2017/08/23/jugemutter-development-diary-5th.html"/>
            <updated>2017-08-23T01:50:00+00:00</updated>
            <id>http://www.sharkpp.net/blog/2017/08/23/jugemutter-development-diary-5th.html</id>
            <content type="html"><![CDATA[<p>さて、今月も引き続き参加した <a href="https://qt-users.connpass.com/event/62861/">Qt 勉強会 @ Nagoya No11 - connpass</a> のまとめ。</p>

<p>つぶやきは <a href="https://togetter.com/li/1146658">Qt 勉強会 @ Nagoya No11 つぶやきまとめ - Togetterまとめ</a> でまとめられています。</p>

<p>先月の勉強会から日付(YY.MM)が付かなくなりました。</p>

<p>さて、今回も長文投稿専用Twitterクライアントの開発の続きをしました。</p>

<p>レポジトリは ... <a href="https://github.com/sharkpp/Jugemutter">sharkpp/Jugemutter: 長文投稿専用クライアント「じゅげむったー」</a> です。</p>

<p><img src="/images/2017_0819_jugemutter1.png" alt="画面" /></p>

<h2 id="%E9%80%B2%E6%8D%97">進捗</h2>

<p><img src="/images/2017_0819_jugemutter2.png" alt="テスト画面" /></p>

<p>とりあえず、分割処理のいろんなパターンのテストがやっと通ったので、ようやく一山越えた感じです。
ここまで長かった。</p>

<p>で、<code>Could not authenticate you.</code> がなぜか出る、と。
これは、<a href="https://dev.twitter.com/overview/api/response-codes">Error Codes &amp; Responses — Twitter Developers</a> によると、『<ruby>ダイヤルしても通話を完了できませんでした。<rp>(</rp><rt>Your call could not be completed as dialed.</rt><rp>)</rp></ruby>』って意味らしい。</p>

<h2 id="wireshark-%E3%81%A7-https-%E3%81%AE%E4%B8%AD%E8%BA%AB%E3%81%AE%E7%A2%BA%E8%AA%8D">Wireshark で https の中身の確認</h2>

<p>Twitter の API への指示がおかしいらしいので、なんとか調べられないかとググってた所、Wiresharkでhttpsの中身が確認できるとの記事を発見。</p>

<pre><code># SSLKEYLOGFILE=~/tls_key.log {ChromeやFirefox、cURLなどのパス}
</code></pre>

<p>で起動し、Wireshark で</p>

<p><img src="/images/2017_0819_https_decrypt_in_wireshark.png" alt="Wireshark" /></p>

<p>と、このような設定をすれば良いらしい。</p>

<p>が、解析画面</p>

<p><img src="/images/2017_0819_wireshark.png" alt="Wireshark" /></p>

<p>を見ても、 <del><code>Decrypted SSL Data</code> なんてタブはもちろん、<code>Frame</code> などのタブも表示されていないので、もしかしてUIがQtベースになった時に何か変わったのかもしれない。</del></p>

<p><img src="/images/2017_0831_wireshark.png" alt="Wireshark" /></p>

<p><code>RSA keys list</code> の設定を触って居たら、なぜかタブが出るようになった。
実装自体はされているようだ。</p>

<p>あと、そもそもの話、Qtの通信を覗きたいのが目的。
なので、Qtで上の方法が使えないと意味がないんだけど使えるのだろうか？</p>

<h2 id="%E5%8F%82%E8%80%83">参考</h2>

<ul>
<li><a href="http://qiita.com/Hexa/items/ce0ac23526df12a64ad0">暗号化された Application Data を復号する - Qiita</a></li>
<li><a href="https://f-o.org.uk/2017/decrypting-https-traffic-without-a-key.html">Floating Octothorpe: Decrypting HTTPS traffic without a key</a></li>
<li><a href="https://serverfault.com/questions/263530/how-can-i-filter-https-when-monitoring-traffic-with-wireshark">How can I filter https when monitoring traffic with Wireshark? - Server Fault</a></li>
<li><a href="http://troushoo.blog.fc2.com/blog-entry-234.html">Wireshark を用いて、クライアント側の情報のみでHTTPS 通信を複合する方法</a></li>
<li><a href="http://qiita.com/toshihirock/items/acbf9800f7e784118e46">HTTPSのパケットをwiresharkで見てみる - Qiita</a></li>
<li><a href="https://gist.github.com/summerwind/a482dd1f8e9887d26199">Wireshark で HTTP/2 over TLS の通信をダンプする方法</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Projects/NSS/Key_Log_Format">NSS Key Log Format - Mozilla | MDN</a></li>
</ul>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[じゅげむったーの開発日記 その４]]></title>
            <link href="http://www.sharkpp.net/blog/2017/07/16/jugemutter-development-diary-4th.html"/>
            <updated>2017-07-16T18:10:00+00:00</updated>
            <id>http://www.sharkpp.net/blog/2017/07/16/jugemutter-development-diary-4th.html</id>
            <content type="html"><![CDATA[<p>ただいま、<a href="https://github.com/sharkpp/Jugemutter">じゅげむったー</a> の実装中なのです。</p>

<p>まあ、それはともかくとして、「じゅげむったー」実装中に Qt 関連で躓いた部分や発生した問題の解決方法を、メモしておいたら溜まってきたので一度放出しようかと。</p>

<h2 id="%E3%83%89%E3%83%AD%E3%83%83%E3%83%97%E3%83%80%E3%82%A6%E3%83%B3%E5%9E%8B%E3%81%AE%E3%83%80%E3%82%A4%E3%82%A2%E3%83%AD%E3%82%B0%E3%82%92%E8%A1%A8%E7%A4%BA%E3%81%99%E3%82%8Bmacos">ドロップダウン型のダイアログを表示する(macOS)</h2>

<p>macOS でウインドウのタイトルバーの直下からまるで舌ベロのように垂れ下がるドロップダウン形式のダイアログの実装方法。</p>

<p><img src="/images/2017_0716_macOS_QDialog_sheet_style.png" alt="QDialogのSheetスタイル" /></p>

<p>こんな感じのダイアログの表示スタイルです。</p>

<p>Apple 的には <code>[Sheet](https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/Sheets/Concepts/AboutSheets.html)</code> って名称らしいですね。</p>

<pre><code class="cpp">#if defined(Q_OS_MAC)
    setWindowFlags(Qt::Sheet);
#endif
</code></pre>

<p>これだけです。</p>

<p><code>#if</code> と <code>#endif</code> はなくても良さそうですが、一応。</p>

<p>そうして <code>.exec()</code> などを呼び出せば表示できます。</p>

<h2 id="%E3%83%AA%E3%82%B9%E3%83%88%E4%B8%8B%E9%83%A8%E3%81%AE%E8%BF%BD%E5%8A%A0%E3%82%84%E5%89%8A%E9%99%A4%E3%83%9C%E3%82%BF%E3%83%B3macos">リスト下部の追加や削除ボタン(macOS)</h2>

<p><img src="/images/2017_0716_macOS_list_buttons.png" alt="リスト下部のボタン" /></p>

<p>こんな感じでリストの下部に追加や削除のボタンがついているやつ。</p>

<p>これは Apple 的には <code>NSAddTemplate</code> と <code>NSRemoveTemplate</code> って言うらしい。</p>

<p>この機能はどうやら実装されていないようなので、レイアウトとボタンをそれらしく配置することで再現するしかない様です。
まあ、Windows や Linux でも同じ機能にしたいなら、そちらの方が良いかもですね。</p>

<h2 id="qdialog-%E3%81%AE%E5%A4%A7%E3%81%8D%E3%81%95%E3%82%92%E3%82%B3%E3%83%B3%E3%83%86%E3%83%B3%E3%83%84%E3%81%AB%E5%90%88%E3%82%8F%E3%81%9B%E3%82%8B">QDialog の大きさをコンテンツに合わせる</h2>

<p>コンストラクタで <a href="http://doc.qt.io/qt-5/qwidget.html#adjustSize">void QWidget::adjustSize()</a> を呼び出せばOK。</p>

<pre><code class="cpp">MyDialog::MyDialog(QWidget *parent)
    : QDialog(parent)
    , ui(new Ui::MyDialog)
{
    ui-&gt;setupUi(this);
    adjustSize();
}
</code></pre>

<h2 id="%E3%82%AA%E3%83%BC%E3%83%90%E3%83%BC%E3%83%AD%E3%83%BC%E3%83%89%E3%81%95%E3%82%8C%E3%81%9F%E3%82%B7%E3%82%B0%E3%83%8A%E3%83%AB%E3%81%A8%E3%81%AE%E6%8E%A5%E7%B6%9A%E6%96%B9%E6%B3%95">オーバーロードされたシグナルとの接続方法</h2>

<p>Qt 5 から？だったか <code>connect(hoge, SIGNAL(...), ...)</code> ではなく <code>connect(hoge, &amp;..., ...)</code> で記述できるようになった。
なったのだけど、じゃあオーバーロードして宣言されているシグナルとの接続はどうするんだろう、と。</p>

<p>ちょうど必要な状況にぶち当たったので調べてみることに。</p>

<p>まず、</p>

<pre><code class="cpp">    connect(m_tagListWidget, &amp;QComboBox::currentIndexChanged,
            this, &amp;TagInput::onTagListSelected);
</code></pre>

<p>こんな感じで記述すると <code>error: no matching member function for call to 'connect'</code> みたいなエラーが出ます。</p>

<p>解決方法は、<code>QtGlobal</code> の <a href="http://doc.qt.io/qt-5/qtglobal.html#qOverload">QOverload</a> テンプレートクラスを利用すればいいみたいです。</p>

<pre><code class="cpp">    connect(m_tagListWidget, QOverload&lt;int&gt;::of(&amp;QComboBox::currentIndexChanged),
            this, &amp;MyClass::onCurrentIndexChanged);
</code></pre>

<p>C++14 が有効であれば、</p>

<pre><code class="cpp">    connect(m_tagListWidget, qOverload&lt;int&gt;(&amp;QComboBox::currentIndexChanged),
            this, &amp;MyClass::onCurrentIndexChanged);
</code></pre>

<p>こうれば良いようです。</p>

<h2 id="%E5%AD%90%E8%A6%81%E7%B4%A0%E3%81%B8%E3%82%B9%E3%82%BF%E3%82%A4%E3%83%AB%E3%82%B7%E3%83%BC%E3%83%88%E3%82%92%E9%81%A9%E7%94%A8%E3%81%95%E3%81%9B%E3%81%AA%E3%81%84">子要素へスタイルシートを適用させない</h2>

<p>ウィジェットをカスタマイズするためにスタイルシートで単純に</p>

<pre><code class="css">QFrame { background: #F90; }
</code></pre>

<p>とした場合、これはもちろん、指定した要素に適用されます。</p>

<p>そして、実はこの時に子要素が存在していた場合、その子要素にまでその指定が効いてしまいます。
まあ、HTML のスタイルシートとして考えた場合には、確かにそれはそれで正しいのですが、ちょっと困り者ですね。</p>

<p>では、どうするか？</p>

<pre><code class="css">.QFrame { background: #F90; }
</code></pre>

<p>もしくは</p>

<pre><code class="css">#orangeColor { background: #F90; }
</code></pre>

<p>と要素を限定すればOKです。</p>

<h2 id="qtcreator-%E3%81%A7-qtoolbar-%E3%82%92%E8%87%AA%E7%94%B1%E3%81%AB%E8%A8%AD%E7%BD%AE%E3%81%99%E3%82%8B">QtCreator で QToolBar を自由に設置する</h2>

<p>QtCreator のデザイナでは、どうやら <a href="http://doc.qt.io/qt-5/qtoolbar.html">QToolBar</a> は、ウインドウ内に一つで、<code>QLabel</code> など他のウィジェットのように自由には配置できないようです。
もっとも、普通のアプリケーションでは問題ないとは思います。</p>

<p><code>QToolBar</code> をウィジェット的に扱う場合にはどうするか？</p>

<p>直接 .ui ファイルを編集します。
開くと、「このファイルはデザインモード以外では編集できません。」と出ますし、本来はダメなのですが...
どうしてもデザイナ上で扱いたかったんです。</p>

<p>手順は</p>

<ol>
<li>デザイナで QWidget を追加し、<code>objectName</code> を指定</li>
<li>対象の .ui を「エディタを指定して開く」→「テキストエディタ」で開く</li>
<li>1で指定した名前を探す</li>
<li>クラス名を変更する</li>
<li>ファイルを保存し閉じる</li>
<li>デザイナで開き直す</li>
</ol>

<p>となります。</p>

<p>クラス名の変更は</p>

<pre><code class="diff">      &lt;item&gt;
-      &lt;widget class="QWidget" name="widget1"&gt;
+      &lt;widget class="QToolBar" name="widget1"&gt;
        &lt;property name="sizePolicy"&gt;
</code></pre>

<p>こんな感じですね。</p>

<h2 id="qtoolbar-%E3%81%A7%E3%82%B9%E3%82%BF%E3%82%A4%E3%83%AB%E3%82%B7%E3%83%BC%E3%83%88%E3%81%AE%E6%8C%87%E5%AE%9A%E3%81%8C%E5%8F%8D%E6%98%A0%E3%81%95%E3%82%8C%E3%81%AA%E3%81%84macos%E9%99%90%E5%AE%9A%EF%BC%9F">QToolbar でスタイルシートの指定が反映されない(macOS限定？)</h2>

<p>macOS ではどうやらスタイルシートの実装に不具合なのか仕様なのかがあるようで、背景色の指定がうまくできない時があるようです。
<a href="https://bugreports.qt.io/browse/QTBUG-12717?focusedCommentId=216435&amp;page=com.atlassian.jira.plugin.system.issuetabpanels%3Acomment-tabpanel#comment-216435">[QTBUG-12717] Background color for QToolBar is not stylable on Mac - Qt Bug Tracker</a> では <code>border</code> を指定し問題を回避できると書かれていました。</p>

<pre><code class="css">QToolBar {
    background: red;
    border: none;
}
</code></pre>

<p>こんな感じです。</p>

<h2 id="qtoolbar-%E3%81%AE%E3%83%87%E3%82%B6%E3%82%A4%E3%83%B3%E3%82%92%E3%82%AB%E3%82%B9%E3%82%BF%E3%83%9E%E3%82%A4%E3%82%BA">QToolbar のデザインをカスタマイズ</h2>

<p>完全にメモです。</p>

<p><a href="https://github.com/sharkpp/QToolbarCustomStyleSample">sharkpp/QToolbarCustomStyleSample</a> で利用したサンプルを公開しています。</p>

<h3 id="%E3%81%98%E3%82%85%E3%81%92%E3%82%80%E3%81%A3%E3%81%9F%E3%83%BC">じゅげむったー</h3>

<p><img src="/images/2017_0716_QToolbar_customize_Jugemutter.png" alt="QToolbar カスタマイズ：じゅげむったー" /></p>

<pre><code class="css">QToolBar {
    background: qlineargradient(spread:pad, x1:0, y1:0, x2:1, y2:0, stop:0 rgba(54, 54, 67, 255), stop:1 rgba(84, 84, 104, 255));
    border: none;
    icon-size: 48px;
}
QToolButton {
    background: transparent;
    padding: 2px;
    margin: 0;
    spacing: 0;
    border: none;
    width: 56px;
    height: 48px;
}
QToolButton:checked {
    background-color: qlineargradient(spread:pad, x1:0, y1:0, x2:1, y2:0, stop:0 rgba(13, 13, 16, 255), stop:1 rgba(33, 33, 41, 255));
}
QToolButton:hover, QToolButton:checked:hover {
    background-color: rgb(96, 96, 96);
}
QToolButton:pressed {
    background-color: rgb(64, 64, 64);
}
</code></pre>

<h3 id="qt-creator-%E9%A2%A8">Qt Creator 風</h3>

<p>あくまで、Qt Creator 風です。
選択時にアイコンの色が変わるとかその辺りは実装できていません。</p>

<p><img src="/images/2017_0716_QToolbar_customize_QtCreatorLike.png" alt="QToolbar カスタマイズ：Qt Creator 風" /></p>

<pre><code class="css">QToolBar {
    background: #444;
    border: none;
    icon-size: 24px;
    padding: 0;
    margin: 0;
    spacing: 0;
}
QToolBar QToolButton {
    background: transparent;
    border: none;
    width: 70px;
    padding: 4px;
    margin: 0;
    spacing: 0;
    color: #fff;
}
QToolBar QToolButton:checked,
QToolBar QToolButton:pressed {
    background: #282828;
}
</code></pre>

<h2 id="%E5%8F%82%E8%80%83">参考</h2>

<ul>
<li><a href="http://qiita.com/false-git@github/items/cbda9ddaaac5b6c81427">Qtアプリのサンプル - Qiita</a></li>
<li><a href="http://doc.qt.io/qt-5/appicon.html">Setting the Application Icon | Qt 5.8</a></li>
<li><a href="http://doc.qt.io/qt-5/qtwidgets-widgets-windowflags-example.html">Window Flags Example | Qt Widgets 5.8</a></li>
<li><a href="http://doc.qt.io/qt-5/qt.html#WindowType-enum">Qt Namespace #WindowType-enum | Qt Core 5.8</a></li>
<li><a href="https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/Sheets/Concepts/AboutSheets.html">About Sheets</a></li>
<li><a href="https://forum.qt.io/topic/33448/solved-resize-qdialog-to-fit-all-contents/9">[Solved] Resize QDialog to fit all contents? | Qt Forum</a></li>
<li><a href="http://www.qtcentre.org/threads/14099-How-to-stop-child-widgets-from-inheriting-parent-s-StyleSheet-and-use-system-default">How to stop child widgets from inheriting parent's StyleSheet and use system default?</a></li>
<li><a href="https://stackoverflow.com/questions/16794695/connecting-overloaded-signals-and-slots-in-qt-5">c++ - Connecting overloaded signals and slots in Qt 5 - Stack Overflow</a></li>
<li><a href="https://bugreports.qt.io/browse/QTBUG-12717">[QTBUG-12717] Background color for QToolBar is not stylable on Mac - Qt Bug Tracker</a></li>
<li><a href="https://stackoverflow.com/questions/10706357/nstableview-with-plus-and-minus-buttons">cocoa - NSTableView with Plus and Minus buttons - Stack Overflow</a></li>
</ul>
]]></content>
        </entry>
    </feed>