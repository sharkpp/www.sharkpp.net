<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <title><![CDATA[さめたすたすのお家]]></title>
    <link href="http://www.sharkpp.net/blog/categories/%E3%83%96%E3%83%AD%E3%82%B0.xml" rel="self"/>
    <link href="http://www.sharkpp.net/"/>
    <updated>2018-01-04T09:32:31+00:00</updated>
    <id>http://www.sharkpp.net/</id>
            <author>
            <name><![CDATA[sharkpp]]></name>                    </author>
        <generator uri="http://sculpin.io/">Sculpin</generator>
            <entry>
            <title type="html"><![CDATA[HAPPY NEW YEAR 2018]]></title>
            <link href="http://www.sharkpp.net/blog/2018/01/01/happy-new-year-2018.html"/>
            <updated>2018-01-01T17:35:00+00:00</updated>
            <id>http://www.sharkpp.net/blog/2018/01/01/happy-new-year-2018.html</id>
            <content type="html"><![CDATA[<p>明けましておめでとうございます。</p>

<p>ほむぺ開設 14 年目… だと思います、たぶん。
今年も一年よろしくお願いします。</p>

<p>では、今年の目標をば。</p>

<h2 id="%E7%9B%AE%E6%A8%99">目標</h2>

<ul>
<li><a href="https://github.com/sharkpp/Jugemutter">Jugemutter</a> の完成</li>
</ul>

<p>なんか公式が同じような機能を実装しているのでちょっとモチベが下がり気味だけど、とりあえずリリースしたいと思います。</p>

<h3 id="hsp%E9%96%A2%E9%80%A3">HSP関連</h3>

<ul>
<li>HSPコンテスト作品の製作！</li>
<li><a href="http://hsp-users.jp/">HSP関連サイト</a>の定期的な更新。</li>
<li>Advent Calendar の開催（三年目）</li>
<li>WINEの最新版でHSPが動くように！</li>
<li>macOSで利用できるドキュメントビューアの作成</li>
<li>HSP to rust トランスレータ</li>
</ul>

<h3 id="%E3%82%A2%E3%83%97%E3%83%AA%E9%96%A2%E9%80%A3">アプリ関連</h3>

<ul>
<li><a href="https://github.com/sharkpp/TimestampFreezer">TimestampFreezer</a> のバイナリ公開</li>
<li><a href="https://github.com/sharkpp/Jugemutter">Jugemutter</a> の完成</li>
<li>バイナリエディタを作りたい</li>
</ul>

<p>、、、できるかなぁ？</p>

<p>てなわけで、よろしくお願いいたします。</p>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[大晦日@2017]]></title>
            <link href="http://www.sharkpp.net/blog/2017/12/31/new-years-eve-2017.html"/>
            <updated>2017-12-31T22:10:00+00:00</updated>
            <id>http://www.sharkpp.net/blog/2017/12/31/new-years-eve-2017.html</id>
            <content type="html"><![CDATA[<h2 id="1-%E5%B9%B4%E3%82%92%E6%8C%AF%E3%82%8A%E8%BF%94%E3%82%8A">1 年を振り返り</h2>

<p>皆々様、今年一年如何でしたでしょうか？</p>

<p>私は……　一年ほとんどが忙しかった気がします。</p>

<p>良かった人も悪かった人も「<a href="http://hsproom.me/program/view/?p=146">除夜の鐘</a>」を突いて見るのはどうでしょうか？</p>

<p>と言うことで、今年の反省をば。</p>

<h2 id="%E7%B5%90%E6%9E%9C">結果</h2>

<p>まずは、今年の正月 <a href="/blog/2017/01/01/happy-new-year-2017.html">HAPPY NEW YEAR 2017</a> に掲げた目標です。</p>

<ul>
<li><a href="http://hsp-users.jp/">HSP関連サイト</a>の定期的な更新。</li>
<li>HSPコンテスト作品の製作！</li>
<li>Advent Calendar の開催</li>
<li>macOSで利用できるドキュメントビューアの作成</li>
<li><a href="https://github.com/sharkpp/TimestampFreezer">TimestampFreezer</a> のバイナリ公開</li>
<li>バイナリエディタを作りたい</li>
<li>macOS用のGUI Diff が欲しい</li>
<li>素材関係をもう少し整理</li>
<li>音素材の公開</li>
</ul>

<p>と、こんな感じ。</p>

<p><a href="http://hsp-users.jp/">HSP関連サイト</a>の定期的な更新は、なかなか上手くいかなかったです。
サイトのツイッター <a href="https://twitter.com/hsp_users_jp">@hsp_users_jp</a> も更新がなかなかできなかったです。</p>

<p>HSPコンテストは……　見事に落としました。</p>

<p>他には、<a href="/blog/2017/">アーカイブ - 2017</a> にある諸々や、年初めに <a href="http://doc.qt.io/qt-5/qtnetworkauth-index.html">Qt Network Authorization</a> を知ってから <a href="https://github.com/sharkpp/Jugemutter">Jugemutter</a> を作り始めてみたり、<a href="/blog/2017/10/23/techbookfest3.html">技術書典３</a>で知り合いのお手伝いをしたり、「<a href="http://qiita.com/advent-calendar/2017/hsp">Hot Soup Processor Advent Calendar 2017</a>」を主催してみたりとかして遊んでいました。</p>

<p>あ、今年も<a href="https://togetter.com/li/1073136">よんた@keita44_f4 さんの日本酒の感想ツイートまとめ</a>を更新してました。お酒美味しそうですね！</p>

<h2 id="%E5%8F%8D%E7%9C%81">反省</h2>

<p>とりあえず、HSPコンテスト来年こそは……</p>

<p>あと、ほったらかしのソフトとか、Jugemutter なんとかしたいです。</p>

<p>と言うあたりで今年の反省会終了です。</p>

<p>来年もよろしくお願いします。</p>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[Hot Soup Processor Advent Calendar 2017 まとめ]]></title>
            <link href="http://www.sharkpp.net/blog/2017/12/25/hsp-advent-calendar-2017-25th-day.html"/>
            <updated>2017-12-25T23:45:00+00:00</updated>
            <id>http://www.sharkpp.net/blog/2017/12/25/hsp-advent-calendar-2017-25th-day.html</id>
            <content type="html"><![CDATA[<p>こんにちは、こんばんは。</p>

<p><a href="http://qiita.com/advent-calendar/2017/hsp">Hot Soup Processor Advent Calendar 2017</a> の 最終日を担当する <a href="https://twitter.com/sharkpp">@sharkpp</a> です。</p>

<p>まず始めに、呼びかけに応え Hot Soup Processor Advent Calendar 2017 へご参加いただいた7名の皆様に深く感謝を。</p>

<p>昨年に引き続き HSP ユーザーのための HSP ユーザーによる Advent Calendar を開催して見ました。
それのまとめ的なものを最後に投稿してみようかと思います。</p>

<h2 id="%E6%8A%95%E7%A8%BF%E3%81%95%E3%82%8C%E3%81%9F%E8%A8%98%E4%BA%8B%E3%81%AE%E4%B8%80%E8%A6%A7">投稿された記事の一覧</h2>

<table>
<thead>
<tr>
  <th>日付</th>
  <th>執筆者</th>
  <th>記事</th>
</tr>
</thead>
<tbody>
<tr>
  <td>12/01</td>
  <td><a href="http://qiita.com/sharkpp">sharkpp</a></td>
  <td><a href="http://www.sharkpp.net/blog/2017/12/01/hsp-advent-calendar-2017-1st-day.html">Google Poly で公開されている素材を HSP 3 で利用してみよう</a></td>
</tr>
<tr>
  <td>12/02</td>
  <td><a href="http://qiita.com/y_tack">y_tack</a></td>
  <td><a href="https://qiita.com/y_tack/items/7eda1f2502de4611b4f7">（エターナル化してきた）OpenHSPの書写他</a></td>
</tr>
<tr>
  <td>12/03</td>
  <td><a href="http://qiita.com/mjhd-devlion">mjhd-devlion</a></td>
  <td><a href="https://qiita.com/mjhd-devlion/items/44d1a919b5485629e7e8">newlabの使い道を頑張って考えてみる</a></td>
</tr>
<tr>
  <td>12/04</td>
  <td><a href="http://qiita.com/hta393939">hta393939</a></td>
  <td><a href="https://qiita.com/hta393939/items/e6fb2399030287005b5f">HSP3.5 HGIMG4 で2Dビューポート表示</a></td>
</tr>
<tr>
  <td>12/05</td>
  <td><a href="http://qiita.com/exrd">exrd</a></td>
  <td><a href="http://fe0km.blog.fc2.com/blog-entry-125.html">Effekseerプラグインでhgimg4でも映えるエフェクトを！</a></td>
</tr>
<tr>
  <td>12/06</td>
  <td><a href="http://qiita.com/onionsoftware">onionsoftware</a></td>
  <td><a href="https://qiita.com/onionsoftware/items/d9c837725251ae89a376">シンプルな追いかけっこから始めるゲームメカニクス</a></td>
</tr>
<tr>
  <td>12/07</td>
  <td><a href="http://qiita.com/hta393939">hta393939</a></td>
  <td><a href="https://qiita.com/hta393939/items/7dc602552b71f784e61e">HSP3.5 HGIMG4 で高品質circle代用</a></td>
</tr>
<tr>
  <td>12/13</td>
  <td><a href="http://qiita.com/hatakoma">hatakoma</a></td>
  <td><a href="http://d.hatena.ne.jp/hatahata/20171213">あほべんとカレンダーで公開したミニゲームのソース公開しました。画像、音楽、効果音は再利用NGで。</a></td>
</tr>
<tr>
  <td>12/14</td>
  <td><a href="http://qiita.com/hta393939">hta393939</a></td>
  <td><a href="https://qiita.com/hta393939/items/b3eb2aeda07e5d5a9429">HSP3.5 HGIMG4 で複数カメラ視点描画</a></td>
</tr>
<tr>
  <td>12/15</td>
  <td><a href="http://qiita.com/hta393939">hta393939</a></td>
  <td><a href="https://qiita.com/hta393939/items/3e358e7e852b34b4552c">HSP3.5 HGIMG4 で物理サイコロもどき</a></td>
</tr>
<tr>
  <td>12/17</td>
  <td><a href="http://qiita.com/exrd">exrd</a></td>
  <td><a href="https://qiita.com/exrd/items/3fa31353df396ef53312">HSP3.5 で hgimg4 （再）入門</a></td>
</tr>
<tr>
  <td>12/19</td>
  <td><a href="http://qiita.com/hta393939">hta393939</a></td>
  <td><a href="https://qiita.com/hta393939/items/99e7dd7fa81714584d94">HSP3.5 HGIMG4 でイベント待ちを制御する</a></td>
</tr>
<tr>
  <td>12/20</td>
  <td><a href="http://qiita.com/hta393939">hta393939</a></td>
  <td><a href="https://qiita.com/hta393939/items/a8b2d88655f9c14b1001">HSP3.5 HGIMG4 で剛体をキネティック(強制指定)モードにする</a></td>
</tr>
<tr>
  <td>12/21</td>
  <td><a href="http://qiita.com/hta393939">hta393939</a></td>
  <td><a href="https://qiita.com/hta393939/items/aee255aa02a508e71552">HSP3.5 HGIMG4 でヘルプに書かれてないイベント動作紹介</a></td>
</tr>
<tr>
  <td>12/25</td>
  <td><a href="http://qiita.com/sharkpp">sharkpp</a></td>
  <td><a href="http://www.sharkpp.net/blog/2017/12/25/hsp-advent-calendar-2017-25th-day.html">Hot Soup Processor Advent Calendar 2017 まとめ</a></td>
</tr>
</tbody>
</table>

<h2 id="%E7%B5%90%E6%9E%9C">結果</h2>

<p><code>執筆率 = 15 / 25 = 60%</code></p>

<p>どのぐらいの日付が記事で埋まっているかの割合です。</p>

<p><code>参加率 = 7 / 15 = 46.7%</code></p>

<p>どんな人が書いたかグラフにすると</p>

<p><img src="/images/20171225_writer_graph.png" alt="書いた人" /></p>

<p>こんな感じ。</p>

<h2 id="%E6%8A%95%E7%A8%BF%E3%81%95%E3%82%8C%E3%81%9F%E8%A8%98%E4%BA%8B%E3%81%AE%E3%82%B8%E3%83%A3%E3%83%B3%E3%83%AB">投稿された記事のジャンル</h2>

<p><strong>独断と偏見で</strong>カテゴライズ</p>

<p><img src="/images/20171225_genre_graph.png" alt="ジャンル" /></p>

<p>今年は hgimg4 の記事がほとんどを占めていますね。</p>

<h2 id="%E6%B3%A8%E7%9B%AE%E8%A8%98%E4%BA%8B">注目記事</h2>

<p><strong>独断と偏見により</strong>、今回の Advent Calendar での注目記事を選びました。</p>

<p>あっ、紹介の順番がイコールで順位ということではありません。</p>

<ul>
<li>5日目の記事「<a href="http://fe0km.blog.fc2.com/blog-entry-125.html">Effekseerプラグインでhgimg4でも映えるエフェクトを！</a>」</li>
</ul>

<p><a href="https://effekseer.github.io/jp/">エフェクト制作ツール「Effekseer」</a> で作ったかっこいいエフェクトを hgimg4 で利用しようという内容の記事です。</p>

<p>最近、このツールを知って何かできないかなぁと思っていたところで、ババーン！と記事が出て来たので、思わず唸ってしまいました！</p>

<ul>
<li>6日目の記事「<a href="https://qiita.com/onionsoftware/items/d9c837725251ae89a376">シンプルな追いかけっこから始めるゲームメカニクス</a>」</li>
</ul>

<p>HSP作者のおにたまさんの記事です。</p>

<p>記事の内容はシンプルなルールのゲームの作り方を順序だてて解説しています。</p>

<p>今回は hgimg4 に関する記事が多く、これから HSP で 3D ゲームを作りたいという人にとって参考になることが多いのではないでしょうか？
また、それ以外の記事も、HSP の新たな面を見せてくれる良質な記事だと思います。</p>

<h2 id="%E6%9C%80%E5%BE%8C%E3%81%AB">最後に</h2>

<p>改めて、<a href="http://qiita.com/advent-calendar/2017/hsp">Hot Soup Processor Advent Calendar 2017</a> にご参加いただきました皆様、そして記事を呼んでくださいました読者の方々に感謝を。</p>

<p><strong>メリークリスマス！</strong></p>

<hr />

<p>この投稿は <strong><a href="http://qiita.com/advent-calendar/2017/hsp">Hot Soup Processor Advent Calendar 2017</a></strong> の <strong>25日目</strong>の記事です。</p>

<ul>
<li>21日目の記事: <a href="https://qiita.com/hta393939/items/aee255aa02a508e71552">HSP3.5 HGIMG4 でヘルプに書かれてないイベント動作紹介</a></li>
</ul>

<hr />
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[駆け足で Qt Network Authorization の使い方を紹介してみる]]></title>
            <link href="http://www.sharkpp.net/blog/2017/12/21/qt-advent-calendar-2017-21th-day.html"/>
            <updated>2017-12-21T23:45:00+00:00</updated>
            <id>http://www.sharkpp.net/blog/2017/12/21/qt-advent-calendar-2017-21th-day.html</id>
            <content type="html"><![CDATA[<p>こんにちは、こんばんは。</p>

<p><a href="http://qiita.com/advent-calendar/2017/qt">Qt Advent Calendar 2017</a> の 21日目を担当する <a href="https://twitter.com/sharkpp">@sharkpp</a> です。</p>

<p>昨日の <a href="https://qiita.com/Donokono/items/cb9167ee78eb758f8806">Qtでグラフを書いてみよう！</a> の自前のグラフ描画、すごかったですね。
自分も MFC で苦労して実装した覚えがあります。</p>

<p>さて、今回は Qt Network Authorization の使い方についてです。</p>

<h2 id="qt-network-authorization-%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6">Qt Network Authorization について</h2>

<p>Qt 5.8 から Technology Preview として追加された <a href="https://doc.qt.io/qt-5.10/qtnetworkauth-index.html">Qt Network Authorization</a> モジュールが、先日公開された Qt 5.10 でついに完全サポート(fully supported)されるようになりました。</p>

<p>モジュール自体は汎用的にできていて、Twitter や Facebook などの OAuth1/2 での認証に対応したサイトの利用も容易にできるようになっています。
ただ、現状は日本語の情報が少ないようなので、 Technology Preview で公開されて以降、この一年で調べたことなどをまとめていきたいと思います。</p>

<h2 id="%E7%92%B0%E5%A2%83">環境</h2>

<table>
<thead>
<tr>
  <th>バージョン</th>
  <th>注意点</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Qt 5.8</td>
  <td>TP、一部サービスでソースコードの修正が必要な不具合あり</td>
</tr>
<tr>
  <td>Qt 5.9</td>
  <td>TP2、OAuthの計算がおかしい場合がある</td>
</tr>
<tr>
  <td>Qt 5.10</td>
  <td>基本はこれ！</td>
</tr>
</tbody>
</table>

<h2 id="%E3%81%93%E3%81%AE%E4%B8%80%E5%B9%B4%E3%81%AE%E5%A0%B1%E5%91%8A">この一年の報告</h2>

<h3 id="%E8%A8%98%E4%BA%8B">記事</h3>

<p>自分が書いた Qt Network Authorization に関する記事です。</p>

<p>意外と本数が少なかった。</p>

<ul>
<li><a href="/blog/2017/01/28/first-impression-qt-network-authorization.html">はじめての Qt Network Authorization</a></li>
<li><a href="/blog/2017/03/25/twitter-api-using-qt-network-authorization.html">Qt Network Authorization を使った Twitter API の利用</a></li>
<li><a href="/blog/2017/02/28/dropbox-api-using-qt-network-authorization.html">Qt Network Authorization を使った Dropbox API　の利用</a></li>
<li><a href="/blog/2017/10/21/jugemutter-development-diary-8th.html">じゅげむったーの開発日記 その８</a></li>
</ul>

<h3 id="%E4%B8%8D%E5%85%B7%E5%90%88">不具合</h3>

<p>自身が見つけた不具合です。</p>

<p>他にもいろいろ見つけたけど、どちらかと言うと要望に近かったので登録していないです、実は。</p>

<ul>
<li><a href="https://bugreports.qt.io/browse/QTBUG-59725">QTBUG-59725</a>
callback時に表示するHTMLでマルチバイト文字が欠ける</li>
<li><a href="https://bugreports.qt.io/browse/QTBUG-60400">QTBUG-60400</a>
Content-type を text/javascript で返すAPIでエラーになる</li>
</ul>

<h2 id="%E3%82%AF%E3%83%A9%E3%82%B9%E3%81%AE%E8%AA%AC%E6%98%8E">クラスの説明</h2>

<p>基本的には <a href="https://doc.qt.io/qt-5.10/qtnetworkauth-module.html">Qt Network Authorization C++ Classes</a> に書かれているクラスがすべて。</p>

<table>
<thead>
<tr>
  <th>クラス名</th>
  <th></th>
</tr>
</thead>
<tbody>
<tr>
  <td><a href="https://doc.qt.io/qt-5.10/qoauth1.html">QOAuth1</a></td>
  <td>OAuth 1 プロトコル実装</td>
</tr>
<tr>
  <td><a href="https://doc.qt.io/qt-5.10/qoauth1signature.html">QOAuth1Signature</a></td>
  <td>OAuth 1 シグネチャメソッド実装</td>
</tr>
<tr>
  <td><a href="https://doc.qt.io/qt-5.10/qoauth2authorizationcodeflow.html">QOAuth2AuthorizationCodeFlow</a></td>
  <td>承認コード付与フロー実装、QOAuth 2 用</td>
</tr>
</tbody>
</table>

<p>現状実装されているのは、 OAuth 1.x 用と OAuth 2.x 用のクラスで、Twitter や DropBox などなどサービスによってバージョンがバラバラなので APIの仕様書をよく確認する必要があります。</p>

<p>数年前に調べた結果は 「<a href="/blog/2014/03/30/oauth-providers-list.html">OAuth 認証を提供しているサービスをまとめてみました</a>」にまとめてありますので参考にしてください。</p>

<h2 id="%E5%AE%9F%E8%A3%85%E6%96%B9%E9%87%9D">実装方針</h2>

<p>いろんな実装方法があると思いますが、ここでは、クラスを new して利用する方向性、つまり…</p>

<pre><code class="cpp">    void MainWindow::onSendTweet() {
        TwitterAPI t = this-&gt;twitter;
        t-&gt;tweet("hoge");
    }
</code></pre>

<p>このような利用方法を想定として実装してみます。</p>

<h2 id="%E6%BA%96%E5%82%99">準備</h2>

<p>まずは何はともあれ、 API を利用するためのキーを取得しましょう。</p>

<p>アプリの登録方法は探せば見つかると思いますが、「<a href="/blog/2014/03/30/oauth-providers-list.html">OAuth 認証を提供しているサービスをまとめてみました</a>」で直接のリンクを張っておきましたので参考にしてみてください。</p>

<h3 id="%E7%A7%98%E3%81%99%E3%81%B9%E3%81%8D%E6%83%85%E5%A0%B1%E3%82%92%E3%81%A9%E3%81%AE%E3%82%88%E3%81%86%E3%81%AB%E6%B8%A1%E3%81%99%E3%81%8B%EF%BC%9F">秘すべき情報をどのように渡すか？</h3>

<p>この場合の、「秘すべき情報」とは、APIを利用するアプリ用の、"App key" と "App secret" と呼ばれる類のアプリ登録時にサービス側から発行してもらった情報です。</p>

<p>現状は、「プロジェクト」→「ビルド設定」→「ビルドステップ」→「追加の引数」に追加します。</p>

<p><img src="/images/20171221_qmake_args_for_oauth_apps.png" alt="OAuthのアプリケーションキーを設定するためのQMake設定" /></p>

<p>「追加の引数」に設定する内容は</p>

<pre><code>DEFINES+=TWITTER_APP_KEY="..." DEFINES+=TWITTER_APP_SECRET="..."
</code></pre>

<p>こんな感じ。</p>

<p>ソース側で利用するときは</p>

<pre><code class="cpp">                  :
#define STR__(x) #x
#define STR_(x) STR__(x)
                  :
    setClientIdentifier(STR_(TWITTER_APP_KEY));
    setClientSharedSecret(STR_(TWITTER_APP_SECRET));
                  :
</code></pre>

<p>このような形で利用しています。</p>

<p>この方法、 <code>.pro.user</code> に保存されるため QtCreator が更新された場合は設定が消えてしまうのが注意点です。</p>

<p>何か良い方法はないのでしょうか？</p>

<h2 id="%E5%AE%9F%E8%A3%85%E3%81%99%E3%82%8B%E5%89%8D%E3%81%AB">実装する前に</h2>

<p>ここからは、OAuth のバージョンによってそのクラスや利用方法が違うので順に記載していきます。</p>

<p>OAuth 1 は Twitter を利用している <a href="https://github.com/sharkpp/Jugemutter">sharkpp/Jugemutter: 長文投稿専用ツイッタークライアント「じゅげむったー」</a> を、
OAuth 2 は DropBox を利用している <a href="https://github.com/sharkpp/NetworkStorageAccessSample">sharkpp/NetworkStorageAccessSample: Qt Network Authorization "Network storage access" sample</a> を
下敷きに書き進めているので、参考にしてみてください。</p>

<h2 id="oauth-1">OAuth 1</h2>

<p>Twitter の例</p>

<p>大まかな初期化フローは</p>

<pre><code class="mermaid">graph TD;

A["初期化"] --&gt; |API エンドポイントの指定| B

B["setTemporaryCredentialsUrl() / setAuthorizationUrl() / setTokenCredentialsUrl()"] --&gt; |API キーの指定| C

C["setClientIdentifier() / setClientSharedSecret()"] --&gt; |"Auth Token 未初期化"| D0["grant()"]
C --&gt; |"Auth Token 初期化済"| F

D0 --&gt; D1("authorizeWithBrowser 受信")

F["内部状態を認証済みに変更"] --&gt; J

D1 --&gt;G
D1 --&gt;H("requestFailed 受信")

G("granted 受信") --&gt; I

I["ID情報など問い合わせ"] --&gt;  J["API利用可能"]
</code></pre>

<p>こんな感じ</p>

<p><code>QOAuth1</code> クラスから派生します。</p>

<pre><code class="cpp">#include &lt;QtCore&gt;
#include &lt;QtNetwork&gt;
#include &lt;QtNetworkAuth&gt;

class Twitter
    : public QOAuth1
{
    Q_OBJECT
public:
    :
    :
};
</code></pre>

<p>とりあえず、利用するシグナルは</p>

<table>
<thead>
<tr>
  <th>シグナル名＆プロトタイプ</th>
  <th>概要</th>
</tr>
</thead>
<tbody>
<tr>
  <td><code>void QAbstractOAuth::authorizeWithBrowser(const QUrl &amp;url)</code></td>
  <td>ブラウザでの認証要求</td>
</tr>
<tr>
  <td><code>void QAbstractOAuth::granted()</code></td>
  <td>認証フローが正常終了した。つまり、APIを利用できるような状態になった</td>
</tr>
<tr>
  <td><code>void QAbstractOAuth::requestFailed(const Error error)</code></td>
  <td>認証フローが失敗した</td>
</tr>
</tbody>
</table>

<p>これだけです。</p>

<h3 id="api-%E3%82%A8%E3%83%B3%E3%83%89%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%81%AE%E6%8C%87%E5%AE%9A">API エンドポイントの指定</h3>

<pre><code class="cpp">    setTemporaryCredentialsUrl(QUrl("https://api.twitter.com/oauth/request_token"));
    setAuthorizationUrl(QUrl("https://api.twitter.com/oauth/authenticate"));
    setTokenCredentialsUrl(QUrl("https://api.twitter.com/oauth/access_token"));
</code></pre>

<h3 id="api-%E3%82%AD%E3%83%BC%E3%81%AE%E6%8C%87%E5%AE%9A">API キーの指定</h3>

<p>これは、開発サイトなどでアプリを登録されたときに発行されるキーの組です。
値自体はさらに暗号化されているのが望ましいと思います。</p>

<pre><code class="cpp">    setClientIdentifier("..."); // TWITTER_APP_KEY
    setClientSharedSecret("..."); // TWITTER_APP_SECRET
</code></pre>

<h3 id="authorizewithbrowser-%E3%82%B7%E3%82%B0%E3%83%8A%E3%83%AB">authorizeWithBrowser シグナル</h3>

<pre><code class="cpp"> connect(this, &amp;QAbstractOAuth::authorizeWithBrowser, [=](QUrl url) {
        QUrlQuery query(url);
        query.addQueryItem("force_login", "true");
        url.setQuery(query);
        QDesktopServices::openUrl(url);
    });
</code></pre>

<p><code>QAbstractOAuth::authorizeWithBrowser</code> のシグナルを処理します。</p>

<p>これは、ブラウザで認証を行う前に引数を加えたりする(<code>query.addQueryItem("force_login", "true");</code> がこの例での引数を追加する)ためのシグナルです。</p>

<p>ここは別にラムダ式じゃなくても問題ないです。</p>

<p><code>QDesktopServices::openUrl(url);</code></p>

<p>この静的関数を呼び出すとブラウザが開き、各サービスの認証ページにアクセスが可能です。</p>

<h3 id="granted-%E3%82%B7%E3%82%B0%E3%83%8A%E3%83%AB">granted シグナル</h3>

<p>認証が正常に終了した場合ためのシグナルです。</p>

<pre><code class="cpp">  connect(this, &amp;QAbstractOAuth::granted, this, &amp;Twitter::authenticated);
</code></pre>

<p>場合によっては</p>

<pre><code class="cpp">  connect(this, &amp;QAbstractOAuth::granted, this, [=]() {
    // 認証要求成功
    Q_EMIT authenticated();
    // 続けてID情報などを取得する
    verifyCredentials();
  });
</code></pre>

<p>のように、ID情報やアイコン等の情報を予め取得するのも良いかもしれません。</p>

<h3 id="requestfailed-%E3%82%B7%E3%82%B0%E3%83%8A%E3%83%AB">requestFailed シグナル</h3>

<p>要求が失敗した場合ためのシグナルです。</p>

<p>granted シグナル の場合と同じく、何らかの形でクラス外へ通知しUI側でメッセージを表示させるなどの対応が必要になると思います。</p>

<pre><code class="cpp">  connect(this, &amp;QAbstractOAuth::requestFailed, this, &amp;Twitter::authenticateFailed);
</code></pre>

<h3 id="api-%E3%81%AE%E5%88%A9%E7%94%A8">API の利用</h3>

<p>予め GET や POST などのメソッドが用意されているためそれを利用します。</p>

<pre><code class="cpp">virtual QNetworkReply * deleteResource(const QUrl &amp;url, const QVariantMap &amp;parameters = QVariantMap()) override;
virtual QNetworkReply * get(const QUrl &amp;url, const QVariantMap &amp;parameters = QVariantMap()) override;
virtual QNetworkReply * head(const QUrl &amp;url, const QVariantMap &amp;parameters = QVariantMap()) override;
virtual QNetworkReply * post(const QUrl &amp;url, const QVariantMap &amp;parameters = QVariantMap()) override;
virtual QNetworkReply * put(const QUrl &amp;url, const QVariantMap &amp;parameters = QVariantMap()) override;
</code></pre>

<p>こんな感じですね</p>

<pre><code class="cpp">    QUrl url("https://api.twitter.com/1.1/account/verify_credentials.json");
    QUrlQuery query(url);

    QVariantMap data;
    query.addQueryItem("include_entities", "false");
    query.addQueryItem("skip_status",      "true");
    query.addQueryItem("include_email",    "false");

    url.setQuery(query);

    QNetworkReply *reply = get(url);
    connect(reply, &amp;QNetworkReply::finished, this, [=](){
        auto reply_ = qobject_cast&lt;QNetworkReply*&gt;(sender());

        // ここで結果を処理
    });
</code></pre>

<p><code>QNetworkReply</code> の結果を JSON として処理する方法などは割愛します。</p>

<h2 id="oauth-2">OAuth 2</h2>

<p>DropBox の例</p>

<p>大まかな初期化フローは</p>

<pre><code class="mermaid">graph TD;

A["初期化"] --&gt; |API エンドポイントの指定| B

B["setAuthorizationUrl() / setAccessTokenUrl()"] --&gt; |API キーの指定| C

C["setClientIdentifier() / setClientIdentifierSharedKey()"] --&gt; |"Auth Token 未初期化"| D0["grant()"]
C --&gt; |"Auth Token 初期化済"| F

F["内部状態を認証済みに変更"] --&gt; J

D0 --&gt; D1("authorizeWithBrowser 受付")

D1 --&gt;G
D1 --&gt;H("requestFailed 受付")

G("granted 受付") --&gt; I

I["ID情報など問い合わせ"] --&gt;  J["API利用可能"]
</code></pre>

<p>こんな感じ</p>

<p><code>QOAuth2AuthorizationCodeFlow</code> クラスから派生します。</p>

<pre><code class="cpp">#include &lt;QtCore&gt;
#include &lt;QtNetwork&gt;
#include &lt;QtNetworkAuth&gt;

class DropBox
    : public QOAuth2AuthorizationCodeFlow
{
    Q_OBJECT
public:
    :
    :
};
</code></pre>

<p>とりあえず、利用するシグナルは</p>

<table>
<thead>
<tr>
  <th>シグナル名＆プロトタイプ</th>
  <th>概要</th>
</tr>
</thead>
<tbody>
<tr>
  <td><code>void QAbstractOAuth::authorizeWithBrowser(const QUrl &amp;url)</code></td>
  <td>ブラウザでの認証要求</td>
</tr>
<tr>
  <td><code>void QOAuth2AuthorizationCodeFlow::statusChanged(QAbstractOAuth::Status status)</code></td>
  <td></td>
</tr>
</tbody>
</table>

<p>これだけです。</p>

<h3 id="api-%E3%82%A8%E3%83%B3%E3%83%89%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%81%AE%E6%8C%87%E5%AE%9A">API エンドポイントの指定</h3>

<p><code>OAuth1</code> クラスとはメソッドが違っているので注意です。</p>

<pre><code class="cpp">    setAuthorizationUrl(QUrl("https://www.dropbox.com/oauth2/authorize"));
    setAccessTokenUrl(QUrl("https://api.dropbox.com/oauth2/token"));
</code></pre>

<h3 id="api-%E3%82%AD%E3%83%BC%E3%81%AE%E6%8C%87%E5%AE%9A">API キーの指定</h3>

<p>これは、開発サイトなどでアプリを登録されたときに発行されるキーの組です。
値自体はさらに暗号化されているのが望ましいと思います。</p>

<p><code>OAuth1</code> クラスとはメソッドが違っているので注意です。</p>

<pre><code class="cpp">    setClientIdentifier("..."); // DROPBOX_APP_KEY
    setClientIdentifierSharedKey("..."); // DROPBOX_APP_SECRET
</code></pre>

<h3 id="%E8%A6%81%E6%B1%82%E5%89%8D%E3%81%AE%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E5%A4%89%E6%9B%B4">要求前のパラメータ変更</h3>

<p>認証処理中に受け渡されるデータを編集するための関数を登録します。</p>

<pre><code class="cpp">    setModifyParametersFunction([&amp;](Stage stage, QVariantMap* data) {
        if (Stage::RequestingAuthorization == stage ||
            Stage::RequestingAccessToken   == stage)
        {
            data-&gt;remove(Key::redirectUri);
        }
    });
</code></pre>

<p>DropBox では リダイレクト先のURLが存在していると意図しない動きをするため削除しています。</p>

<h3 id="authorizewithbrowser-%E3%82%B7%E3%82%B0%E3%83%8A%E3%83%AB">authorizeWithBrowser シグナル</h3>

<pre><code class="cpp"> connect(this, &amp;QAbstractOAuth::authorizeWithBrowser, [=](QUrl url) {
        QUrlQuery query(url);
        customReplyHandler-&gt;setState(query.queryItemValue(Key::state));
        QDesktopServices::openUrl(url);
    });
</code></pre>

<p><code>QAbstractOAuth::authorizeWithBrowser</code> のシグナルを処理します。</p>

<p>これは、ブラウザで認証を行う前に引数を加えたりするためのシグナルです。</p>

<p>ここは別にラムダ式じゃなくても問題ないです。</p>

<p><code>QDesktopServices::openUrl(url);</code></p>

<p>この静的関数を呼び出すとブラウザが開き、各サービスの認証ページにアクセスが可能です。</p>

<h3 id="statuschanged-%E3%82%B7%E3%82%B0%E3%83%8A%E3%83%AB">statusChanged シグナル</h3>

<p>認証ステータスが変化した時に呼ばれます。</p>

<pre><code class="cpp">    connect(this, &amp;QOAuth2AuthorizationCodeFlow::statusChanged, [=](QAbstractOAuth::Status status) {
        if (QAbstractOAuth::Status::Granted == status) {
            Q_EMIT authenticated();
        }
    });
</code></pre>

<p>ちょっとここは覚えてないですが、少なくとも当時は <code>QOAuth2AuthorizationCodeFlow::granted</code> シグナルではうまく処理できなかったみたいなので、認証ステータスの変化時にこのクラスを利用する側に対してシグナルを発報しています。</p>

<h3 id="api-%E3%81%AE%E5%88%A9%E7%94%A8">API の利用</h3>

<p>API の利用 は OAuth 1 の場合と同じなので割愛します。</p>

<h3 id="%E8%A3%9C%E8%B6%B3">補足</h3>

<p>例として出した DropBox は、出た当時の実装だと色々と不具合がでてこ汚い手を使って回避しないと実装できなかったため、ソース自体が参考にするにはふさわしくないかもしれません。</p>

<p>また、そのあたりソースは今回割愛しています。
興味がある方は <a href="https://github.com/sharkpp/NetworkStorageAccessSample">sharkpp/NetworkStorageAccessSample: Qt Network Authorization "Network storage access" sample</a> を参照しいてください。</p>

<h2 id="%E5%8F%82%E8%80%83">参考</h2>

<ul>
<li><a href="https://github.com/sharkpp/NetworkStorageAccessSample">sharkpp/NetworkStorageAccessSample: Qt Network Authorization "Network storage access" sample</a></li>
<li><a href="https://github.com/sharkpp/Jugemutter">sharkpp/Jugemutter: 長文投稿専用ツイッタークライアント「じゅげむったー」</a></li>
<li><a href="https://doc.qt.io/qt-5.10/qtnetworkauth-module.html">Qt Network Authorization C++ Classes | Qt Network Authorization 5.10</a></li>
</ul>

<h2 id="%E6%9C%80%E5%BE%8C%E3%81%AB">最後に</h2>

<p>今回は、新たに標準として加わった <a href="https://doc.qt.io/qt-5.10/qtnetworkauth-index.html">Qt Network Authorization</a> モジュール を駆け足で紹介しました。</p>

<p>お仕事でも趣味でも <code>Qt Network Authorization</code> モジュールを使ってみようかと思う方の参考になれば幸いです。</p>

<p>それでは、また。</p>

<p>明日は <a href="https://qiita.com/ynuma">ynuma</a> さんによる「<a href="https://qiita.com/ynuma/items/21e49d084f1f5c8d3e4d">QtRuby を使ってみました</a>」です。
お楽しみに。</p>

<hr />

<p>この投稿は <strong><a href="http://qiita.com/advent-calendar/2017/qt">Qt Advent Calendar 2017</a></strong> の <strong>21日目</strong>の記事です。</p>

<ul>
<li>20日目の記事: <a href="https://qiita.com/Donokono/items/cb9167ee78eb758f8806">Qtでグラフを書いてみよう！</a></li>
<li>22日目の記事: <a href="https://qiita.com/ynuma/items/21e49d084f1f5c8d3e4d">QtRuby を使ってみました</a></li>
</ul>

<hr />
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[Google Poly で公開されている素材を HSP 3 で利用してみよう]]></title>
            <link href="http://www.sharkpp.net/blog/2017/12/01/hsp-advent-calendar-2017-1st-day.html"/>
            <updated>2017-12-01T23:25:00+00:00</updated>
            <id>http://www.sharkpp.net/blog/2017/12/01/hsp-advent-calendar-2017-1st-day.html</id>
            <content type="html"><![CDATA[<p>こんにちは、こんばんは。</p>

<p><a href="http://qiita.com/advent-calendar/2017/hsp">Hot Soup Processor Advent Calendar 2017</a> の 初日を担当する <a href="https://twitter.com/sharkpp">@sharkpp</a> です。</p>

<p>この記事では、Google Poly で公開されている <a href="https://ja.wikipedia.org/wiki/Wavefront_.obj%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB">Wavefront .OBJ ファイル</a> を HSP の hgimg4 で利用してみる方法について書いてみました。</p>

<h2 id="%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB">はじめに</h2>

<p><img src="/images/2017_1201_poly_ss.png" alt="Google Poly" /></p>

<p>皆さんは、ちょうどひと月前に公開された Google の <a href="https://poly.google.com/">Poly</a> というサイトをご存知でしょうか？</p>

<p>似てますが Google Play じゃないですよ？</p>

<p>このサイトは、Google が公開した VR/AR向け素材のライブラリサイトで、クレジット（著作権表示）を行えば改変なども可能な CC BY ライセンスで数多くの素材が公開されています。</p>

<p>今回はこのサイトに登録されている Tilt Brush 以外で作られた OBJ をダウンロードして hgimg4 で表示してみることにします。</p>

<p>あ、 HSP は 3.5 を利用しています。</p>

<h2 id="%E7%B4%A0%E6%9D%90%E3%81%AE%E7%94%A8%E6%84%8F">素材の用意</h2>

<p>とりあえず、適当に素材を選びます。</p>

<p>この時、Google の VR お絵かきソフトである <a href="https://www.tiltbrush.com/">Tilt Brush</a> で作られた素材は、形式が OBJ ではないことが理由なのか何なのかは分からないですがダウンロードができません。
なので <a href="https://vr.google.com/blocks/">Blocks</a> や、それ以外で作られた素材を探します。</p>

<p>ダウンロードを押下すると</p>

<blockquote>
  <p>このコンテンツは CC-BY ライセンスで公開されています。著作権に関する情報を表示する必要があります。</p>
</blockquote>

<p>などと、利用する場合の注意点が表示されるのでよく確認しておきましょう。</p>

<p>フィルタを利用すると探すのが容易になります。</p>

<p><img src="/images/2017_1201_poly_obj_download.png" alt="" /></p>

<p>素材によっては OBJ 形式以外にも</p>

<ul>
<li>三角 OBJ ファイル</li>
<li>FBX ファイル</li>
</ul>

<p>など、別の形式が選べる場合もあります。</p>

<p>FBX ファイルをダウンロードして利用する場合は、次の OBJ から FBX への変換処理は必要ないので読み飛ばしてください。</p>

<h2 id="%E9%81%B8%E3%82%93%E3%81%A0%E7%B4%A0%E6%9D%90">選んだ素材</h2>

<p><a href="https://poly.google.com/view/frPqTFGeRNM">東京タワー</a></p>

<p><img src="/images/2017_1201_model_frPqTFGeRNM.png" alt="東京タワー" /></p>

<blockquote>
  <p>&copy; <a href="https://poly.google.com/user/99VuVXH6oer">Kenta Imai (henteko)</a></p>
</blockquote>

<p><a href="https://poly.google.com/view/3gEvVZoTN7e">Lighthouse</a></p>

<p><img src="/images/2017_1201_model_3gEvVZoTN7e.png" alt="Lighthouse" /></p>

<blockquote>
  <p>&copy; <a href="https://poly.google.com/user/fa4m5c69h51">Robert Mirabelle</a></p>
</blockquote>

<p><a href="https://poly.google.com/view/2binsxeOBve">Rio de Janeiroy</a></p>

<p><img src="/images/2017_1201_model_2binsxeOBve.png" alt="Rio de Janeiroy" /></p>

<blockquote>
  <p>&copy; <a href="https://poly.google.com/user/13QtrlRKjO-">Alan Zimmermany</a></p>
</blockquote>

<p><a href="https://poly.google.com/view/cINomH54DAx">McGraw Athletic Centery</a></p>

<p><img src="/images/2017_1201_model_cINomH54DAx.png" alt="McGraw Athletic Centery" /></p>

<blockquote>
  <p>&copy; <a href="https://poly.google.com/user/eH7rRxk0HuE">Jordan Van Wyky</a></p>
</blockquote>

<p><a href="https://poly.google.com/view/3vKuzmkSpdr">new growthy</a></p>

<p><img src="/images/2017_1201_model_3vKuzmkSpdr.png" alt="new growthy" /></p>

<blockquote>
  <p>&copy; <a href="https://poly.google.com/user/eXRnbKFZIta">Tanner Whytey</a></p>
</blockquote>

<p><a href="https://poly.google.com/view/8Jp1S6F0uzi">Bonsaiy</a></p>

<p><img src="/images/2017_1201_model_8Jp1S6F0uzi.png" alt="Bonsaiy" /></p>

<p>&copy; <a href="https://poly.google.com/user/cMk8S7aDHny">brett hursty</a></p>

<h2 id="hgimg4-%E5%B0%82%E7%94%A8%E5%BD%A2%E5%BC%8F%E3%81%B8%E5%A4%89%E6%8F%9B">hgimg4 専用形式へ変換</h2>

<p>HSP付属の GPB Converter というツールは FBX からの変換のみに対応しているようなので OBJ から FBX 形式への変換処理をする必要があります。</p>

<p>昔は Autodesk FBX Converter がダウンロード出たようですが、今見に行くと Autodesk FBX Preview のダウンロードページへと飛ばされてしまいます。</p>

<p>なので、探し回ったところ、幸運なことに <a href="https://archive.org/">Internet Archive</a> で保存されていた昔のページ <a href="http://web.archive.org/web/20170926144107/http://usa.autodesk.com/adsk/servlet/pc/item?siteID=123112&amp;id=22694909">FBX® 2013.3 Converter</a> からダウンロードすることができました。</p>

<table>
<thead>
<tr>
  <th>ファイル名</th>
  <th>MD5</th>
</tr>
</thead>
<tbody>
<tr>
  <td><code>fbx20133_converter_win_x64.exe</code></td>
  <td><code>5435cf1371502e66b9048834b897011e</code></td>
</tr>
</tbody>
</table>

<p>FBX Converter を起動すると、左側に元ファイル(<code>Source files</code>)、右側に変換後のファイル(<code>Destination files</code>) の欄が表示されます。</p>

<p><img src="/images/2017_1201_FBX_Converter_2013.png" alt="FBX Converter 2013" /></p>

<p><code>Add...</code> ボタンか <code>.obj</code> ファイルをドロップすることでリストに登録できます。</p>

<p>右下の <code>Convert</code> で変換が出来ます。</p>

<p><code>.FBX</code> 形式に変換したら hgimg4 で利用するために <code>.gpb</code> 形式に変換します。</p>

<p>GPB Converter というのが標準ツールとしてありますのでそれを使いますが、HSPのインストールフォルダパスにスペースが含まれているとうまく動かないようです。</p>

<p>もし、うまくファイルが変換できない場合は、コマンロプロンプトで <code>gameplay-encoder</code> で呼び出してみましょう。</p>

<pre><code>&gt; gameplay-encoder "model.fbx" "model.gpb"
Encoding file: model.fbx
Loading FBX file.
Loading Scene.
Triangulate.
Load nodes.
Load materials
Loading animations.
Optimizing GamePlay Binary.
Saving binary file: model.gpb

&gt; gameplay-encoder -m "model.fbx" "model.material"
Encoding file: model.fbx
Loading FBX file.
Loading Scene.
Triangulate.
Load nodes.
Load materials
Loading animations.
Optimizing GamePlay Binary.
Saving binary file: model.gpb
</code></pre>

<h2 id="hgimg4-%E3%81%A7%E8%AA%AD%E3%81%BF%E8%BE%BC%E3%81%BF">hgimg4 で読み込み</h2>

<p>後は簡単です。</p>

<p>※ <code>sample/hgimg4/test8.hsp</code></p>

<pre><code>#include "hgimg4.as"

title "HGIMG4 Test"

    gpreset
    setcls CLSMODE_SOLID, $404040
    gpload id_model,"data/frPqTFGeRNM_9L5eUA1sj4m_obj/model"
    setpos GPOBJ_CAMERA, 0,0,5
    x=0.0:y=0.0:z=0.0

repeat
    stick key,15
    if key&amp;128 : end

    redraw 0
    addang id_model,0,0.02
    gpdraw
    color 255,255,255
    pos 8,8:mes "HGIMG4 sample"
    redraw 1
    await 1000/60
loop
</code></pre>

<p>と、このようにモデルデータを指定し読み込むことができます。</p>

<p><img src="/images/2017_1201_hgimg4_frPqTFGeRNM.png" alt="東京タワー" /></p>

<p><img src="/images/2017_1201_hgimg4_cINomH54DAx.png" alt="McGraw Athletic Centery" /></p>

<p><img src="/images/2017_1201_hgimg4_3gEvVZoTN7e.png" alt="Lighthouse" /></p>

<p>何点か読み込ませてみた感じ、</p>

<ul>
<li>巨大で読み込みに時間かかるモデルがある
<a href="https://poly.google.com/view/3vKuzmkSpdr">new growthy</a> とか <a href="https://poly.google.com/view/8Jp1S6F0uzi">Bonsaiy</a> これ</li>
<li>スケールに規格があるわけではないのでマチマチ</li>
<li>テクスチャが読み込めない</li>
<li>材質？が反映できていない？</li>
</ul>

<p>テクスチャは、パスとかファイル形式などが理由かもしれませんが未解決です。</p>

<h2 id="%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB">おわりに</h2>

<p>パッとさわってみた限り、テクスチャの問題を除いても、そのままで HSP で利用できそうなのが少ない印象でした。
ここは、HSP専用のassetストアの解説が待たれるところです！</p>

<p>明日は <a href="https://twitter.com/y_tack">@y_tack</a> さんの「<a href="https://qiita.com/y_tack/items/7eda1f2502de4611b4f7">（エターナル化してきた）OpenHSPの書写他</a>」です。</p>

<p>楽しみですね。</p>

<h2 id="%E5%8F%82%E8%80%83">参考</h2>

<ul>
<li><a href="https://poly.google.com/">Poly</a></li>
<li><p><a href="https://poly.google.com/view/4NYtgQKdVMy">Parking Lot - Poly</a></p></li>
<li><p><a href="http://www.greentoken.de/onlineconv/">Online 3D Converter</a></p></li>
<li><a href="https://knowledge.autodesk.com/ja/search-result/caas/sfdcarticles/sfdcarticles/kA230000000u0m3.html">Autodesk FBX Converter について | 検索 | Autodesk Knowledge Network</a></li>
<li><a href="http://web.archive.org/web/20170926144107/http://usa.autodesk.com/adsk/servlet/pc/item?siteID=123112&amp;id=22694909">Autodesk - Autodesk FBX - FBX® 2013.3 Converter</a></li>
<li><a href="https://mathtrain.jp/rthetaphi">三次元極座標についての基本的な知識 | 高校数学の美しい物語</a></li>
<li><a href="http://lhsp.s206.xrea.com/command/mousew.html">mousew変数 （マウスホイールの回転量取得） - Let's HSP!</a></li>
<li><a href="https://www.peko-step.com/tool/tfrad.html">ラジアン(弧度法)と度(度数法)の相互変換ツールと変換計算式 - PEKO STEP</a></li>
</ul>

<hr />

<p>この投稿は <strong><a href="http://qiita.com/advent-calendar/2017/hsp">Hot Soup Processor Advent Calendar 2017</a></strong> の <strong>1日目</strong>の記事です。</p>

<ul>
<li>2日目の記事: <a href="https://qiita.com/y_tack/items/7eda1f2502de4611b4f7">（エターナル化してきた）OpenHSPの書写他</a></li>
</ul>

<hr />
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[FREETEL RAIJIN 開封の儀と一月ほど使ってみた感じ]]></title>
            <link href="http://www.sharkpp.net/blog/2017/11/17/unboxing-and-used-one-month-of-freetel-raijin.html"/>
            <updated>2017-11-17T02:31:00+00:00</updated>
            <id>http://www.sharkpp.net/blog/2017/11/17/unboxing-and-used-one-month-of-freetel-raijin.html</id>
            <content type="html"><![CDATA[<p>前に使っていた <a href="/blog/2015/12/07/unboxing-and-used-one-month-of-nexus-5x.html">Google Nexus 5X</a> が、巷で話題の再起動ループに陥ったので、新しいスマホを購入しました。</p>

<p>今回は、長々と代替機で過ごしていると<a href="https://play.google.com/store/apps/details?id=com.nianticlabs.pokemongo&amp;hl=ja">某ボールを投げて何某をゲットするゲーム</a>が遊べないのでサクッと選びました。
まあ、前のスマホが二年も前のなので、そこそこのスペックでほぼ同等ぐらいだからいいやと思って、<a href="https://www.freetel.jp/product/smartphone/raijin/">FREETEL RAIJIN</a>を選びました。
本当は Google PIXEL 2 がよかったんですが、あれ絶対日本では発売しないよなーと。</p>

<p><a href="/images/2017_1117_raijin_outerbox.jpg"><img src="/thumbs/0e99fd9e7890ad2bd78ab2a7c6cc9f67-256x256.jpg" alt="雷神 -RAIJIN-"></a></p>

<h2 id="%E3%81%95%E3%82%88%E3%81%AA%E3%82%89-nexus-5x">さよなら Nexus 5X</h2>

<p>とうとうお家の Nexus 5X にも再起動ループがやってきました。</p>

<p><code>fastboot</code> コマンドで、OSを更新しようとしたら、「ロックが掛かっているのでできない」と言われ、ロックを解除しようにも、OSが正常起動していないと、だめと言う、ああ、これは詰んだ状態でした。
そのままの状態で一晩放っておいたら、いつのまにか復帰していました（少ししたら再起動しましたけど）
ただまあ、後から考えると、OS書き込んでも治らなかった可能性が高いなぁと。</p>

<p>ともあれ、これで保有している LG のスマホは、２台ともが故障したことになります（１台は修理交換済み）。
もう二度と LG のスマホは買わないことを誓った 2017年の秋でした。</p>

<p>まあ、ともかく、さよならです、Nexus 5X 、２年間ありがとう。</p>

<h2 id="%E9%96%8B%E5%B0%81%E3%81%AE%E5%84%80">開封の儀</h2>

<p>10月某日、FREETEL RAIJIN がお家にやってきた。</p>

<p><a href="/images/2017_1117_raijin_outerbox.jpg"><img src="/thumbs/0e99fd9e7890ad2bd78ab2a7c6cc9f67-256x256.jpg" alt="雷神 -RAIJIN- 外箱"></a></p>

<p>ともかく、ご開帳です！</p>

<p><a href="/images/2017_1117_raijin_logo_zoom.jpg"><img src="/thumbs/de750b41f64c932fd740b24c098ba1f4-256x256.jpg" alt="雷神 -RAIJIN- ロゴ拡大"></a></p>

<p><a href="/images/2017_1117_raijin_bundles.jpg"><img src="/thumbs/9f24a1075eb00d927dfcd485ccdecbd1-256x256.jpg" alt="同梱品一覧"></a></p>

<p><a href="/images/2017_1117_raijin_charge_cable.jpg"><img src="/thumbs/370465992277354ba46ac2f7fdb12d35-256x256.jpg" alt="本体＆充電ケーブル"></a></p>

<p><a href="/images/2017_1117_raijin_backside.jpg"><img src="/thumbs/ef3d4cb58579c2736d0ab11b31052d80-256x256.jpg" alt="裏面"></a></p>

<p>SIMスロットは、microSDカードリーダと兼用も含めて二つ付いているようです。</p>

<p><a href="/images/2017_1117_raijin_sim_slot.jpg"><img src="/thumbs/535717116b1c0b95c023ae7965e2187e-256x256.jpg" alt="nanoSIM収納"></a></p>

<p>前のスマホ <a href="https://www.google.co.jp/intl/ja_jp/nexus/5x/">Google Nexus 5X</a>との比較</p>

<p><a href="/images/2017_1117_raijin_vs_nexus5x_size.jpg"><img src="/thumbs/ceb439f8179534ccd5865514844dcd94-256x256.jpg" alt="大きさ FREETEL RAIJIN vs Google Nexus 5X"></a></p>

<p><a href="/images/2017_1117_raijin_vs_nexus5x_size2.jpg"><img src="/thumbs/a43a83d6d8a8f97d0618ee6b4125e56f-256x256.jpg" alt="大きさ FREETEL RAIJIN vs Google Nexus 5X その２"></a></p>

<p>少し大きいですね。</p>

<p>保護シートを慌てて購入したので、欲しかったのぞき見防止じゃなくて普通を選んでしまっていた、不覚！</p>

<h2 id="%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97%E4%B8%AD">セットアップ中</h2>

<p><a href="/images/2017_1117_raijin_setup01.png"><img src="/thumbs/2da765528e9949e154cb0422db13a813-256x256.png" alt="セットアップ：ようこそ"></a>
<a href="/images/2017_1117_raijin_setup02.png"><img src="/thumbs/eaa3c212f3575eef8c9eb5cb4d335967-256x256.png" alt="セットアップ：SIM挿入"></a>
<a href="/images/2017_1117_raijin_setup03.png"><img src="/thumbs/083c6702a923b670bff64237ce1e2315-256x256.png" alt="セットアップ：挿入したらSMSが届いた"></a>
<a href="/images/2017_1117_raijin_setup04.png"><img src="/thumbs/ab1340eb57047b9782e93bb50dbffa43-256x256.png" alt="セットアップ：セットアップ"></a>
<a href="/images/2017_1117_raijin_setup05.png"><img src="/thumbs/377717b7868c55e91dfb475bf31ec4b5-256x256.png" alt="セットアップ：データの引き継ぎ"></a>
<a href="/images/2017_1117_raijin_setup06.png"><img src="/thumbs/eb410e034c92cd435bd9e45c048206b1-256x256.png" alt="セットアップ：ソフトウエアアップデート"></a>
<a href="/images/2017_1117_raijin_setup07.png"><img src="/thumbs/c05041aba6aaffa1f0b308a3dceb76e3-256x256.png" alt="セットアップ：別端末からコピー"></a>
<a href="/images/2017_1117_raijin_setup08.png"><img src="/thumbs/b8b468b8c152063a4314e3a03ff58a9d-256x256.png" alt="セットアップ：あと少しで完了です(Nexus 5X側)"></a>
<a href="/images/2017_1117_raijin_setup09.png"><img src="/thumbs/6b13b367004fb7041244adcc7480a356-256x256.png" alt="セットアップ：指紋ロック設定"></a>
<a href="/images/2017_1117_raijin_setup10.png"><img src="/thumbs/3a5407eea1a11b64d9e08c6f03bdac56-256x256.png" alt="セットアップ：指紋センサー位置の確認"></a>
<a href="/images/2017_1117_raijin_setup11.png"><img src="/thumbs/66826955db53897dec77d535b4dc4fce-256x256.png" alt="セットアップ：指紋登録完了"></a>
<a href="/images/2017_1117_raijin_setup12.png"><img src="/thumbs/38b5445f0b289494c9bc08f222d02080-256x256.png" alt="セットアップ：設定完了"></a></p>

<h2 id="%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97%E5%AE%8C%E4%BA%86">セットアップ完了</h2>

<p><a href="/images/2017_1117_raijin_welcome.png"><img src="/thumbs/20b3c103b01637a7fdd21111ad9235cb-256x256.png" alt="ようこそ"></a>
<a href="/images/2017_1117_raijin_info.png"><img src="/thumbs/a2f373bb39ae57c397255385205f5439-256x256.png" alt="端末の情報"></a></p>

<h2 id="%E3%82%A4%E3%83%BC%E3%82%B9%E3%82%BF%E3%83%BC%E3%82%A8%E3%83%83%E3%82%B0">イースターエッグ</h2>

<p>Android 7 のイースターエッグはネコ集めらしい。</p>

<p><a href="/images/2017_1117_raijin_android7_logo.png"><img src="/thumbs/524b7814dc466b0ac5e24a78db7733f1-256x256.png" alt="ロゴ"></a></p>

<p><a href="/images/2017_1117_raijin_first_cat.png"><img src="/thumbs/7174af1ada79ded9376eccd9e1927cec-256x256.png" alt="最初の猫"></a></p>

<h2 id="%E4%B8%80%E6%9C%88%E3%81%BB%E3%81%A9%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%BF%E3%81%9F%E6%84%9F%E3%81%98">一月ほど使ってみた感じ</h2>

<h3 id="%E3%82%AB%E3%83%A1%E3%83%A9">カメラ</h3>

<p>カメラアプリは独自性を出しやすい部分。</p>

<p>まあ、カメラの性能としてはトントンかなぁと。</p>

<h4 id="%E6%A8%99%E6%BA%96%E3%81%AE%E3%82%AB%E3%83%A1%E3%83%A9%E3%82%A2%E3%83%97%E3%83%AA%E3%81%A7%E6%92%AE%E3%81%A3%E3%81%9F%E5%86%99%E7%9C%9F">標準のカメラアプリで撮った写真</h4>

<h4 id="%E7%89%B9%E6%AE%8A%E3%81%AA%E6%92%AE%E5%BD%B1%E3%83%A2%E3%83%BC%E3%83%89">特殊な撮影モード</h4>

<p>こんな感じで</p>

<p><a href="/images/2017_1117_raijin_camera_mode.png"><img src="/thumbs/dda70048243c3680e4e84d519539bb35-256x256.png" alt="カメラ：カメラモード"></a></p>

<ul>
<li>オート</li>
<li>マニュアル</li>
<li>ビューティー</li>
<li>パノラマ</li>
<li>暗がり撮影</li>
<li>色鮮やかHDR</li>
<li>一眼レフ</li>
<li>残像</li>
<li>ハイスピード</li>
</ul>

<p>と、いろんな撮影方法ができるみたいです。</p>

<p>カメラの設定はこんな感じ。</p>

<h5 id="%E3%80%8C%E4%B8%80%E7%9C%BC%E3%83%AC%E3%83%95%E3%80%8D%E3%83%A2%E3%83%BC%E3%83%89">「一眼レフ」モード</h5>

<p><a href="/images/2017_1117_raijin_camera_mode01.png"><img src="/thumbs/925a53b71a293e2b5ea781d2f415070e-256x256.png" alt="「一眼レフ」モード"></a></p>

<p>２枚？を焦点をずらして撮影して、自動でぼかしを入れるようです。</p>

<p>こんな感じ。</p>

<p><a href="/images/2017_1117_raijin_camera01.jpg"><img src="/thumbs/31923ce3dbbc64bc8353e7bdfd0b58f8-256x256.jpg" alt="お寿司その１：「一眼レフ」モード"></a></p>

<h5 id="%E3%80%8C%E6%AE%8B%E5%83%8F%E3%80%8D%E3%83%A2%E3%83%BC%E3%83%89">「残像」モード</h5>

<p><a href="/images/2017_1117_raijin_camera_mode02.png"><img src="/thumbs/9d64a195c3312d177c37a1c12cb1ab54-256x256.png" alt="「残像」モード"></a></p>

<p>何枚か撮影して、複数枚選んだ画像に移る目標物を抜き出し、合成するようです。</p>

<h5 id="%E3%80%8C%E3%83%8F%E3%82%A4%E3%82%B9%E3%83%94%E3%83%BC%E3%83%89%E3%80%8D%E3%83%A2%E3%83%BC%E3%83%89">「ハイスピード」モード</h5>

<p><a href="/images/2017_1117_raijin_camera_mode03.png"><img src="/thumbs/a0a0ad379e69beb3731c5ccc1dda6d53-256x256.png" alt="「ハイスピード」モード"></a></p>

<p>何枚か撮影して、選んだ画像に写る目標物以外にモーションブラーを掛けるようです。</p>

<h4 id="%E3%82%AB%E3%83%A1%E3%83%A9%E3%81%AE%E3%82%B7%E3%83%A3%E3%83%83%E3%82%BF%E3%83%BC%E9%9F%B3">カメラのシャッター音</h4>

<p>このカメラアプリ、なんとシャッター音が消せるんです。
公式アプリで、良いのこれ？</p>

<p>まあ、ともかく消してみると、困ったことに写真を撮ったかどうかがわかりにくいので微妙かも。</p>

<h4 id="%E6%A8%99%E6%BA%96%E3%81%AE%E3%82%AB%E3%83%A1%E3%83%A9%E3%81%A7%E6%92%AE%E3%81%A3%E3%81%9F%E3%81%82%E3%82%8C%E3%81%93%E3%82%8C">標準のカメラで撮ったあれこれ</h4>

<p><a href="/images/2017_1117_raijin_camera02.jpg"><img src="/thumbs/3ff4905e54ebc1550ab8faf846f36c42-256x256.jpg" alt="お寿司その２：「一眼レフ」モード"></a>
<a href="/images/2017_1117_raijin_camera03.jpg"><img src="/thumbs/d1f47c8c67ea68e7bac9fb4b534e6fb1-256x256.jpg" alt="お寿司その３：「一眼レフ」モード失敗"></a>
<a href="/images/2017_1117_raijin_camera04.jpg"><img src="/thumbs/1739d902ac3cc30a9ae2e3d0d84bae17-256x256.jpg" alt="お寿司その４：「一眼レフ」モード"></a>
<a href="/images/2017_1117_raijin_camera05.jpg"><img src="/thumbs/6f018ad225f9140fa26679cfdec47168-256x256.jpg" alt="お寿司その５：「一眼レフ」モード"></a>
<a href="/images/2017_1117_raijin_camera06.jpg"><img src="/thumbs/345d232b76916c3c8f700d76c0afc51d-256x256.jpg" alt="さんまの蒲焼：「一眼レフ」モード"></a>
<a href="/images/2017_1117_raijin_camera07.jpg"><img src="/thumbs/dcd849faa87043064ce5e4601fcdfa85-256x256.jpg" alt="お空"></a>
<a href="/images/2017_1117_raijin_camera08.jpg"><img src="/thumbs/fbb4deaa273ebc9dcd3fba6f8ab80e03-256x256.jpg" alt="道端の植物"></a>
<a href="/images/2017_1117_raijin_camera09.jpg"><img src="/thumbs/40e74677f92faddf1e8aad3b18ab5a1d-256x256.jpg" alt="夜の鳥居：夜間・最大ズーム"></a></p>

<h3 id="%E3%81%93%E3%81%93%E3%81%8C-good%21">ここが GOOD!</h3>

<h4 id="%E3%83%90%E3%83%83%E3%83%86%E3%83%AA%E3%83%BC%E5%AE%B9%E9%87%8F">バッテリー容量</h4>

<p>バッテリー容量が、<code>2,700 mAh</code> から <code>5,000mAh</code> になったので、ゲームを長時間やっていてもまだ余裕がある。</p>

<p>減り具合も、巷で言われるほどひどくはない気がする。</p>

<p>まあ、まだバッテリーが新品だからなのかもしれないけど。</p>

<h4 id="%E3%82%B2%E3%83%BC%E3%83%A0%E4%B8%AD%E3%81%AE%E7%99%BA%E7%86%B1">ゲーム中の発熱</h4>

<p>ゲーム中も <code>Nexus 5X</code> よりも発熱はなさそうな感じ。
もう、<code>Nexus 5X</code> でゲームをやったら、画面上部が手で触ると辛いぐらいの温度になってたので、これはうれしい。</p>

<p>まあ、２年もたてばCPUなどの性能も上がってるし、こんな感じだよね、と。</p>

<h4 id="%E9%8C%B2%E9%9F%B3">録音</h4>

<p>通話中の会話の録音が標準機能？でできるようになった。
自動録音ではないのがちょっと残念。</p>

<h3 id="%E3%81%93%E3%81%93%E3%81%8C-bad%21">ここが BAD!</h3>

<h4 id="gps%E3%81%AE%E7%B2%BE%E5%BA%A6%E3%81%8C%E6%82%AA%E3%81%84">GPSの精度が悪い</h4>

<p>どうも、GPSの精度、というか掴む数が少ない気がする。</p>

<p>Nexus 5X に比べて、室内だと特に乱れやすい。</p>

<p>位置ゲームをやっている身としては困る...</p>

<h4 id="%E6%99%82%E8%A8%88%E3%81%8C%E7%9C%81%E7%95%A5%E3%81%95%E3%82%8C%E3%82%8B%EF%BC%81">時計が省略される！</h4>

<p>何故か時計が <code>...</code> で省略されて、今何時か、しかわからない。
<del>とりあえず、バッテリーの残り容量が数字で表示されている部分を表示しないようにするだけで直った様子。</del>
直りませんでした。</p>

<p>※ 縦横を切り替えると直る様子。</p>

<h4 id="%E3%82%B9%E3%83%86%E3%83%BC%E3%82%BF%E3%82%B9%E3%83%90%E3%83%BC%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B8%E3%82%B1%E3%83%BC%E3%82%BF%E3%81%8C%E9%87%8D%E3%81%AA%E3%82%8B">ステータスバーのインジケータが重なる</h4>

<p>Bluetooth の状態インジケータが隣のアイコンと重なる。</p>

<h4 id="%E6%99%82%E8%A8%88%E3%81%8C%E9%80%B2%E3%81%BE%E3%81%AA%E3%81%84">時計が進まない</h4>

<p>ゲームをしている最中などに、ステータスバーの時計が進まなくなることがある様子。</p>

<p>ウィジェットや通知領域の時刻は進んでいるのでなんだかなーと。</p>

<p><a href="/images/2017_1117_raijin_clock_not_working.png"><img src="/thumbs/af861fc8f79d9f0f208215abb11e64b6-256x256.png" alt="時刻が進まない"></a></p>

<p>※ 縦横を切り替えると直る様子。</p>

<h4 id="%E6%A8%99%E6%BA%96%E3%83%A9%E3%83%B3%E3%83%81%E3%83%A3%E3%83%BC%E3%81%AE%E8%A1%8C%E6%95%B0%E3%81%8C%E5%B0%91%E3%81%AA%E3%81%84">標準ランチャーの行数が少ない</h4>

<p>解像度は Nexus 5X と同じはずだけど、なぜだかランチャーで並べられる数が少ない。</p>

<p>比較画像</p>

<p><a href="/images/2017_1117_raijin_welcome.png"><img src="/thumbs/20b3c103b01637a7fdd21111ad9235cb-256x256.png" alt="FREETEL RAIJIN ランチャースクショ"></a></p>

<p><a href="/images/2015_1207_nexus5x_17_setup.png"><img src="/thumbs/44a9a648a8ff0199dd758ee702235cb2-256x256.png" alt="Google Nexus 5X ランチャースクショ"></a></p>

<p>を見てみるとよくわかるけど、RAIJIN の方は置けるアプリの数が Nexus 5X よりも少ない模様。</p>

<p>間抜けなことに、最初なんだか画面が狭いなーと思ってたけど、何のことはない、5 x 5 から 4 x 4 に減っただけだった。</p>

<h4 id="%E6%80%A5%E9%80%9F%E5%85%85%E9%9B%BB%E3%81%AB%E3%81%AA%E3%82%89%E3%81%AA%E3%81%84">急速充電にならない</h4>

<p>急速充電に対応していないらしく... あれ？対応しているって「<a href="https://blg.freetel.jp/faq/17254.html">急速充電に対応していますか？ </a>」に書かれてるな。</p>

<p>充電中のステータスが「充電中」のままのようだ。</p>

<p>充電器によってはそもそも給電がされないか、消費が多くて充電が進まなことがある模様。</p>

<h3 id="%E7%AD%90%E4%BD%93%E8%87%AA%E4%BD%93%E3%81%AB%E6%AC%B2%E3%81%97%E3%81%8B%E3%81%A3%E3%81%9F%E3%82%82%E3%81%AE">筐体自体に欲しかったもの</h3>

<ul>
<li>防水機能
まあ、そこまで神経質にならなくてもいいけど、水没にだけは気をつけよう。</li>
</ul>

<h2 id="%E5%8F%82%E8%80%83">参考</h2>

<ul>
<li><a href="https://mobareco.jp/a77458/">FREETEL SAMURAI REIを買ったら設定しておきたい10のこと - モバレコ</a></li>
<li><a href="https://mobareco.jp/a95780/">最新モデル「FREETEL RAIJIN」レビュー！フリーテルならではのこだわりを感じる1台 - モバレコ</a></li>
<li><a href="https://www.dream-seed.com/weblog/note/android-7-nougat-easteregg">Android 7.0 Nougatのイースターエッグの遊び方 – Dream Seed</a></li>
<li><a href="http://wnkhs.net/2017/02/android-7-easter-egg-watch/">Android 7 Nougatのイースターエッグは時計でも確認できる – wnkhs.net</a></li>
<li><a href="https://www.freetel.jp/product/smartphone/raijin/faq.html">RAIJINのFAQ｜FTJ162E-RAIJIN｜FREETEL(フリーテル) のSIMフリースマホ</a></li>
<li><a href="https://www.freetel.jp/product/smartphone/raijin/spec.html">RAIJINのスペック｜FTJ162E-RAIJIN｜FREETEL(フリーテル) のSIMフリースマホ</a></li>
<li><a href="http://monomoney.hatenablog.com/entry/2017/02/09/165434">FREETELのRAIJIN 雷神のカメラの設定項目 - M,LIFE</a></li>
<li><a href="https://zenfone3-asus-wiki.fxtec.info/wiki.cgi?page=FREETEL%20%CD%EB%BF%C0%20RAIJIN%20vs%20ZenFone%203%20%A5%B9%A5%DA%A5%C3%A5%AF%A4%CE%B0%E3%A4%A4%A1%A2%A5%AC%A5%C1%C8%E6%B3%D3%A1%AA">FREETEL 雷神 RAIJIN vs ZenFone 3 スペックの違い、ガチ比較！ - ZenFone 3（ASUS）まとめWiki</a></li>
</ul>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[技術書典３にサークル手伝いとして参加してきた]]></title>
            <link href="http://www.sharkpp.net/blog/2017/10/23/techbookfest3.html"/>
            <updated>2017-10-23T02:30:00+00:00</updated>
            <id>http://www.sharkpp.net/blog/2017/10/23/techbookfest3.html</id>
            <content type="html"><![CDATA[<p>去年から始まった技術書オンリーな同人イベント、「技術書典」の第三回、<a href="https://techbookfest.org/event/tbf03">技術書典３</a> が 10月22日 (日) に開催されました。
前回は一年以上間が空いていましたが、今回は約半年での開催となっています。
次回以降も同じスパンでやるのでしょう…か？</p>

<p>ともかく、普通に一般参加しようと思っていましたが、 <a href="https://twitter.com/IoriAYANE">@IoriAYANE</a> さんから、<a href="https://twitter.com/IoriAYANE/status/920595682238504961">当日のお手伝い</a>を頼まれたので、またとない機会なのでお手伝いを引き受けて、サークル側として参加してきました。</p>

<p><a href="/images/2017_1022_tf3.jpg"><img src="/thumbs/3efc7875eddb11ca8108b13ccd251554-256x256.jpg" alt="会場前にて"></a></p>

<h2 id="%E5%BD%93%E6%97%A5%E3%81%AE%E6%A7%98%E5%AD%90">当日の様子</h2>

<p>近づく台風のため雨がザーザーと降る中、お宿から電車を乗り継いで、9時ぐらいに秋葉原に到着、そして秋葉原駅５番ホーム（総武線）の <a href="https://tabelog.com/tokyo/A1310/A131001/13049969/">パンと牛乳の店 ミルクスタンド[食べログ]</a> で少し遅めの朝食です。</p>

<p><a href="/images/2017_1022_akihabara_05_home.jpg"><img src="/thumbs/11ad833ff0a937dc7fdcea4d87b0548c-256x256.jpg" alt="総武線ホーム"></a>
<a href="/images/2017_1022_milkstand.jpg"><img src="/thumbs/e7b0a7eeffef7c928c2f79ce1a312a67-256x256.jpg" alt="ミルクスタンド"></a>
<a href="/images/2017_1022_breakfast1.jpg"><img src="/thumbs/5168501a3f59bb24b906a7791fd42bb3-256x256.jpg" alt="朝食１"></a>
<a href="/images/2017_1022_breakfast2.jpg"><img src="/thumbs/0e2bc01f16c26a4e53eb13d9f1a9f24c-256x256.jpg" alt="朝食２"></a></p>

<p>その後、ブースが狭いためおっきい荷物入れておけないとの事だったのでホームの外のコインロッカーを探して荷物を入れます。</p>

<p><a href="/images/2017_1022_akihabara_udx.jpg"><img src="/thumbs/b0eff505f9ea3b240fa574d387c889a5-256x256.jpg" alt="秋葉原UDX"></a></p>

<p>9時半過ぎに会場の「秋葉原UDX」に向かうと、すでに少し行列が……</p>

<p><a href="/images/2017_1022_tf3_circles_queue.jpg"><img src="/thumbs/0f8891d1e8c8b1ccaaa54cb570244164-256x256.jpg" alt="サークル参加者入場待機列"></a></p>

<p>と思ったら、どうやら、サークル参加者の入場待ちだった。</p>

<p>会場自体の設営は７時半過ぎから始まって、９時頃には完了していたようです。</p>

<p>そして、事前のやり取りでは10時少し前の予定だったけど、9時半過ぎ<a href="https://twitter.com/IoriAYANE">@IoriAYANE</a> さんと合流できたので、サークルチケットを貰って会場入り。</p>

<p>それから、机の上の椅子をどかして、テーブルクロスを広げたり、既刊本や新刊本（印刷屋さんから会場に直接届く）を広げたり、と設営を行い10時半には設営完了。</p>

<p><a href="/images/2017_1022_tf3_booth_setup.jpg"><img src="/thumbs/c629685df616bcd7386053352cc3333c-256x256.jpg" alt="設営完了"></a></p>

<p>時間だけ見ると、結構かかっているようだけど、意外とやることが多かった。
ちなみに、会場内で出たゴミはお持ち帰りです。</p>

<p>一般入場は11時だったのですが、すでに10時半の段階で結構な人が並んでいました。
今回は、整理券配布だったようですが、それでも皆さんお早いお待ちで……</p>

<p>12時過ぎには入場制限が解除されて、ほぼ待ちなしで入場できていた（と会場案内があったと思う）ようです。</p>

<p>11時を数秒過ぎた辺りで運営から案内があり、会場内拍手で一般の入場が始まりました。</p>

<p><a href="/images/2017_1022_catch_copy.jpg"><img src="/thumbs/273ce2723afbd79ee56ce9eea90f7460-256x256.jpg" alt="キャッチコピー"></a></p>

<p>今回自分は、11時から会場内を回って本を確保したり、他サークルさんの本の確保のお使いをしたり、お昼を買いに行ったり（雨で大変だった）と、一般参加に毛が生えたような感じだったのですが、<a href="https://twitter.com/IoriAYANE">@IoriAYANE</a> さんの方は、</p>

<ul>
<li>設営作業</li>
<li>訪ねてこられた顔見知りさんの対応</li>
<li>購入手続き対応</li>
<li>撤収作業</li>
<li>新刊本の余りの送付手続き</li>
</ul>

<p>などなど、大変だったようです。
会場も見て回れたのは午後からのようでしたので、サークル参加は大変そうだ、と遠い眼を……
もちろん、微力ながら自分もお手伝いしました。</p>

<p>今回、運営さんが「<a href="https://play.google.com/store/apps/details?id=org.techbookfest">かんたん後払いアプリ</a>」なるものをリリースしていたので、利用して見ました。
故実の請求の金額が怖い……</p>

<p>ともかく、サークルごとに対応している所と、していない所があったので、現金を全く持たずに回れたかというとそうではなかったですが、それでもなかなか面白い試みだったなと思います。
まあ、アプリ自体は突貫でリリースされたようなので決済以外は今後に期待、なところもありましたが。</p>

<p><a href="/images/2017_1022_tf3_buy.png"><img src="/thumbs/f077d5dc55b36616b0e3a5045c9c2e46-256x256.png" alt="購入"></a></p>

<p>全体の客足は、開場直後から昼ぐらいまでが多くて、それ以降はある程度落ち着きつつ、それでも人は入ってきていたようです。
まあ、夕方少なくなったのは台風の影響があるのかもしれませんが……</p>

<p>今回、新しい試みとして、2Fの会場だけでなく、4Fにも部屋を2箇所借りて、「立ち読み会場」と「戦利品会場」を設けていました。</p>

<p>こちらには、昼食時についでに訪ねました。</p>

<p>立ち読み会場の方は、部屋に折り畳み机をロ形に並べ、その上に任意のサークルさんから提出された本（これは新刊、既刊は問わないようです）を並べ、訪れた人が自由に手に取って見れるようにしていました。
そういえば、見本誌とは別でしたが、最終的にどうなったんでしょうかね？</p>

<p>もう一方の、戦利品会場の方は、椅子に座って戦利品を見たりできる、休憩スペースのような感じでした。
まあ、殆ど席は埋まっていましたが……</p>

<p><a href="/images/2017_1022_tf3_trophy_room1.jpg"><img src="/thumbs/b1d5fe56e035061eca3486b392fab364-256x256.jpg" alt="戦利品会場１"></a></p>

<p><a href="/images/2017_1022_tf3_trophy_room2.jpg"><img src="/thumbs/e857e8a43e2e85f9eb5463c258adb77c-256x256.jpg" alt="戦利品会場２"></a></p>

<p>そして……</p>

<p>閉場の17時近くにもなると、完売したためかすでに撤収作業済みの所や、ブースを撤収して帰る前に会場内を回って目ぼしい物がないかと物色するサークル参加者がいたり。</p>

<p>自分がお手伝いをした、サークル「理ろぐ」さんでは撤収は閉場してから始めました。</p>

<p><a href="/images/2017_1022_tf3_booth_withdraw.jpg"><img src="/thumbs/4400cfa0b4fec130323f30977fbcd8f6-256x256.jpg" alt="撤収完了"></a></p>

<p>まあ、撤収は10分程度で終了しましたね。</p>

<p>会場自体の撤収も1時間程度で終わったようです。</p>

<p>結局、運営発表によると台風が近づく中でも「<a href="https://twitter.com/techbookfest/status/922010073890615296">ユニーク来場者数：2750名、再入場者含むのべ：3100名</a>」と前回の「<a href="https://twitter.com/TechBooster/status/850983169037697024">一般来場：3100人</a>」とほぼ同じぐらいの来場があったそうです。</p>

<p><a href="/images/2017_1022_tf3_see_you_next.jpg"><img src="/thumbs/2fd36138a47da3a708b9f65edc820373-256x256.jpg" alt="次回また！"></a></p>

<h2 id="%E6%88%A6%E5%88%A9%E5%93%81">戦利品</h2>

<p>今回の戦利品</p>

<p><a href="/images/2017_1022_tf3_booty.jpg"><img src="/thumbs/f3afa0c686b763d75e363a078828a6bc-256x256.jpg" alt="戦利品"></a></p>

<table>
<thead>
<tr>
  <th>ブース</th>
  <th>サークル名</th>
  <th>備考</th>
</tr>
</thead>
<tbody>
<tr>
  <td>い01</td>
  <td><a href="https://techbookfest.org/event/tbf03/circle/5747272637743104">TechBooster</a></td>
  <td>「技術季報 Vol.2」※技術書典カタログ</td>
</tr>
<tr>
  <td>あ09</td>
  <td><a href="https://techbookfest.org/event/tbf03/circle/5762702576189440">日経BP出版局</a></td>
  <td>「クラウディアさんB5クリアファイル（非売品）」 ※ジャンケンで勝って貰った</td>
</tr>
<tr>
  <td>あ13</td>
  <td><a href="https://techbookfest.org/event/tbf03/circle/5692896204292096">シス管系女子会</a></td>
  <td>「シス管系女子リーフレット」 ※無料配布</td>
</tr>
<tr>
  <td>い03</td>
  <td><a href="https://techbookfest.org/event/tbf03/circle/5644572721938432">KLab 株式会社</a></td>
  <td>「KLab Tech Book Vol. 1」</td>
</tr>
<tr>
  <td>い10</td>
  <td><a href="https://techbookfest.org/event/tbf03/circle/5764321241989120">clear-mint</a></td>
  <td>「Gijutsu-san-saku 2017 Autumn」</td>
</tr>
<tr>
  <td>う12</td>
  <td><a href="https://techbookfest.org/event/tbf03/circle/5713274213498880">カウプラン機関極東支部</a></td>
  <td>「オブジェクト指向言語 解体新書」</td>
</tr>
<tr>
  <td>え17</td>
  <td><a href="https://techbookfest.org/event/tbf03/circle/5132766970642432">べころもち工房</a></td>
  <td>「Vue.jsでポートフォリオサイト制作記」 ※電子書籍</td>
</tr>
<tr>
  <td>お06</td>
  <td><a href="https://techbookfest.org/event/tbf03/circle/6027786883956736">TomoriNao</a></td>
  <td>「TomoriNao Vol.1 -We are TomoriNao! いろいろな友利奈緒が大集合！-」</td>
</tr>
<tr>
  <td>お11</td>
  <td><a href="https://techbookfest.org/event/tbf03/circle/5644534738321408">Code Craft Works</a></td>
  <td>「オブジェクト指向とQt」</td>
</tr>
<tr>
  <td>お12</td>
  <td><a href="https://techbookfest.org/event/tbf03/circle/5767047069827072">理ろぐ</a></td>
  <td>「QtQuickを使いこなす クロスプラットフォームUIプログラミング３」</td>
</tr>
<tr>
  <td>お18</td>
  <td><a href="https://techbookfest.org/event/tbf03/circle/5659569942429696">74th</a></td>
  <td>「ViualStudioCodeデバッグ技術」</td>
</tr>
<tr>
  <td>か22</td>
  <td><a href="https://techbookfest.org/event/tbf03/circle/5686003050217472">めがねをかけるんだ</a></td>
  <td>「TensorFlowはじめました Object Detection - 物体認識」</td>
</tr>
<tr>
  <td>か43</td>
  <td><a href="https://techbookfest.org/event/tbf03/circle/6207522675359744">Indie Visual Lab</a></td>
  <td>「Unity Graphics Programming」</td>
</tr>
<tr>
  <td>き05</td>
  <td><a href="https://techbookfest.org/event/tbf03/circle/5174530561540096">こくだランド</a></td>
  <td>「わか(った気がす)るWebRTC」</td>
</tr>
</tbody>
</table>

<p>※敬称略、ブース順</p>

<h2 id="%E3%81%BE%E3%81%A8%E3%82%81">まとめ</h2>

<ul>
<li>一般入場とはまた違った視点で見られまたとない経験ができた</li>
<li>一人でサークル参加は厳しいものがありそうだ</li>
<li>運営さんもいろんな試みをしている様子</li>
<li>また次回も一般なのかサークルなのかはわからないですが参加したい！</li>
</ul>

<h2 id="%E5%8F%82%E8%80%83">参考</h2>

<ul>
<li><a href="https://twitter.com/techbookfest">技術書典公式アカウント(@techbookfest)さん | Twitter</a></li>
<li><a href="https://twitter.com/consomme72">こんそめ(@consomme72)さん | Twitter</a></li>
<li><a href="https://twitter.com/consomme72/status/921869169267687424">こんそめさんのツイート: "これから設営です #技術書典 https://t.co/1KqJSF3e68"</a></li>
<li><a href="https://twitter.com/consomme72/status/921889799392206848">こんそめさんのツイート: "設営中です #技術書典 https://t.co/CfdynRWSvz"</a></li>
<li><a href="https://twitter.com/consomme72/status/922023704892096512">こんそめさんのツイート: "兵どもが夢の跡 #技術書典 https://t.co/9HdJIHFgfz"</a></li>
</ul>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[じゅげむったーの開発日記 その８]]></title>
            <link href="http://www.sharkpp.net/blog/2017/10/21/jugemutter-development-diary-8th.html"/>
            <updated>2017-10-21T17:41:00+00:00</updated>
            <id>http://www.sharkpp.net/blog/2017/10/21/jugemutter-development-diary-8th.html</id>
            <content type="html"><![CDATA[<p>今回は、明日行われる <a href="https://techbookfest.org/event/tbf03">技術書典３</a> に前日入りして、<a href="https://qt-users.connpass.com/event/68878/">Qt 勉強会 @ Tokyo #52</a> に参加してきました。</p>

<p>東京の勉強会はすごく久しぶりの参加でした。</p>

<p>以前は、誰かしらが発表をして、それを聞く感じの会でしたが、最近はもくもくがメインのようでした。</p>

<p>レポジトリは ... <a href="https://github.com/sharkpp/Jugemutter">sharkpp/Jugemutter: 長文投稿専用クライアント「じゅげむったー」</a> となります。</p>

<h2 id="twitter-api-%E3%81%AE-%22could-not-authenticate-you.%22-%E5%95%8F%E9%A1%8C">Twitter API の "Could not authenticate you." 問題</h2>

<p>Twitter API への要求で <code>Could not authenticate you.</code> とレスポンスが返ってくる問題、どうも <a href="https://bugreports.qt.io/browse/QTBUG-61125">[QTBUG-61125] QOAuth1 creates an invalid signature for percent encoded query - Qt Bug Tracker</a> のバグが原因ではなかった様子。</p>

<p>なので、ちょっと踏み込んで調べて見ることにする。</p>

<p>とりあえず、比較のために PHP で同じように Twitter API を使って見ることに。</p>

<p>ライブラリは <a href="https://github.com/risan/oauth1">risan/oauth1: 🔐 OAuth 1.0 client library for PHP</a> をとりあえず試して見る。</p>

<p>何はともあれ composer をインストール</p>

<pre><code class="console">$ php -r "copy('https://getcomposer.org/installer', 'composer-setup.php');"
$ php -r "if (hash_file('SHA384', 'composer-setup.php') === '544e09ee996cdf60ece3804abc52599c22b1f40f4323403c44d44fdfdd586475ca9813a858088ffbc1f233e9b180f061') { echo 'Installer verified'; } else { echo 'Installer corrupt'; unlink('composer-setup.php'); } echo PHP_EOL;"
$ php composer-setup.php
$ php -r "unlink('composer-setup.php');"
</code></pre>

<p>ライブラリをインストール</p>

<pre><code class="console">$ php composer.phar require risan/oauth1
</code></pre>

<p>で、いろいろ試している..</p>

<p>ソースは <a href="https://github.com/risan/oauth1#basic-usage">risan/oauth1: Basic Usage</a> を基に <code>$ sudo php -S localhost:80 -t .</code> で動かします。</p>

<pre><code class="php">&lt;?php

// Start session.
session_start();

// Include Composer autoload file.
require 'vendor/autoload.php';

// Create a new instance of OAuth1 client for Twitter.
$oauth1 = new OAuth1\OAuth1([
    'consumer_key'      =&gt; 'YOUR_TWITTER_CONSUMER_KEY',
    'consumer_secret'   =&gt; 'YOUR_TWITTER_CONSUMER_SECRET',
    'request_token_url' =&gt; 'https://api.twitter.com/oauth/request_token',
    'authorize_url'     =&gt; 'https://api.twitter.com/oauth/authorize',
    'access_token_url'  =&gt; 'https://api.twitter.com/oauth/access_token',
    'callback_url'      =&gt; 'http://localhost:80', // Optional
    'resource_base_url' =&gt; 'https://api.twitter.com/1.1/'
]);

// STEP 4: ACCESS PROTECTED RESOURCE.
if (isset($_SESSION['access_token'])) {
    // Retrieve the saved AccessToken instance (see STEP 3).
    $accessToken = unserialize($_SESSION['access_token']);

    // Set access token.
    $oauth1-&gt;setGrantedAccessToken($accessToken);

    // Get authenticated user's timeline.
    // @return Psr\Http\Message\ResponseInterface instance
    //$response = $oauth1-&gt;get('statuses/user_timeline.json');
    $response = $oauth1-&gt;post('statuses/update.json', [
        'query' =&gt; [
        //'form_params' =&gt; [ // risan/oauth1 が対応していない様子
            'status' =&gt; 'test',
        ]
    ]);

    echo $response-&gt;getBody()-&gt;getContents();
}

// STEP 3: GET ACCESS TOKEN.
elseif (isset($_GET['oauth_token']) &amp;&amp; isset($_GET['oauth_verifier'])) {
    // Retrieve the previously generated request token (see STEP 1).
    $requestToken = unserialize($_SESSION['request_token']);

    // Get access token.
    // @return OAuth1\Tokens\AccessToken instance
    $accessToken = $oauth1-&gt;accessToken($requestToken, $_GET['oauth_token'], $_GET['oauth_verifier']);

    // Serialize AccessToken instance and save it to session.
    $_SESSION['access_token'] = serialize($accessToken);

    // No longer need request token.
    unset($_SESSION['request_token']);

    // Reload page.
    header("Location: {$_SERVER['PHP_SELF']}");
    exit();
}

// STEP 1: Get request token.
// STEP 2: Redirect to authorization page.
else {
    // Get request token.
    // @return OAuth1\Tokens\RequestToken instance
    $requestToken = $oauth1-&gt;requestToken();

    // Serialize RequestToken instance and save to session.
    $_SESSION['request_token'] = serialize($requestToken);

    // Redirect to authorization url.
    $authorizationUrl = $oauth1-&gt;buildAuthorizationUrl($requestToken);
    header("Location: {$authorizationUrl}");
    exit();
}
</code></pre>

<p>あれ？</p>

<p><del><code>{"code":32,"message":"Could not authenticate you."}</code> になるっぽい、なぜだろう？</del> <code>risan/oauth1</code> の実装が POST の フォームに対応していなかっただけのようだ。</p>

<p>↑から、URLのクエリ形式で送れば大丈夫っぽい。</p>

<blockquote class="twitter-tweet" data-lang="ja"><p lang="ja" dir="ltr">むぅPOSTのフォームではなくURLのクエリで送れば(や%も大丈夫っぽいなぁ (おわり <a href="https://twitter.com/hashtag/qtjp?src=hash&amp;ref_src=twsrc%5Etfw">#qtjp</a> <a href="https://twitter.com/hashtag/jugemutter?src=hash&amp;ref_src=twsrc%5Etfw">#jugemutter</a></p>&mdash; これでチーム「さめたすたす」は最強だ！ (@sharkpp) <a href="https://twitter.com/sharkpp/status/921656868535021570?ref_src=twsrc%5Etfw">2017年10月21日</a></blockquote>

<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

<p>何か勘違いしているのか？</p>

<p>というところでタイムアップ。</p>

<h2 id="twitter-api-reference-%E3%81%AE-url-%E3%81%8C%E5%A4%89%E3%82%8F%E3%81%A3%E3%81%9F%EF%BC%9F">Twitter API reference の URL が変わった？</h2>

<p>なんか、Twitter API のリファレンスページのアドレスが変わっている様子。</p>

<pre><code>https://dev.twitter.com/rest/reference/post/statuses/update
</code></pre>

<p>↓</p>

<pre><code>https://developer.twitter.com/en/docs/tweets/post-and-engage/api-reference/post-statuses-update
</code></pre>

<p>リダイレクトで飛ばして欲しかったなぁ。</p>

<h2 id="%E5%8B%89%E5%BC%B7%E4%BC%9A">勉強会</h2>

<h3 id="qt-contributors-summit-2017-%E3%81%A8-qt-world-summit-2017-%E3%81%AE%E5%A0%B1%E5%91%8A">Qt contributors summit 2017 と Qt World Summit 2017 の報告</h3>

<p>2017年10月9日〜10月10日に開催された <a href="https://www1.qt.io/event/qt-contributors-summit-2017/">Qt Contributors' Summit 2017</a> および、2017年10月10日〜10月12日に開催された <a href="https://www1.qt.io/event/qt-world-summit-2017/">Qt World Summit</a> の<a href="https://twitter.com/takumiasaki">朝木卓見(@takumiasaki)</a> さんによる報告。</p>

<p>関連するリンク</p>

<ul>
<li><a href="https://wiki.qt.io/Qt_contributors_summit_2017">Qt contributors summit 2017 - Qt Wiki</a></li>
<li><a href="https://wiki.qt.io/Qt_contributors_summit_2017_Program">Qt contributors summit 2017 Program - Qt Wiki</a> - セッションプログラム一覧</li>
<li><a href="https://wiki.qt.io/QtCS2017_QtCore">QtCS2017 QtCore - Qt Wiki</a> - 該当のセッションで出た話</li>
<li><a href="http://blog.qt.io/blog/2017/10/11/qt-3d-studio-source-code-pre-release-snapshots-available/">Qt 3D Studio Source Code and Pre-Release Snapshots Available - Qt Blog</a></li>
<li><a href="https://github.com/KDAB">KDAB</a></li>
</ul>

<h3 id="qt-3d-studio-%E3%81%AE%E7%B4%B9%E4%BB%8B">Qt 3D Studio の紹介</h3>

<p><a href="https://twitter.com/shin1_okada">岡田 真一(@shin1_okada)</a> さんによる、Qt 3D Studio の紹介。</p>

<p>現状、macOS向けは、ビルドできるけど大きなデモを動かす、Qt Creator から動作させる、などでクラッシュする、とのこと。</p>

<p>関連するリンク</p>

<ul>
<li><a href="http://blog.qt.io/blog/2017/10/11/qt-3d-studio-source-code-pre-release-snapshots-available/">Qt 3D Studio Source Code and Pre-Release Snapshots Available - Qt Blog</a></li>
<li><a href="https://codereview.qt-project.org/#/admin/projects/qt3dstudio/qt3dstudio">codereview.qt-project Code Review</a> - デフォルトだと submodule が取得されないので注意</li>
</ul>

<h2 id="%E5%8F%82%E8%80%83">参考</h2>

<ul>
<li><a href="https://qiita.com/hnw/items/d72815e2d45f898d9184">SipHashについてのメモ - Qiita</a></li>
<li><a href="http://docs.guzzlephp.org/en/5.3/clients.html">Clients — Guzzle Documentation</a></li>
<li><a href="https://qiita.com/k-holy/items/4362b8cce85642e477ec">Windows + Goutte 3.0でHTTPSでのリクエストで発生するSSL証明書のエラー - Qiita</a></li>
<li><a href="https://qiita.com/mikakane/items/58c30b243bba697ec3fe">guzzle で Http通信する - Qiita</a></li>
<li><a href="https://developer.twitter.com/en/docs/tweets/post-and-engage/api-reference/post-statuses-update">POST statuses/update — Twitter Developers</a></li>
</ul>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[じゅげむったーの開発日記 その７]]></title>
            <link href="http://www.sharkpp.net/blog/2017/10/04/jugemutter-development-diary-7th.html"/>
            <updated>2017-10-04T01:05:00+00:00</updated>
            <id>http://www.sharkpp.net/blog/2017/10/04/jugemutter-development-diary-7th.html</id>
            <content type="html"><![CDATA[<p>前回に引き続き <a href="https://qt-users.connpass.com/event/67390/">Qt 勉強会 @ Nagoya No13 一区切り会 - connpass</a> に参加しました。
とりあえず、今回でもくもく会は一旦一区切りとなるので、このあとはボチボチと進めていこうかなと思います。</p>

<p>レポジトリは ... <a href="https://github.com/sharkpp/Jugemutter">sharkpp/Jugemutter: 長文投稿専用クライアント「じゅげむったー」</a> となります。</p>

<p>画面は、多言語対応をしたので載っけます。</p>

<p><img src="/images/2017_0930_jugemutter_jp.png" alt="日本語版" /></p>

<p>次はなんちゃっての英語版です。</p>

<p><img src="/images/2017_0930_jugemutter_en.png" alt="英語版" /></p>

<h2 id="twitter-api-%E3%81%A7-%22could-not-authenticate-you.%22-%E3%81%8C%E5%87%BA%E3%82%8B">Twitter API で "Could not authenticate you." が出る</h2>

<p>Twitter API への要求で <code>Could not authenticate you.</code> とレスポンスが返ってくる件、HMACとかの計算を手動でやって検証しようかと考えたけど、そうだその前に、Qtのバグトラッカーで登録ないか、と、探して見たら...</p>

<p><a href="https://bugreports.qt.io/browse/QTBUG-61125">[QTBUG-61125] QOAuth1 creates an invalid signature for percent encoded query - Qt Bug Tracker</a></p>

<p>まさに、ドンピシャなものが、４ヶ月も前の 5/31 に報告が上がっていました。</p>

<p>それでもって、修正完了の 5.9.2 でリリースらしい。</p>

<p><a href="https://wiki.qt.io/Qt_5.9_Release">Qt 5.9 Release - Qt Wiki</a> によると、この記事を書いている時点では <code>September 2017</code> に公開予定らしいので、もう少し待つ必要があるみたい。</p>

<p>まあ、今回の教訓は先にバグトラッカーを探すべきだったのかなぁと、言うこと。</p>

<h2 id="%E3%80%90%E6%82%B2%E5%A0%B1%E3%80%91%E3%81%98%E3%82%85%E3%81%92%E3%82%80%E3%81%A3%E3%81%9F%E3%83%BC%E7%94%A8twitter%E3%82%A2%E3%82%AB%E3%82%A6%E3%83%B3%E3%83%88%E3%81%8C%E5%87%8D%E7%B5%90%E3%81%95%E3%82%8C%E3%81%A6%E3%81%9F%E4%BB%B6%E3%80%90%E3%81%84%E3%81%A4%E3%81%AE%E3%81%BE%E3%81%AB%E3%80%91">【悲報】じゅげむったー用Twitterアカウントが凍結されてた件【いつのまに】</h2>

<p>とりあえず、APIの要求は、Qtのバグが原因で特定文字で必ずエラーが返ってくるらしいので、とりあえず諦めて他のことを進めることにしました。</p>

<p>で、何をやろうかと考えたところで、せっかくマルチアカウント管理を実装したので試してみようと久しぶりにサブ垢（公式垢として利用しようと登録したもの）へログインしたところ...</p>

<p><img src="/images/2017_0930_twitter_frozen_acctount.png" alt="凍結済みアカウント(再現)" /></p>

<p>ん？ んん？ は？ と、凍結！？ 
※ スクショは撮り忘れたので当時の状況を可能な限り再現しています</p>

<p>と、言うわけで、何時のまにか今流行り（？）の凍結祭りに参加していたようです。
とりあえず、慌てて解除方法をググり、凍結の解除申請をしました。</p>

<p>そして、30分後...</p>

<p><img src="/images/2017_0930_twitter_thawed_account.png" alt="凍結解除" /></p>

<p>ほっ。</p>

<p>ヘッダー画像やプロフィール画像、あとは本垢への相互フォロー、そして鍵垢と、諸々設定しました。</p>

<h2 id="%E5%A4%9A%E8%A8%80%E8%AA%9E%E5%AF%BE%E5%BF%9C">多言語対応</h2>

<p>Qt で .ts / .qm でのラベルなどの多言語対応、昔々もやった記憶があるけど、忘却の彼方に近いので、改めて調べた。</p>

<h3 id="%E8%A8%80%E8%AA%9E%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E6%8C%87%E5%AE%9A">言語ファイルの指定</h3>

<p><code>.pro</code> を開き、言語ファイルのパスを設定。パスは適時読み替えてください。
 複数言語ある場合は、、スペース区切りで後ろに追加します。</p>

<pre><code class="ini">     :
TRANSLATIONS = src/i18n/ja_JP.ts
     :
</code></pre>

<h3 id="%E7%BF%BB%E8%A8%B3%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E8%AA%AD%E3%81%BF%E8%BE%BC%E3%81%BF">翻訳ファイルの読み込み</h3>

<p>起動時に現在のロケールを元に言語ファイルを読み込む処理を実装します。</p>

<p><code>.qm</code> ファイルはアプリケーションのリソースとして埋め込み、そこから読むようにしています。</p>

<pre><code class="cpp">            :
    // 翻訳
    QString locale = QLocale::system().name();
    QTranslator translator;
    translator.load(locale, ":/i18n");
    a.installTranslator(&amp;translator);
            :
</code></pre>

<p><code>locale</code> の値は、日本語環境だったら <code>ja_JP</code> です。</p>

<p>リソースへの登録はこんな感じ</p>

<p><img src="/images/2017_0930_qm_in_qrc.png" alt="qmファイルのqrcへの登録" /></p>

<h3 id="%E7%BF%BB%E8%A8%B3%E5%AF%BE%E8%B1%A1%E3%81%AE%E6%8C%87%E5%AE%9A">翻訳対象の指定</h3>

<p>まずは、翻訳したいものを <a href="http://doc.qt.io/qt-5/qobject.html#tr"><code>tr(...)</code></a> で囲います。</p>

<pre><code class="diff">     if (tweetQueue.isEmpty()) {
          finishPost();
 -        QMessageBox::information(this, qAppName(), "投稿を完了しました。");
 +        QMessageBox::information(this, qAppName(), tr("Your post has been completed."));
          return;
      }
</code></pre>

<p>こんな感じ。</p>

<h3 id="%E7%BF%BB%E8%A8%B3%E5%AF%BE%E8%B1%A1%E3%81%AE%E6%8A%BD%E5%87%BA">翻訳対象の抽出</h3>

<p>QtCreator のメニューから「ツール」→「外部」と辿り「翻訳を更新(lupdate)」を実行します。</p>

<p><img src="/images/2017_0930_qtcreator_extrnal_tools_linguist.png" alt="翻訳を更新" /></p>

<p>すると、 先ほど、<code>tr(...)</code> で囲った部分や <code>.ui</code> ファイルから翻訳対象が抽出されファイルへ書き出されます。
ソース側の記述が変わった時は、同じように「翻訳を更新(lupdate)」を実行すると、変更が適用されます。</p>

<h3 id="%E7%BF%BB%E8%A8%B3">翻訳</h3>

<p>Linguist を起動し</p>

<p><img src="/images/2017_0930_linguist.png" alt="Linguist" /></p>

<p>抽出された文字列を翻訳していきます。</p>

<h3 id="qt-message-file-format-%E3%82%92%E3%83%93%E3%83%AB%E3%83%89">Qt message file format をビルド</h3>

<p><code>.ts</code> を <code>.qm</code> (Qt message file format)へと変換します。
GNU gettext の <code>.po</code> と <code>.mo</code> との関係と同じですね。</p>

<p>QtCreator のメニューから「ツール」→「外部」と辿り「翻訳をリリース(lrelease)」を実行します。
これで <code>.ts</code> から <code>.qm</code> へと変換します。</p>

<h3 id="%E8%B5%B7%E5%8B%95%E7%A2%BA%E8%AA%8D">起動確認</h3>

<p>実際に翻訳できているかどうかは、ロケールを切り替えると確認できます。</p>

<p>普通に起動すると……</p>

<p><img src="/images/2017_0930_jugemutter_jp.png" alt="日本語版" /></p>

<p>こう。</p>

<p>言語を英語にすると……</p>

<pre><code class="console"># LANG=en_US.UTF-8 open ./Jugemutter.app
</code></pre>

<p><img src="/images/2017_0930_jugemutter_en.png" alt="英語版" /></p>

<p>こうなります。</p>

<h2 id="%E5%8F%82%E8%80%83">参考</h2>

<ul>
<li><a href="https://kazuto-yoshida.com/twitter-unfreeze-application.html">Twitterアカウント凍結解除方法と申請入力例</a></li>
<li><a href="https://forum.qt.io/topic/57863/solved-how-to-embed-qm-translation-files-into-executable">[solved]How to embed qm translation files into executable | Qt Forum</a></li>
<li><a href="https://github.com/wireshark/wireshark/tree/master/ui/qt">wireshark/ui/qt at master · wireshark/wireshark</a></li>
<li><a href="http://doc.qt.io/qt-5/qtlinguist-hellotr-example.html">Hello tr() Example | Qt Linguist Manual</a></li>
</ul>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[じゅげむったーの開発日記 その６]]></title>
            <link href="http://www.sharkpp.net/blog/2017/09/27/jugemutter-development-diary-6th.html"/>
            <updated>2017-09-27T12:40:00+00:00</updated>
            <id>http://www.sharkpp.net/blog/2017/09/27/jugemutter-development-diary-6th.html</id>
            <content type="html"><![CDATA[<p>遅くなりましたが、今月も引き続き参加した <a href="https://qt-users.connpass.com/event/65548/">Qt 勉強会 @ Nagoya No12 - connpass</a> のまとめです。</p>

<p>重大発表があってちょっとびっくりでした。
それはともかく今回も長文投稿専用Twitterクライアントの開発の続きでした。</p>

<p>レポジトリは ... <a href="https://github.com/sharkpp/Jugemutter">sharkpp/Jugemutter: 長文投稿専用クライアント「じゅげむったー」</a> となります。</p>

<p>画面は...変わってないからいいですね。</p>

<h2 id="%E9%80%B2%E6%8D%97">進捗</h2>

<p>相変わらず <code>Could not authenticate you.</code> がなぜか出る、と。</p>

<p>そこで、先日に <a href="https://github.com/sharkpp/http-peeper">sharkpp/http-peeper: This is a proxy server for peeping HTTP/HTTPS communication, mainly for debugging.</a> と言うツールを NodeJS でサクッと作ってみました。
一言で言うと https 通信の間に割り込んで中身を見てしまうツールです。</p>

<p>今回は、これの改良というか改善？をして、他のソフトの通信の内容と比較してみました。</p>

<p>まあ、結果として、少なくともパラメータやヘッダなどには特に違いがなさそうだ、という事がわかりました。
困ったことに、全く解決になっていないです...</p>

<p>あとは、HMACなどの計算時に無駄にエスケープしている事で、サーバー側での検証時と値が違うのかなぁと。
まあ、そうだとすると Qt 側のバグなのですが...</p>

<p>と、まあそんなところで終了。</p>

<p>まあ、あとは重大発表として Qt 勉強会 @ Nagoya が残念なことに今回で一旦休止の発表があり（次回が一旦の〆）となってしまいました。
なかなか、会場の都合が付かないので難しいですねぇ。</p>

<h2 id="%E4%BB%96%E3%81%AE%E3%82%BD%E3%83%95%E3%83%88%E3%81%AE%E9%80%9A%E4%BF%A1%E3%82%92%E8%A6%97%E3%81%8D%E8%A6%8B">他のソフトの通信を覗き見</h2>

<p>先のツール（<a href="https://github.com/sharkpp/http-peeper">http-peeper</a>）、証明書は当然本物ではなく所謂オレオレ証明書と呼ばれているものを使っている都合、証明書の検証をしている（OpenSSL等のライブラリを使っている場合は基本検証している）とエラーが出てしまうのです。
そのために、そのままだと他のソフトには使えないのでした。
さてどうするか？と考えていたところ、そういえばオレオレ認証局の証明書を作りシステムに登録して信頼、その認証局で署名することで対応と書かれている記事を見かけた覚えがあったので、とりあえずツールに組み込む前に手作業でやって見ました。</p>

<h3 id="%E6%89%8B%E9%A0%86">手順</h3>

<p><code>openssl.conf</code> をコピーして書き換えたり、いろいろして見ましたが結局こんな感じで試しました。</p>

<pre><code class="console">$ mkdir demoCA
$ cd demoCA
$ mkdir newcerts certs crl private
$ chmod 700 private
$ touch index.txt
$ echo 00 |tee serial
$ openssl req -batch -new -x509 -sha256 -days 36500 -newkey rsa:4096 -out ca.crt -keyout demoCA/private/ca.key -subj "/C=JP/ST=Tokyo/L=Tokyo/O=root.http-peeper.local/OU=root.http-peeper.local/CN=root.http-peeper.local"
$ openssl rsa -in demoCA/private/ca.key -out demoCA/private/ca.key
$ openssl req -batch -new -sha256 -days 36500 -newkey rsa:4096 -out demoCA/server.csr -keyout demoCA/private/server.key -batch -subj "/C=JP/ST=Tokyo/L=Tokyo/O=root.http-peeper.local/OU=api.twitter.com/CN=api.twitter.com"
$ openssl rsa -in demoCA/private/server.key -out demoCA/private/server.key
$ openssl ca -batch -days 36500 -keyfile demoCA/private/ca.key -cert demoCA/ca.crt -in demoCA/server.csr -out demoCA/server.crt
</code></pre>

<p>そして <code>ca.crt</code> を開き</p>

<p><img src="/images/2017_0916_macos_cert_reg_to_system.png" alt="証明書の追加" /></p>

<p>と、システムに登録します。</p>

<p>登録したら「キーチェーンアクセス」から証明書を探し</p>

<p><img src="/images/2017_0916_macos_view_cert_detail.png" alt="証明書を右クリック" /></p>

<p>右クリックで「情報を見る」から「常に信頼」を選び</p>

<p><img src="/images/2017_0916_macos_trust_root_cert.png" alt="証明書を信頼" /></p>

<p>と信頼させます。</p>

<p><img src="/images/2017_0916_macos_trusted_cert.png" alt="キーチェーンアクセス" /></p>

<p>「キーチェーンアクセス」では「この証明書はこのアカウントにとって信頼されている物として指定されています」と表示されています。</p>

<p>あとは、 <code>server.key</code> と <code>server.crt</code> を</p>

<pre><code class="console">$ openssl x509 -in server.crt -out tmp.der -outform DER
$ openssl x509 -in tmp.der -inform DER -out server-cert.pem -outform pem
$ openssl rsa -in server.key -out tmp.der -outform DER
$ openssl rsa -in tmp.der -inform DER -out server-key.pem -outform pem
</code></pre>

<p>と .pem 形式に変換（元々.pemで利用していたため）し利用しました。</p>

<p>手順はツールに組み込んで自動化したいところですが、とりあえず他のソフトの通信を覗き見できるようになりました。</p>

<h2 id="%E5%8F%82%E8%80%83">参考</h2>

<ul>
<li><a href="http://qiita.com/mkgask/items/8d66dcada58a485e3585#_reference-0c1fe982bfae4639fb65">Chrome58以降でハネられないSHA-2でオレオレ認証局署名のあるオレオレ証明書 - Qiita</a></li>
<li><a href="http://qiita.com/ll_kuma_ll/items/13c962a6a74874af39c6#20170508%E8%BF%BD%E8%A8%98">オレだよオレオレ認証局で証明書つくる - Qiita</a></li>
<li><a href="http://qiita.com/softark/items/15a5280bd38c5dd97b48">オレオレ認証局とオレオレ証明書 - Qiita</a></li>
<li><a href="http://qiita.com/NakashimaKeisuke_zerodaynet/items/bfc77e5fe98b587532d0">SSL証明書設定でよくやってることをまとめる。 - Qiita</a></li>
<li><a href="http://qiita.com/kunichiko/items/12cbccaadcbf41c72735">RSA鍵、証明書のファイルフォーマットについて - Qiita</a></li>
<li><a href="https://hacknote.jp/archives/13939/">SSL証明書を.crtから.pemに変換する方法 | ハックノート</a></li>
<li><a href="http://certificate.fyicenter.com/2134_OpenSSL_ca_Error_..._directory_for_new_certificate_..._.html">OpenSSL - OpenSSL "ca" Error "... directory for new certificate ..."</a></li>
</ul>
]]></content>
        </entry>
    </feed>