<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <title><![CDATA[さめたすたすのお家]]></title>
    <link href="http://www.sharkpp.net/blog/tags/PaaS.xml" rel="self"/>
    <link href="http://www.sharkpp.net/"/>
    <updated>2019-12-31T10:12:02+00:00</updated>
    <id>http://www.sharkpp.net/</id>
            <author>
            <name><![CDATA[sharkpp]]></name>                    </author>
        <generator uri="http://sculpin.io/">Sculpin</generator>
            <entry>
            <title type="html"><![CDATA[SqaleでFuelPHPを動かしてみました]]></title>
            <link href="http://www.sharkpp.net/blog/2013/03/17/fuelphp-on-sqale.html"/>
            <updated>2013-03-17T01:34:00+00:00</updated>
            <id>http://www.sharkpp.net/blog/2013/03/17/fuelphp-on-sqale.html</id>
            <content type="html"><![CDATA[<p></p>
<div class="alert alert-danger alert-dismissible" role="alert">
  <div class="pull-left"><i class="fa fa-warning fa-2x"></i></div>
  <dl style="margin-bottom: 0; margin-left: 35px;">
    <dt>2017-06-02 追記</dt>
    <dd>Sqaleは 2017年05月31日 にサービスの提供が終了しました。そのため下記内容は過去の参考としてのみ残してあります。</dd>
  </dl>
</div>

<!-- http://info.sqale.jp/?eid=105 http://archive.is/Fp1ES -->

<p><a href="https://groups.google.com/group/fuelphp_jp?hl=ja">fuelphp.jpのGoogleグループ</a>で <a href="http://info.sqale.jp/?eid=33">Sqale『無料アプリケーション1個 プレゼント』キャンペーン実施中！ | Sqale Information</a> なんてものをやってるのを知ったので早速登録してみました。(※3/17まで)</p>

<p>立ち上げてみたページは↓</p>

<ul>
<li>http://fuelphp-sharkpp.sqale.jp/</li>
<li>http:/sqale.sharkpp.net/ ※独自ドメインを設定</li>
</ul>

<h2 id="%E7%99%BB%E9%8C%B2">登録</h2>

<p>とりあえず、ページの手順通りにアカウントの登録とアプリケーションの登録をします。 ユーザー名とアプリケーション名を決めるのですが、公開用のURLが <code>http://{アプリケーション名}-{ユーザー名}.sqale.jp/</code> となるため、 うまいこと考えないと間抜けなアドレスになってしまいます。 独自のドメインを設定する方法もあります。</p>

<p>トップページからユーザー登録します。</p>

<p><a href="/images/2013_0317_sqale_01.png"><img src="/images/2013_0317_sqale_01_s.png" alt="トップページ" /></a></p>

<p>Twitterやfacebook、githubのアカウントを使っての登録もできます。</p>

<p><a href="/images/2013_0317_sqale_02.png"><img src="/images/2013_0317_sqale_02_s.png" alt="アカウント登録" /></a></p>

<p>登録が完了するとダッシュボードが表示されるので、続けてアプリケーションも登録しましょう。</p>

<p><a href="/images/2013_0317_sqale_03_dashboard.png"><img src="/images/2013_0317_sqale_03_dashboard_s.png" alt="登録直後のダッシュボード" /></a></p>

<p>ここで登録したアプリケーション名は、 <code>http://{アプリケーション名}-{ユーザー名}.sqale.jp/</code> の形式で公開アドレスに使われます。 なので、適当に自分の名前とかにすると、 <code>http://sharkpp-sharkpp.sqale.jp/</code> と、間抜けな感じになります(なります、なってしまったので、一旦削除しましたorz)</p>

<p><a href="/images/2013_0317_sqale_04_add_app.png"><img src="/images/2013_0317_sqale_04_add_app_s.png" alt="アプリケーションの登録" /></a></p>

<p>アプリケーションも登録完了です。 準備ができても勝手にリロードされないので、指示のとおり30秒ぐらい経ったらリロードしましょう。</p>

<p><a href="/images/2013_0317_sqale_05_dashboard.png"><img src="/images/2013_0317_sqale_05_dashboard_s.png" alt="アプリケーション登録直後のダッシュボード" /></a></p>

<p>リロードすると、アプリケーション詳細画面が表示されます。</p>

<p><a href="/images/2013_0317_sqale_06_dashboard.png"><img src="/images/2013_0317_sqale_06_dashboard_s.png" alt="アプリケーション詳細画面" /></a></p>

<p>登録直後の公開用ページ</p>

<p><a href="/images/2013_0317_sqale_07_all_ready.png"><img src="/images/2013_0317_sqale_07_all_ready_s.png" alt="登録直後の公開ページ" /></a></p>

<p>最後に、問い合わせフォームからキャンペーンの申し込みをしておきます。</p>

<p>登録完了すると、ステータスが契約状態：Freeになります。</p>

<p><a href="/images/2013_0317_sqale_08_free.png"><img src="/images/2013_0317_sqale_08_free_s.png" alt="契約状態" /></a></p>

<p>と、このように登録が完了したところで、本題のFuelPHPをアップします。</p>

<h2 id="fuelphp%E3%82%92%E5%8B%95%E3%81%8B%E3%81%97%E3%81%A6%E3%81%BF%E3%82%8B">FuelPHPを動かしてみる</h2>

<p>サポートページの<a href="https://sqale.jp/support/manual/fuelphp">Sqale - Sqale で FuelPHP を利用する</a>に やり方が書いてあるので参考にします。 とりあえず、SFTPで転送してみます。</p>

<p>自分は、<a href="http://winscp.net/">WinSCP</a>を使っているのでこいつで転送しました。 ログイン情報はダッシュボードのアプリケーション詳細に書かれています。</p>

<p><a href="/images/2013_0317_sqale_09_dashboard.png"><img src="/images/2013_0317_sqale_09_dashboard_s.png" alt="アプリケーション詳細画面２" /></a></p>

<p>これで、しばらくすると、ダッシュボード上で、「ビルドを開始」→「ビルドが完了」→「デプロイを開始」→「デプロイが完了」と表示されるので、 ページをリロードすると確認できると思います。 SFTPの転送に時間がかかりますが簡単ですね！</p>

<p><a href="/images/2013_0317_sqale_10_fuelphp.png"><img src="/images/2013_0317_sqale_10_fuelphp_s.png" alt="公開ページ" /></a></p>

<p>さて、デフォルトではdevelopment環境になってるので、環境変数を設定してproduction環境にします、、、と思ったのだけれど、まだうまく動作しないみたいです。 問い合わせたら、もうすぐ動くようになるとのことなので期待しましょう。</p>

<h2 id="git%E3%81%A7%E3%81%AE%E3%83%87%E3%83%97%E3%83%AD%E3%82%A4">gitでのデプロイ</h2>

<p>gitでのデプロイは、ダッシュボードからSFTPではなくGITを選択することでできます。</p>

<p><a href="/images/2013_0317_sqale_13_git.png"><img src="/images/2013_0317_sqale_13_git_s.png" alt="git" /></a></p>

<p>選択をするとgitのアドレスが表示されるので git clone や git add remote などを使って関連付けます。 認証は公開鍵の使用を前提としているので予め公開鍵をアップしておきます。</p>

<p><a href="https://sqale.jp/support/manual/getting-started-win">Sqale - Getting Started for Windows</a>の先頭あたりが参考になります。</p>

<p><a href="/images/2013_0317_sqale_14_dashboard.png"><img src="/images/2013_0317_sqale_14_dashboard_s.png" alt="ダッシュボード" /></a></p>

<h2 id="%E7%8B%AC%E8%87%AA%E3%83%89%E3%83%A1%E3%82%A4%E3%83%B3%E3%81%AE%E5%89%B2%E3%82%8A%E5%BD%93%E3%81%A6">独自ドメインの割り当て</h2>

<p><em>-</em>.sqale.jp ではなく、独自ドメインで公開したい場合は、</p>

<p><a href="/images/2013_0317_sqale_11_domain.png"><img src="/images/2013_0317_sqale_11_domain_s.png" alt="ドメインの割り当て" /></a></p>

<p><a href="/images/2013_0317_sqale_12_domain.png"><img src="/images/2013_0317_sqale_12_domain_s.png" alt="ドメインの割り当て" /></a></p>

<p>で設定して、DNSのCNAMEで、設定すると公開できます。</p>

<h2 id="%E3%81%BE%E3%81%A8%E3%82%81">まとめ</h2>

<ul>
<li>SFTPやGIT、SSHなどデータのアップ方法が選べる</li>
<li>FuelPHPも簡単に動かせる</li>
<li>公開用のディレクトリ外部にファイルが置ける</li>
<li>独自ドメインが指定できる</li>
<li>.htaccess が機能していないっぽい</li>
<li>環境変数を設定できない(FUEL_ENVの指定やデータベースのパスワードの指定など) ※後日対応予定とのこと</li>
<li>メンテナンスモードがない(これは一般的な機能なんだろうか？)</li>
</ul>

<p>と、少し痒いところに手が届かない感じではありますが、サービスの公開用としても十分な感じがします。</p>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[eXcaleでFuelPHPをpublicサブディレクトリなしで動かしてみた(追記あり)]]></title>
            <link href="http://www.sharkpp.net/blog/2013/02/17/fuelphp-on-excale.html"/>
            <updated>2013-02-17T23:30:00+00:00</updated>
            <id>http://www.sharkpp.net/blog/2013/02/17/fuelphp-on-excale.html</id>
            <content type="html"><![CDATA[<p></p>
<div class="alert alert-danger alert-dismissible" role="alert">
  <div class="pull-left"><i class="fa fa-warning fa-2x"></i></div>
  <dl style="margin-bottom: 0; margin-left: 35px;">
    <dt>2015-06-10 追記</dt>
    <dd>eXcale(エクスケール) は 2014年11月28日 にサービスの提供が終了しました。そのため下記内容は過去の参考としてのみ残してあります。</dd>
  </dl>
</div>

<h2 id="%E5%A7%8B%E3%82%81%E3%81%AB">始めに</h2>

<p><a href="/blog/2013/02/17/fuelphp-workshop-in-osu-vol-3.html">FuelPHP 勉強会 大須 vol.3 に参加しました</a>で少し触れた FuelPHP + eXcale でデプロイ体験をもうすし踏み込んでまとめてみました。</p>

<p>内容的には <a href="http://yamamoto.phpapps.jp/2012/12/13/6/">FuelPHP + eXcale</a> を参照した記事となります。</p>

<p>なので、色々省かれているので先に目を通しておくことをお勧めします。</p>

<p>勉強会のレポ以外では、もしかして、初めてのFuelPHPの記事かもです。</p>

<p><strong>2013年2月18日追記</strong></p>

<p><a href="http://fuelphp.jp/docs/1.5/installation/instructions.html#/install_inside_root2">インストール方法 - インストール - FuelPHP ドキュメント</a> にルートからしか公開できない場合の設定方法が載っていました。</p>

<blockquote class="twitter-tweet" lang="ja"><p>@<a href="https://twitter.com/sharkpp">sharkpp</a> Assetのパスを変更する意義はないように思いますので、<a href="http://t.co/oQKk2vX9" title="http://ow.ly/hNx5G">ow.ly/hNx5G</a> の「もっと簡単な方法」の方がいいと思います <a href="https://twitter.com/search/%23fuelphposu">#fuelphposu</a></p>&mdash; kenjisさん (@kenji_s) <a href="https://twitter.com/kenji_s/status/303321663796289537">2013年2月18日</a></blockquote>

<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

<h2 id="%E3%82%A2%E3%82%AB%E3%82%A6%E3%83%B3%E3%83%88%E7%99%BB%E9%8C%B2">アカウント登録</h2>

<p>とりあえず、普通に eXcale に登録してみました。</p>

<p>メールアドレスで登録するだけなので簡単です。</p>

<p>と、ここで、、、</p>

<p><strong>This invitation link isn't valid. Perhaps you already used it?</strong></p>

<p>(´・ω・｀)</p>

<p>３?４回おなじメールアドレスで仮登録申請してみましたが、いずれもだめでした。 そもそも、本登録用のアドレスが何回やっても同じだったので結果は変わらないですね。</p>

<p>で、何回かやってて気が付きました。 なんかメッセージがページの上部に表示されてる？</p>

<p><strong>Please enter an collect email address format or password must be more than 6 characters, letters and numbers.</strong></p>

<p>あれ？もしかして、記号だめ？</p>

<p>はい、パスワード設定の時に記号を含めたパスワードを使用していました。</p>

<p>で、記号を抜いてみたら、、、できました。 酷いです(´・ω・｀)</p>

<p>あと、適当な名前でアプリケーションを登録しておきます。</p>

<h2 id="fuelphp%E3%82%92%E3%82%A2%E3%83%83%E3%83%97%E3%83%AD%E3%83%BC%E3%83%89">FuelPHPをアップロード</h2>

<p>FuelPHP本家からパッケージをダウンロードし、一旦展開します。 現在のバージョンは、1.5.2なので展開すると fuelphp-1.5.2 というフォルダができています。</p>

<p>で、 fuelphp-1.5.2/fuel/app/config/config.php に、</p>

<pre><code class="php">return array(
'default_timezone' =&amp;gt; 'Asia/Tokyo'
);
</code></pre>

<p>のような感じで設定を追加します。</p>

<p>で、fuelphp-1.5.2 の <strong>中身を</strong> .tar.gz で圧縮します。圧縮の仕方とかは適当に検索してみてください。 そのままではなく、 <strong>中身を</strong> ってところが重要です。</p>

<p>で、eXcle上でアプリケーション一覧から上で登録したアプリケーションのアップロードから .tar.gz をアップします。</p>

<p>アップしても、1分ぐらいは</p>

<p><strong>Down for maintenance</strong></p>

<p>な状態から更新されないのでしばらく待ってます。</p>

<p>501とかのエラーになったら、ログを確認してみてください。 なんかメッセージがでてるかもです。</p>

<h2 id="%E6%9C%AC%E9%A1%8C">本題</h2>

<p>ここからがこの記事の本題です。 上で書いた内容は、ただの前書き、序文、前菜です。</p>

<p>無事、デプロイ出来た場合でも、アクセスするには、 http://sharkpp.excale.net/public/ としないといけないのです。</p>

<p>これはかっこ悪い＆fuelとかにアクセスできてよろしくない。</p>

<p>何とかしたい、で何とかしてみました。</p>

<p>やり方は、</p>

<ol>
<li>ルートパスを変更</li>
<li><del>asset のパスを変更</del></li>
<li><del>public/index.php を index.php に移動して内容変更</del> public/* を / に移動し index.php の内容を変更</li>
</ol>

<h3 id="%E3%83%AB%E3%83%BC%E3%83%88%E3%83%91%E3%82%B9%E3%82%92%E5%A4%89%E6%9B%B4">ルートパスを変更</h3>

<p>上で変更した fuel/app/config/config.php に、base_urlの指定をします。 これ、なくても動くのかな？もしかして、、、試していないですが、、、</p>

<p>上の設定とあわせると最終的には、</p>

<pre><code class="php">return array(
'default_timezone' =&gt; 'Asia/Tokyo',
'base_url'  =&gt;  '/',
);
</code></pre>

<p>のような内容になっているはずです。</p>

<h3 id="asset-%E3%81%AE%E3%83%91%E3%82%B9%E3%82%92%E5%A4%89%E6%9B%B4"><del>asset のパスを変更</del></h3>

<p><strong>2013年2月18日削除</strong></p>

<p><del>fuel/app/config/asset.php はインストール直後では存在しないので、下のような内容を追加します。</del></p>

<pre><code class="php">return array(
'paths' =&gt; array('public/assets/'),
);
</code></pre>

<h3 id="public%2Findex.php-%E3%82%92-index.php-%E3%81%AB%E7%A7%BB%E5%8B%95%E3%81%97%E3%81%A6%E5%86%85%E5%AE%B9%E5%A4%89%E6%9B%B4-public%2F%2A-%E3%82%92-%2F-%E3%81%AB%E7%A7%BB%E5%8B%95%E3%81%97-index.php-%E3%81%AE%E5%86%85%E5%AE%B9%E3%82%92%E5%A4%89%E6%9B%B4"><del>public/index.php を index.php に移動して内容変更</del> public/* を / に移動し index.php の内容を変更</h3>

<p><del>public/index.php をルートに移動し、 index.php とします。</del></p>

<p>public/* をルートに移動します。 publicフォルダは空っぽなので削除しましょう。 で、パスも合わせて変更。</p>

<p>APPPATH と PKGPATH と COREPATH です。</p>

<pre><code class="php">define('APPPATH', realpath(__DIR__.'/../fuel/app/').DIRECTORY_SEPARATOR);
</code></pre>

<p>を</p>

<pre><code class="php">define('APPPATH', realpath(__DIR__.'/fuel/app/').DIRECTORY_SEPARATOR);
</code></pre>

<p>のような感じです。</p>

<p>この時、/fuel を、たとえば、 /fuel_hoge にしておけば、少し安全になるかもです。</p>

<p>で、また、固めなおしてアップします。</p>

<h2 id="%E5%AE%8C%E6%88%90">完成</h2>

<p>で、うまくアクセスできるようになりました。</p>

<ul>
<li><del>http://sharkpp.excale.net/</del></li>
<li><del>http://sharkpp.excale.net/index.php/welcome</del></li>
</ul>

<p>ただ、mod_rewrite相当の機能が使えないとの話なので /welcom.php などとアクセスしても 404 エラーとなってしまいます。</p>

<p>少し残念です。</p>

<p>あと、 /index.php/hoge.php はかっこ悪いです。</p>

<p><strong>あとあと、なんか重大な見落としがあるかもなので実際にやる時は自己責任でお願いしますです、はい。</strong></p>

<h2 id="%E3%81%BE%E3%81%A8%E3%82%81">まとめ</h2>

<p>eXcale は日本語で使えて遊べるかもってことで触ってみましたが、少し残念なところがあって、もうちょっと、、、って感じでした。</p>

<p>SNSなどに書くとそれを拾い上げてくれる場合もあるようなので、みんながいっぱい書けばもっとよくなるかも？ってことで期待をしたいなーと思います。</p>
]]></content>
        </entry>
    </feed>