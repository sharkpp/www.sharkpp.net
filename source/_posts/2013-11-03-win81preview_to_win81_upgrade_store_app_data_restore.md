---
title: "Windows 8.1 Preview から Windows 8.1 正式版への更新で消えたストアアプリのデータを復旧する方法"
tags: [雑記, Windows, Tips]
categories: [blog]

---

**注意事項** 下記内容を実行する場合は自己責任でお願いします。何がおきても知りません。

### 序章

さて、今年ももうすぐ終わりな感じの11月頭から大ポカやってしまいました。

  1. そうそう、そういえば、Windows 8.1 正式版がストアからダウンロードできるんだったな、うちの Windows RT も更新してしまおう！
  2. なんかストアにつなげない、、、アカウント再設定したらうまくいった、、、(←これは今回は多分関係ない)
  3. Windows 8.1 ダウンロード中(時間かかるなー)
  4. インストールしますか「はい」「いいえ」、、、「はい」１択じゃー！(もうちょっと違う文面だった気がするけどスクショ撮ってなかったorz)
  5. インストール中、、、「PCの設定を完了するため、ネットワークの設定を…」(あれ？WiFi設定してあったはずだけど？)
  6. インストール完了
  7. スタートメニューを見るとインストールしていたはずのストアアプリが入って、、、ない？(←なんか嫌な予感)
  8. そういえば、音量もOFFにしてあったはずだし、WiFiも設定してあったはずなのに、、、、
  9. とりあえず、WiFi再設定してアプリを再インストールするか、、、
 10. ストアアプリ起動中、、、、「設定の初期化をしています、、、」！？(←嫌な予感が確信に変わった)
 11. がんばって作ったデータどこーーーー orz

っと、まあこんな感じの流れがあったのです(泣)

### 第二章 症例探し

とりあえず、どうしようもないので、何か参考になるのはないかってことでググって見たところ、、、

[Windows 8.1情報 | サポート | VAIO | ソニー][1]

> Windows 8.1 Preview版をインストールされている場合は、必ずWindows 8にリカバリーしてから、Windows 8.1へアップデート下さい。 Windows 8.1 Preview版からWindows 8.1へアップデートした場合、ソフトウェアが使用できないなどの不具合が生じる可能性があります。

[[Windows 8.1] Windows 8.1 Previewから、Windows 8.1(正式版)に更新したい| Q&Aページ | サポート | VAIO | ソニー][2]

てな情報がありました。

詰まることろ、 Windows 8.1 Preview から Windows 8.1 正式版 への更新はまずいってことのようです。

一応、リカバリーデータは取ってあったのですが、、、今更再インストールは面倒だなーと思ってとりあえず別の方向でやってみることにしました。

### 第三章 試行錯誤

きっと、きっと、Windows ならOSインストール前にバックアップとってあるはず、、、ってことで、とりあえずエクスプローラでCドライブの中を見てみることにしました。

こんな発想になるのはきっとおかしいですよね、、、

、、、、ともかく、とりあえずデスクトップに移ろうかと思ったら、、、、あれ？デスクトップへのボタンがない、、、下にスクロールしたらボタンがあったのでピン止めしておきました。

Cドライブ直下に `Windows.old` ってのがある！

もしかしてと思って中を見てみたら、 `ユーザー` フォルダ、ありました。

試行錯誤を繰り返すこと数回

  1. ストアアプリのフォルダ丸ごと削除して入れ替え → 起動しなくなって失敗
  2. `LocalState` フォルダ丸ごと入れ替え → なぜか認識せず失敗
  3. `.contents` フォルダ丸ごと入れ替え → 古いデータが出てきた！

ってことで何とかなってよかった。

### 第四章 アプリのデータの復旧

とりあえず、まとめると

  1. ストアアプリがファイルにアクセスしないようにアプリを終了させる。
  2. 以前のデータと今のデータを置き換え
  3. ストアアプリを起動しデータを確認

って手順。

詳しく。

Windows 8.1 にアップグレードしてから、アプリはすでにインストール済みってのが、そもそもの前提です。

まず、ストアアプリがデータを読み書きしないようにタスクマネージャから終了させます。 普通に終了させてもバックグラウンドで動いているようなので念のためです。

<a href="/public/images/2013_1103_launch_taskmgr_large.png" rel="lytebox[2013_1103_launch_taskmgr]" title="タスクマネージャ起動"><img src="/public/images/2013_1103_launch_taskmgr.png" alt="タスクマネージャ起動" /></a>

<a href="/public/images/2013_1103_stop_store_app_large.png" rel="lytebox[2013_1103_stop_store_app]" title="該当アプリ停止"><img src="/public/images/2013_1103_stop_store_app.png" alt="該当アプリ停止" /></a>

次に、以前のデータと今のデータを置き換えます。

以前ストアアプリのデータの場所は、

    C:\Windows.old\ユーザー\{ユーザー名}\AppData\Local\Packages\{ストアアプリフォルダ}\LocalState\.contents
    

で、今のデータが、

    C:\ユーザー\{ユーザー名}\AppData\Local\Packages\{ストアアプリフォルダ}\LocalState\.contents
    

となります。

  * `{ユーザー名}` は、ログインしているユーザー名。
  * `{ストアアプリフォルダ}` は、ストアアプリの基準フォルダ(アプリのベンダー名やアプリ名などなどが元になっているようですね)

<a href="/public/images/2013_1103_delete_current_app_data_large.png" rel="lytebox[2013_1103_delete_current_app_data]" title="現在のデータを削除"><img src="/public/images/2013_1103_delete_current_app_data.png" alt="現在のデータを削除" /></a>

<a href="/public/images/2013_1103_restore_app_data_large.png" rel="lytebox[2013_1103_restore_app_data]" title="以前のデータをコピーして復旧"><img src="/public/images/2013_1103_restore_app_data.png" alt="以前のデータをコピーして復旧" /></a>

最後に、アプリを起動してデータを確認。

この手順で復旧できるかどうかはアプリ次第ではあります。

[Note Anytime][3] はうまくいきました。

あと、ストアアプリがたくさんあると該当のアプリを探せなかったり面倒くさいので素直に Windows 8 へリカバリしてから Windwos 8.1 にアップデートした方が余計なこと考えなくて良くていいと思います。

### 終章

とりあえず、なんにでも落とし穴があるようで、、、、ひどいよ Microsoft さんorz

データが消えた時は焦ったけど、まあ何とかなってよかったよかった、、、、かな？

 [1]: http://vcl.vaio.sony.co.jp/windows/8-1/update/
 [2]: http://qa.support.sony.jp/solution/S1310180055899/
 [3]: http://apps.microsoft.com/windows/ja-JP/app/note-anytime/b143522d-3500-4858-9be5-2dec4dcb693e